(function(b){b.jgrid={defaults:{recordtext:"View {0} - {1} of {2}",emptyrecords:"No records to view",loadtext:"Loading...",pgtext:"Page {0} of {1}"},search:{caption:"Search...",Find:"Find",Reset:"Reset",odata:["equal","not equal","less","less or equal","greater","greater or equal","begins with","does not begin with","is in","is not in","ends with","does not end with","contains","does not contain"],groupOps:[{op:"AND",text:"all"},{op:"OR",text:"any"}],matchText:" match",rulesText:" rules"},edit:{addCaption:"Add Record",editCaption:"Edit Record",bSubmit:"Submit",bCancel:"Cancel",bClose:"Close",saveData:"Data has been changed! Save changes?",bYes:"Yes",bNo:"No",bExit:"Cancel",msg:{required:"Field is required",number:"Please, enter valid number",minValue:"value must be greater than or equal to ",maxValue:"value must be less than or equal to",email:"is not a valid e-mail",integer:"Please, enter valid integer value",date:"Please, enter valid date value",url:"is not a valid URL. Prefix required ('http://' or 'https://')",nodefined:" is not defined!",novalue:" return value is required!",customarray:"Custom function should return array!",customfcheck:"Custom function should be present in case of custom checking!"}},view:{caption:"View Record",bClose:"Close"},del:{caption:"Delete",msg:"Delete selected record(s)?",bSubmit:"Delete",bCancel:"Cancel"},nav:{edittext:"",edittitle:"Edit selected row",addtext:"",addtitle:"Add new row",deltext:"",deltitle:"Delete selected row",searchtext:"",searchtitle:"Find records",refreshtext:"",refreshtitle:"Reload Grid",alertcap:"Warning",alerttext:"Please, select row",viewtext:"",viewtitle:"View selected row"},col:{caption:"Select columns",bSubmit:"Ok",bCancel:"Cancel"},errors:{errcap:"Error",nourl:"No url is set",norecords:"No records to process",model:"Length of colNames <> colModel!"},formatter:{integer:{thousandsSeparator:" ",defaultValue:"0"},number:{decimalSeparator:".",thousandsSeparator:" ",decimalPlaces:2,defaultValue:"0.00"},currency:{decimalSeparator:".",thousandsSeparator:" ",decimalPlaces:2,prefix:"",suffix:"",defaultValue:"0.00"},date:{dayNames:["Sun","Mon","Tue","Wed","Thr","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],AmPm:["am","pm","AM","PM"],S:function(a){return a<11||a>13?["st","nd","rd","th"][Math.min((a-1)%10,3)]:"th"},srcformat:"Y-m-d",newformat:"d/m/Y",masks:{ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"},reformatAfterEdit:false},baseLinkUrl:"",showAction:"",target:"",checkbox:{disabled:true},idName:"id"}}})($jq);(function($){$.jgrid=$.jgrid||{};$.extend($.jgrid,{htmlDecode:function(value){if(value&&(value=="&nbsp;"||value=="&#160;"||(value.length==1&&value.charCodeAt(0)==160))){return""}return !value?value:String(value).replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"')},htmlEncode:function(value){return !value?value:String(value).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\"/g,"&quot;")},format:function(format){var args=$.makeArray(arguments).slice(1);if(format===undefined){format=""}return format.replace(/\{(\d+)\}/g,function(m,i){return args[i]})},getCellIndex:function(cell){var c=$(cell);if(c.is("tr")){return -1}c=(!c.is("td")&&!c.is("th")?c.closest("td,th"):c)[0];if($.browser.msie){return $.inArray(c,c.parentNode.cells)}return c.cellIndex},stripHtml:function(v){v=v+"";var regexp=/<("[^"]*"|'[^']*'|[^'">])*>/gi;if(v){v=v.replace(regexp,"");return(v&&v!=="&nbsp;"&&v!=="&#160;")?v.replace(/\"/g,"'"):""}else{return v}},stringToDoc:function(xmlString){var xmlDoc;if(typeof xmlString!=="string"){return xmlString}try{var parser=new DOMParser();xmlDoc=parser.parseFromString(xmlString,"text/xml")}catch(e){xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async=false;xmlDoc.loadXML(xmlString)}return(xmlDoc&&xmlDoc.documentElement&&xmlDoc.documentElement.tagName!="parsererror")?xmlDoc:null},parse:function(jsonString){var js=jsonString;if(js.substr(0,9)=="while(1);"){js=js.substr(9)}if(js.substr(0,2)=="/*"){js=js.substr(2,js.length-4)}if(!js){js="{}"}return($.jgrid.useJSON===true&&typeof(JSON)==="object"&&typeof(JSON.parse)==="function")?JSON.parse(js):eval("("+js+")")},parseDate:function(format,date){var tsp={m:1,d:1,y:1970,h:0,i:0,s:0},k,hl,dM,regdate=/[\\\/:_;.,\t\T\s-]/;if(date&&date!==null&&date!==undefined){date=$.trim(date);date=date.split(regdate);format=format.split(regdate);var dfmt=$.jgrid.formatter.date.monthNames;var afmt=$.jgrid.formatter.date.AmPm;var h12to24=function(ampm,h){if(ampm===0){if(h==12){h=0}}else{if(h!=12){h+=12}}return h};for(k=0,hl=format.length;k<hl;k++){if(format[k]=="M"){dM=$.inArray(date[k],dfmt);if(dM!==-1&&dM<12){date[k]=dM+1}}if(format[k]=="F"){dM=$.inArray(date[k],dfmt);if(dM!==-1&&dM>11){date[k]=dM+1-12}}if(format[k]=="a"){dM=$.inArray(date[k],afmt);if(dM!==-1&&dM<2&&date[k]==afmt[dM]){date[k]=dM;tsp.h=h12to24(date[k],tsp.h)}}if(format[k]=="A"){dM=$.inArray(date[k],afmt);if(dM!==-1&&dM>1&&date[k]==afmt[dM]){date[k]=dM-2;tsp.h=h12to24(date[k],tsp.h)}}if(date[k]!==undefined){tsp[format[k].toLowerCase()]=parseInt(date[k],10)}}tsp.m=parseInt(tsp.m,10)-1;var ty=tsp.y;if(ty>=70&&ty<=99){tsp.y=1900+tsp.y}else{if(ty>=0&&ty<=69){tsp.y=2000+tsp.y}}}return new Date(tsp.y,tsp.m,tsp.d,tsp.h,tsp.i,tsp.s,0)},jqID:function(sid){sid=sid+"";return sid.replace(/([\.\:\[\]])/g,"\\$1")},guid:1,uidPref:"jqg",randId:function(prefix){return(prefix?prefix:$.jgrid.uidPref)+($.jgrid.guid++)},getAccessor:function(obj,expr){var ret,p,prm=[],i;if(typeof expr==="function"){return expr(obj)}ret=obj[expr];if(ret===undefined){try{if(typeof expr==="string"){prm=expr.split(".")}i=prm.length;if(i){ret=obj;while(ret&&i--){p=prm.shift();ret=ret[p]}}}catch(e){}}return ret},ajaxOptions:{},from:function(source,initalQuery){var queryObject=function(d,q){if(typeof(d)=="string"){d=$.data(d)}var self=this,_data=d,_usecase=true,_trim=false,_query=q,_stripNum=/[\$,%]/g,_lastCommand=null,_lastField=null,_negate=false,_queuedOperator="",_sorting=[],_useProperties=true;if(typeof(d)=="object"&&d.push){if(d.length>0){if(typeof(d[0])!="object"){_useProperties=false}else{_useProperties=true}}}else{throw"data provides is not an array"}this._hasData=function(){return _data===null?false:_data.length===0?false:true};this._getStr=function(s){var phrase=[];if(_trim){phrase.push("jQuery.trim(")}phrase.push("String("+s+")");if(_trim){phrase.push(")")}if(!_usecase){phrase.push(".toLowerCase()")}return phrase.join("")};this._strComp=function(val){if(typeof(val)=="string"){return".toString()"}else{return""}};this._group=function(f,u){return({field:f.toString(),unique:u,items:[]})};this._toStr=function(phrase){if(_trim){phrase=$.trim(phrase)}if(!_usecase){phrase=phrase.toLowerCase()}phrase=phrase.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"');return phrase};this._funcLoop=function(func){var results=[];$.each(_data,function(i,v){results.push(func(v))});return results};this._append=function(s){if(_query===null){_query=""}else{_query+=_queuedOperator===""?" && ":_queuedOperator}if(_negate){_query+="!"}_query+="("+s+")";_negate=false;_queuedOperator=""
};this._setCommand=function(f,c){_lastCommand=f;_lastField=c};this._resetNegate=function(){_negate=false};this._repeatCommand=function(f,v){if(_lastCommand===null){return self}if(f!==null&&v!==null){return _lastCommand(f,v)}if(_lastField===null){return _lastCommand(f)}if(!_useProperties){return _lastCommand(f)}return _lastCommand(_lastField,f)};this._equals=function(a,b){return(self._compare(a,b,1)===0)};this._compare=function(a,b,d){if(d===undefined){d=1}if(a===undefined){a=null}if(b===undefined){b=null}if(a===null&&b===null){return 0}if(a===null&&b!==null){return 1}if(a!==null&&b===null){return -1}if(!_usecase&&typeof(a)!=="number"&&typeof(b)!=="number"){a=String(a).toLowerCase();b=String(b).toLowerCase()}if(a<b){return -d}if(a>b){return d}return 0};this._performSort=function(){if(_sorting.length===0){return}_data=self._doSort(_data,0)};this._doSort=function(d,q){var by=_sorting[q].by,dir=_sorting[q].dir,type=_sorting[q].type,dfmt=_sorting[q].datefmt;if(q==_sorting.length-1){return self._getOrder(d,by,dir,type,dfmt)}q++;var values=self._getGroup(d,by,dir,type,dfmt);var results=[];for(var i=0;i<values.length;i++){var sorted=self._doSort(values[i].items,q);for(var j=0;j<sorted.length;j++){results.push(sorted[j])}}return results};this._getOrder=function(data,by,dir,type,dfmt){var sortData=[],_sortData=[],newDir=dir=="a"?1:-1,i,ab,j,findSortKey;if(type===undefined){type="text"}if(type=="float"||type=="number"||type=="currency"||type=="numeric"){findSortKey=function($cell,a){var key=parseFloat(String($cell).replace(_stripNum,""));return isNaN(key)?0:key}}else{if(type=="int"||type=="integer"){findSortKey=function($cell,a){return $cell?parseFloat(String($cell).replace(_stripNum,"")):0}}else{if(type=="date"||type=="datetime"){findSortKey=function($cell,a){return $.jgrid.parseDate(dfmt,$cell).getTime()}}else{if($.isFunction(type)){findSortKey=type}else{findSortKey=function($cell,a){if(!$cell){$cell=""}return $.trim(String($cell).toUpperCase())}}}}}$.each(data,function(i,v){ab=by!==""?$.jgrid.getAccessor(v,by):v;if(ab===undefined){ab=""}ab=findSortKey(ab,v);_sortData.push({vSort:ab,index:i})});_sortData.sort(function(a,b){a=a.vSort;b=b.vSort;return self._compare(a,b,newDir)});j=0;var nrec=data.length;while(j<nrec){i=_sortData[j].index;sortData.push(data[i]);j++}return sortData};this._getGroup=function(data,by,dir,type,dfmt){var results=[],group=null,last=null,val;$.each(self._getOrder(data,by,dir,type,dfmt),function(i,v){val=$.jgrid.getAccessor(v,by);if(val===undefined){val=""}if(!self._equals(last,val)){last=val;if(group!==null){results.push(group)}group=self._group(by,val)}group.items.push(v)});if(group!==null){results.push(group)}return results};this.ignoreCase=function(){_usecase=false;return self};this.useCase=function(){_usecase=true;return self};this.trim=function(){_trim=true;return self};this.noTrim=function(){_trim=false;return self};this.execute=function(){var match=_query,results=[];if(match===null){return self}$.each(_data,function(){if(eval(match)){results.push(this)}});_data=results;return self};this.data=function(){return _data};this.select=function(f){self._performSort();if(!self._hasData()){return[]}self.execute();if($.isFunction(f)){var results=[];$.each(_data,function(i,v){results.push(f(v))});return results}return _data};this.hasMatch=function(f){if(!self._hasData()){return false}self.execute();return _data.length>0};this.andNot=function(f,v,x){_negate=!_negate;return self.and(f,v,x)};this.orNot=function(f,v,x){_negate=!_negate;return self.or(f,v,x)};this.not=function(f,v,x){return self.andNot(f,v,x)};this.and=function(f,v,x){_queuedOperator=" && ";if(f===undefined){return self}return self._repeatCommand(f,v,x)};this.or=function(f,v,x){_queuedOperator=" || ";if(f===undefined){return self}return self._repeatCommand(f,v,x)};this.isNot=function(f){_negate=!_negate;return self.is(f)};this.is=function(f){self._append("this."+f);self._resetNegate();return self};this._compareValues=function(func,f,v,how,t){var fld;if(_useProperties){fld="jQuery.jgrid.getAccessor(this,'"+f+"')"}else{fld="this"}if(v===undefined){v=null}var val=v,swst=t.stype===undefined?"text":t.stype;if(v!==null){switch(swst){case"int":case"integer":val=(isNaN(Number(val))||val==="")?"0":val;fld="parseInt("+fld+",10)";val="parseInt("+val+",10)";break;case"float":case"number":case"numeric":val=String(val).replace(_stripNum,"");val=(isNaN(Number(val))||val==="")?"0":val;fld="parseFloat("+fld+")";val="parseFloat("+val+")";break;case"date":case"datetime":val=String($.jgrid.parseDate(t.newfmt||"Y-m-d",val).getTime());fld='jQuery.jgrid.parseDate("'+t.srcfmt+'",'+fld+").getTime()";break;default:fld=self._getStr(fld);val=self._getStr('"'+self._toStr(val)+'"')}}self._append(fld+" "+how+" "+val);self._setCommand(func,f);self._resetNegate();return self};this.equals=function(f,v,t){return self._compareValues(self.equals,f,v,"==",t)};this.notEquals=function(f,v,t){return self._compareValues(self.equals,f,v,"!==",t)};this.isNull=function(f,v,t){return self._compareValues(self.equals,f,null,"===",t)};this.greater=function(f,v,t){return self._compareValues(self.greater,f,v,">",t)};this.less=function(f,v,t){return self._compareValues(self.less,f,v,"<",t)};this.greaterOrEquals=function(f,v,t){return self._compareValues(self.greaterOrEquals,f,v,">=",t)};this.lessOrEquals=function(f,v,t){return self._compareValues(self.lessOrEquals,f,v,"<=",t)};this.startsWith=function(f,v){var val=(v===undefined||v===null)?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;if(_useProperties){self._append(self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(v)+'"'))}else{length=_trim?$.trim(v.toString()).length:v.toString().length;self._append(self._getStr("this")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(f)+'"'))}self._setCommand(self.startsWith,f);self._resetNegate();return self};this.endsWith=function(f,v){var val=(v===undefined||v===null)?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;if(_useProperties){self._append(self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+".substr("+self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+".length-"+length+","+length+') == "'+self._toStr(v)+'"')}else{self._append(self._getStr("this")+".substr("+self._getStr("this")+'.length-"'+self._toStr(f)+'".length,"'+self._toStr(f)+'".length) == "'+self._toStr(f)+'"')}self._setCommand(self.endsWith,f);self._resetNegate();return self};this.contains=function(f,v){if(_useProperties){self._append(self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+'.indexOf("'+self._toStr(v)+'",0) > -1')}else{self._append(self._getStr("this")+'.indexOf("'+self._toStr(f)+'",0) > -1')}self._setCommand(self.contains,f);self._resetNegate();return self};this.groupBy=function(by,dir,type,datefmt){if(!self._hasData()){return null}return self._getGroup(_data,by,dir,type,datefmt)};this.orderBy=function(by,dir,stype,dfmt){dir=dir===undefined||dir===null?"a":$.trim(dir.toString().toLowerCase());if(stype===null||stype===undefined){stype="text"}if(dfmt===null||dfmt===undefined){dfmt="Y-m-d"}if(dir=="desc"||dir=="descending"){dir="d"}if(dir=="asc"||dir=="ascending"){dir="a"}_sorting.push({by:by,dir:dir,type:stype,datefmt:dfmt});return self};return self};return new queryObject(source,null)},extend:function(methods){$.extend($.fn.jqGrid,methods);if(!this.no_legacy_api){$.fn.extend(methods)}}});$.fn.jqGrid=function(pin){if(typeof pin=="string"){var fn=$.jgrid.getAccessor($.fn.jqGrid,pin);
if(!fn){throw ("jqGrid - No such method: "+pin)}var args=$.makeArray(arguments).slice(1);return fn.apply(this,args)}return this.each(function(){if(this.grid){return}var p=$.extend(true,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:true,pginput:true,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:false,selarrrow:[],savedRow:[],shrinkToFit:true,xmlReader:{},jsonReader:{},subGrid:false,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,onHeaderClick:null,viewrecords:false,loadonce:false,multiselect:false,multikey:false,editurl:null,search:false,caption:"",hidegrid:true,hiddengrid:false,postData:{},userData:{},treeGrid:false,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:false,gridstate:"visible",cellEdit:false,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[false,""],scroll:false,multiboxonly:false,deselectAfterSort:true,scrollrows:false,autowidth:false,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:false,rownumWidth:25,rownumbers:false,pagerpos:"center",recordpos:"right",footerrow:false,userDataOnFooter:false,hoverrows:true,altclass:"ui-priority-secondary",viewsortcols:[false,"vertical",true],resizeclass:"",autoencode:false,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:false,headertitles:false,scrollTimeout:40,data:[],_index:{},grouping:false,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:false,sortitems:[],sortnames:[],groupDataSorted:false,summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus"},ignoreCase:false,cmTemplate:{}},$.jgrid.defaults,pin||{});var grid={headers:[],cols:[],footers:[],dragStart:function(i,x,y){this.resizing={idx:i,startX:x.clientX,sOL:y[0]};this.hDiv.style.cursor="col-resize";this.curGbox=$("#rs_m"+$.jgrid.jqID(p.id),"#gbox_"+$.jgrid.jqID(p.id));this.curGbox.css({display:"block",left:y[0],top:y[1],height:y[2]});if($.isFunction(p.resizeStart)){p.resizeStart.call(this,x,i)}document.onselectstart=function(){return false}},dragMove:function(x){if(this.resizing){var diff=x.clientX-this.resizing.startX,h=this.headers[this.resizing.idx],newWidth=p.direction==="ltr"?h.width+diff:h.width-diff,hn,nWn;if(newWidth>33){this.curGbox.css({left:this.resizing.sOL+diff});if(p.forceFit===true){hn=this.headers[this.resizing.idx+p.nv];nWn=p.direction==="ltr"?hn.width-diff:hn.width+diff;if(nWn>33){h.newWidth=newWidth;hn.newWidth=nWn}}else{this.newWidth=p.direction==="ltr"?p.tblwidth+diff:p.tblwidth-diff;h.newWidth=newWidth}}}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var idx=this.resizing.idx,nw=this.headers[idx].newWidth||this.headers[idx].width;nw=parseInt(nw,10);this.resizing=false;$("#rs_m"+$.jgrid.jqID(p.id)).css("display","none");p.colModel[idx].width=nw;this.headers[idx].width=nw;this.headers[idx].el.style.width=nw+"px";this.cols[idx].style.width=nw+"px";if(this.footers.length>0){this.footers[idx].style.width=nw+"px"}if(p.forceFit===true){nw=this.headers[idx+p.nv].newWidth||this.headers[idx+p.nv].width;this.headers[idx+p.nv].width=nw;this.headers[idx+p.nv].el.style.width=nw+"px";this.cols[idx+p.nv].style.width=nw+"px";if(this.footers.length>0){this.footers[idx+p.nv].style.width=nw+"px"}p.colModel[idx+p.nv].width=nw}else{p.tblwidth=this.newWidth||p.tblwidth;$("table:first",this.bDiv).css("width",p.tblwidth+"px");$("table:first",this.hDiv).css("width",p.tblwidth+"px");this.hDiv.scrollLeft=this.bDiv.scrollLeft;if(p.footerrow){$("table:first",this.sDiv).css("width",p.tblwidth+"px");this.sDiv.scrollLeft=this.bDiv.scrollLeft}}if($.isFunction(p.resizeStop)){p.resizeStop.call(this,nw,idx)}}this.curGbox=null;document.onselectstart=function(){return true}},populateVisible:function(){if(grid.timer){clearTimeout(grid.timer)}grid.timer=null;var dh=$(grid.bDiv).height();if(!dh){return}var table=$("table:first",grid.bDiv);var rows,rh;if(table[0].rows.length){try{rows=table[0].rows[1];rh=rows?$(rows).outerHeight()||grid.prevRowHeight:grid.prevRowHeight}catch(pv){rh=grid.prevRowHeight}}if(!rh){return}grid.prevRowHeight=rh;var rn=p.rowNum;var scrollTop=grid.scrollTop=grid.bDiv.scrollTop;var ttop=Math.round(table.position().top)-scrollTop;var tbot=ttop+table.height();var div=rh*rn;var page,npage,empty;if(tbot<dh&&ttop<=0&&(p.lastpage===undefined||parseInt((tbot+scrollTop+div-1)/div,10)<=p.lastpage)){npage=parseInt((dh-tbot+div-1)/div,10);if(tbot>=0||npage<2||p.scroll===true){page=Math.round((tbot+scrollTop)/div)+1;ttop=-1}else{ttop=1}}if(ttop>0){page=parseInt(scrollTop/div,10)+1;npage=parseInt((scrollTop+dh)/div,10)+2-page;empty=true}if(npage){if(p.lastpage&&page>p.lastpage||p.lastpage==1||(page===p.page&&page===p.lastpage)){return}if(grid.hDiv.loading){grid.timer=setTimeout(grid.populateVisible,p.scrollTimeout)}else{p.page=page;if(empty){grid.selectionPreserver(table[0]);grid.emptyRows(grid.bDiv,false,false)}grid.populate(npage)}}},scrollGrid:function(e){if(p.scroll){var scrollTop=grid.bDiv.scrollTop;if(grid.scrollTop===undefined){grid.scrollTop=0}if(scrollTop!=grid.scrollTop){grid.scrollTop=scrollTop;if(grid.timer){clearTimeout(grid.timer)}grid.timer=setTimeout(grid.populateVisible,p.scrollTimeout)}}grid.hDiv.scrollLeft=grid.bDiv.scrollLeft;if(p.footerrow){grid.sDiv.scrollLeft=grid.bDiv.scrollLeft}e.stopPropagation()},selectionPreserver:function(ts){var p=ts.p;var sr=p.selrow,sra=p.selarrrow?$.makeArray(p.selarrrow):null;var left=ts.grid.bDiv.scrollLeft;var complete=p.gridComplete;p.gridComplete=function(){p.selrow=null;p.selarrrow=[];if(p.multiselect&&sra&&sra.length>0){for(var i=0;i<sra.length;i++){if(sra[i]!=sr){$(ts).jqGrid("setSelection",sra[i],false)}}}if(sr){$(ts).jqGrid("setSelection",sr,false)}ts.grid.bDiv.scrollLeft=left;p.gridComplete=complete;if(p.gridComplete){complete()}}}};if(this.tagName!="TABLE"){alert("Element is not a table");return}$(this).empty().attr("tabindex","1");this.p=p;var i,dir,ts;if(this.p.colNames.length===0){for(i=0;i<this.p.colModel.length;i++){this.p.colNames[i]=this.p.colModel[i].label||this.p.colModel[i].name}}if(this.p.colNames.length!==this.p.colModel.length){alert($.jgrid.errors.model);return}var new_version;if(parseFloat($.browser.version)==536.11){new_version=536}else{new_version=536.5}var gv=$("<div class='ui-jqgrid-view'></div>"),ii,isMSIE=$.browser.msie?true:false,isSafari=($.browser.webkit||$.browser.safari)&&(window.navigator.userAgent.toLowerCase().indexOf("chrome")<0||parseFloat($.browser.version)<new_version)?true:false;ts=this;ts.p.direction=$.trim(ts.p.direction.toLowerCase());if($.inArray(ts.p.direction,["ltr","rtl"])==-1){ts.p.direction="ltr"}dir=ts.p.direction;$(gv).insertBefore(this);$(this).appendTo(gv).removeClass("scroll");var eg=$("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");$(eg).insertBefore(gv).attr({id:"gbox_"+this.id,dir:dir});$(gv).appendTo(eg).attr("id","gview_"+this.id);if(isMSIE&&$.browser.version<=6){ii='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>'
}else{ii=""}$("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").append(ii).insertBefore(gv);$("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(gv);$(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var sortkeys=["shiftKey","altKey","ctrlKey"],intNum=function(val,defval){val=parseInt(val,10);if(isNaN(val)){return defval?defval:0}else{return val}},formatCol=function(pos,rowInd,tv,rawObject,rowId,rdata){var cm=ts.p.colModel[pos],ral=cm.align,result='style="',clas=cm.classes,nm=cm.name,celp,acp=[];if(ral){result+="text-align:"+ral+";"}if(cm.hidden===true){result+="display:none;"}if(rowInd===0){result+="width: "+grid.headers[pos].width+"px;"}else{if(cm.cellattr&&$.isFunction(cm.cellattr)){celp=cm.cellattr.call(ts,rowId,tv,rawObject,cm,rdata);if(celp&&typeof(celp)==="string"){celp=celp.replace(/style/i,"style").replace(/title/i,"title");if(celp.indexOf("title")>-1){cm.title=false}if(celp.indexOf("class")>-1){clas=undefined}acp=celp.split("style");if(acp.length===2){acp[1]=$.trim(acp[1].replace("=",""));if(acp[1].indexOf("'")===0||acp[1].indexOf('"')===0){acp[1]=acp[1].substring(1)}result+=acp[1].replace(/'/gi,'"')}else{result+='"'}}}}if(!acp.length){acp[0]="";result+='"'}result+=(clas!==undefined?(' class="'+clas+'"'):"")+((cm.title&&tv)?(' title="'+$.jgrid.stripHtml(tv)+'"'):"");result+=' aria-describedby="'+ts.p.id+"_"+nm+'"';return result+acp[0]},cellVal=function(val){return val===undefined||val===null||val===""?"&#160;":(ts.p.autoencode?$.jgrid.htmlEncode(val):val+"")},formatter=function(rowId,cellval,colpos,rwdat,_act){var cm=ts.p.colModel[colpos],v;if(typeof cm.formatter!=="undefined"){var opts={rowId:rowId,colModel:cm,gid:ts.p.id,pos:colpos};if($.isFunction(cm.formatter)){v=cm.formatter.call(ts,cellval,opts,rwdat,_act)}else{if($.fmatter){v=$.fn.fmatter(cm.formatter,cellval,opts,rwdat,_act)}else{v=cellVal(cellval)}}}else{v=cellVal(cellval)}return v},addCell=function(rowId,cell,pos,irow,srvr){var v,prp;v=formatter(rowId,cell,pos,srvr,"add");prp=formatCol(pos,irow,v,srvr,rowId,true);return'<td role="gridcell" '+prp+">"+v+"</td>"},addMulti=function(rowid,pos,irow){var v='<input role="checkbox" type="checkbox" id="jqg_'+ts.p.id+"_"+rowid+'" class="cbox" name="jqg_'+ts.p.id+"_"+rowid+'"/>',prp=formatCol(pos,irow,"",null,rowid,true);return'<td role="gridcell" '+prp+">"+v+"</td>"},addRowNum=function(pos,irow,pG,rN){var v=(parseInt(pG,10)-1)*parseInt(rN,10)+1+irow,prp=formatCol(pos,irow,v,null,irow,true);return'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+prp+">"+v+"</td>"},reader=function(datatype){var field,f=[],j=0,i;for(i=0;i<ts.p.colModel.length;i++){field=ts.p.colModel[i];if(field.name!=="cb"&&field.name!=="subgrid"&&field.name!=="rn"){if(datatype=="local"){f[j]=field.name}else{f[j]=(datatype=="xml")?field.xmlmap||field.name:field.jsonmap||field.name}j++}}return f},orderedCols=function(offset){var order=ts.p.remapColumns;if(!order||!order.length){order=$.map(ts.p.colModel,function(v,i){return i})}if(offset){order=$.map(order,function(v){return v<offset?null:v-offset})}return order},emptyRows=function(parent,scroll,locdata){if(ts.p.deepempty){$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first tr:gt(0)").remove()}else{var trf=$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first tr:first")[0];$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").empty().append(trf)}if(scroll&&ts.p.scroll){$(">div:first",parent).css({height:"auto"}).children("div:first").css({height:0,display:"none"});parent.scrollTop=0}if(locdata===true){if(ts.p.treeGrid===true){ts.p.data=[];ts.p._index={}}}},refreshIndex=function(){var datalen=ts.p.data.length,idname,i,val,ni=ts.p.rownumbers===true?1:0,gi=ts.p.multiselect===true?1:0,si=ts.p.subGrid===true?1:0;if(ts.p.keyIndex===false||ts.p.loadonce===true){idname=ts.p.localReader.id}else{idname=ts.p.colModel[ts.p.keyIndex+gi+si+ni].name}for(i=0;i<datalen;i++){val=$.jgrid.getAccessor(ts.p.data[i],idname);ts.p._index[val]=i}},addXmlData=function(xml,t,rcnt,more,adjust){var startReq=new Date(),locdata=(ts.p.datatype!="local"&&ts.p.loadonce)||ts.p.datatype=="xmlstring",xmlid="_id_",frd=ts.p.datatype=="local"?"local":"xml";if(locdata){ts.p.data=[];ts.p._index={};ts.p.localReader.id=xmlid}ts.p.reccount=0;if($.isXMLDoc(xml)){if(ts.p.treeANode===-1&&!ts.p.scroll){emptyRows(t,false,true);rcnt=1}else{rcnt=rcnt>1?rcnt:1}}else{return}var i,fpos,ir=0,v,row,gi=0,si=0,ni=0,idn,getId,f=[],F,rd={},xmlr,rid,rowData=[],cn=(ts.p.altRows===true)?" "+ts.p.altclass:"",cn1;if(!ts.p.xmlReader.repeatitems){f=reader(frd)}if(ts.p.keyIndex===false){idn=ts.p.xmlReader.id}else{idn=ts.p.keyIndex}if(f.length>0&&!isNaN(idn)){if(ts.p.remapColumns&&ts.p.remapColumns.length){idn=$.inArray(idn,ts.p.remapColumns)}idn=f[idn]}if((idn+"").indexOf("[")===-1){if(f.length){getId=function(trow,k){return $(idn,trow).text()||k}}else{getId=function(trow,k){return $(ts.p.xmlReader.cell,trow).eq(idn).text()||k}}}else{getId=function(trow,k){return trow.getAttribute(idn.replace(/[\[\]]/g,""))||k}}ts.p.userData={};$(ts.p.xmlReader.page,xml).each(function(){ts.p.page=this.textContent||this.text||0});$(ts.p.xmlReader.total,xml).each(function(){ts.p.lastpage=this.textContent||this.text;if(ts.p.lastpage===undefined){ts.p.lastpage=1}});$(ts.p.xmlReader.records,xml).each(function(){ts.p.records=this.textContent||this.text||0});$(ts.p.xmlReader.userdata,xml).each(function(){ts.p.userData[this.getAttribute("name")]=this.textContent||this.text});var gxml=$(ts.p.xmlReader.root+" "+ts.p.xmlReader.row,xml);if(!gxml){gxml=[]}var gl=gxml.length,j=0,grpdata={},rn;if(gxml&&gl){rn=parseInt(ts.p.rowNum,10);var br=ts.p.scroll?$.jgrid.randId():1,altr;if(adjust){rn*=adjust+1}var afterInsRow=$.isFunction(ts.p.afterInsertRow),hiderow="";if(ts.p.grouping&&ts.p.groupingView.groupCollapse===true){hiderow=' style="display:none;"'}while(j<gl){xmlr=gxml[j];rid=getId(xmlr,br+j);altr=rcnt===0?0:rcnt+1;cn1=(altr+j)%2==1?cn:"";rowData.push("<tr"+hiderow+' id="'+rid+'" tabindex="-1" role="row" class ="ui-widget-content jqgrow ui-row-'+ts.p.direction+""+cn1+'">');if(ts.p.rownumbers===true){rowData.push(addRowNum(0,j,ts.p.page,ts.p.rowNum));ni=1}if(ts.p.multiselect===true){rowData.push(addMulti(rid,ni,j));gi=1}if(ts.p.subGrid===true){rowData.push($(ts).jqGrid("addSubGridCell",gi+ni,j+rcnt));si=1}if(ts.p.xmlReader.repeatitems){if(!F){F=orderedCols(gi+si+ni)}var cells=$(ts.p.xmlReader.cell,xmlr);$.each(F,function(k){var cell=cells[this];if(!cell){return false}v=cell.textContent||cell.text;rd[ts.p.colModel[k+gi+si+ni].name]=v;rowData.push(addCell(rid,v,k+gi+si+ni,j+rcnt,xmlr))})}else{for(i=0;i<f.length;i++){v=$(f[i],xmlr).text();rd[ts.p.colModel[i+gi+si+ni].name]=v;rowData.push(addCell(rid,v,i+gi+si+ni,j+rcnt,xmlr))}}rowData.push("</tr>");if(ts.p.grouping){var grlen=ts.p.groupingView.groupField.length,grpitem=[];for(var z=0;z<grlen;z++){grpitem.push(rd[ts.p.groupingView.groupField[z]])}grpdata=$(ts).jqGrid("groupingPrepare",rowData,grpitem,grpdata,rd);rowData=[]}if(locdata||ts.p.treeGrid===true){rd[xmlid]=rid;ts.p.data.push(rd);ts.p._index[rid]=ts.p.data.length-1}if(ts.p.gridview===false){$("tbody:first",t).append(rowData.join(""));if(afterInsRow){ts.p.afterInsertRow.call(ts,rid,rd,xmlr)}rowData=[]}rd={};ir++;j++;if(ir==rn){break}}}if(ts.p.gridview===true){fpos=ts.p.treeANode>-1?ts.p.treeANode:0;if(ts.p.grouping){$(ts).jqGrid("groupingRender",grpdata,ts.p.colModel.length);
grpdata=null}else{if(ts.p.treeGrid===true&&fpos>0){$(ts.rows[fpos]).after(rowData.join(""))}else{$("tbody:first",t).append(rowData.join(""))}}}if(ts.p.subGrid===true){try{$(ts).jqGrid("addSubGrid",gi+ni)}catch(_){}}ts.p.totaltime=new Date()-startReq;if(ir>0){if(ts.p.records===0){ts.p.records=gl}}rowData=null;if(ts.p.treeGrid===true){try{$(ts).jqGrid("setTreeNode",fpos+1,ir+fpos+1)}catch(e){}}if(!ts.p.treeGrid&&!ts.p.scroll){ts.grid.bDiv.scrollTop=0}ts.p.reccount=ir;ts.p.treeANode=-1;if(ts.p.userDataOnFooter){$(ts).jqGrid("footerData","set",ts.p.userData,true)}if(locdata){ts.p.records=gl;ts.p.lastpage=Math.ceil(gl/rn)}if(!more){ts.updatepager(false,true)}if(locdata){while(ir<gl){xmlr=gxml[ir];rid=getId(xmlr,ir);if(ts.p.xmlReader.repeatitems){if(!F){F=orderedCols(gi+si+ni)}var cells2=$(ts.p.xmlReader.cell,xmlr);$.each(F,function(k){var cell=cells2[this];if(!cell){return false}v=cell.textContent||cell.text;rd[ts.p.colModel[k+gi+si+ni].name]=v})}else{for(i=0;i<f.length;i++){v=$(f[i],xmlr).text();rd[ts.p.colModel[i+gi+si+ni].name]=v}}rd[xmlid]=rid;ts.p.data.push(rd);ts.p._index[rid]=ts.p.data.length-1;rd={};ir++}}},addJSONData=function(data,t,rcnt,more,adjust){var startReq=new Date();if(data){if(ts.p.treeANode===-1&&!ts.p.scroll){emptyRows(t,false,true);rcnt=1}else{rcnt=rcnt>1?rcnt:1}}else{return}var dReader,locid="_id_",frd,locdata=(ts.p.datatype!="local"&&ts.p.loadonce)||ts.p.datatype=="jsonstring";if(locdata){ts.p.data=[];ts.p._index={};ts.p.localReader.id=locid}ts.p.reccount=0;if(ts.p.datatype=="local"){dReader=ts.p.localReader;frd="local"}else{dReader=ts.p.jsonReader;frd="json"}var ir=0,v,i,j,f=[],F,cur,gi=0,si=0,ni=0,len,drows,idn,rd={},fpos,idr,rowData=[],cn=(ts.p.altRows===true)?" "+ts.p.altclass:"",cn1,lp;ts.p.page=$.jgrid.getAccessor(data,dReader.page)||0;lp=$.jgrid.getAccessor(data,dReader.total);ts.p.lastpage=lp===undefined?1:lp;ts.p.records=$.jgrid.getAccessor(data,dReader.records)||0;ts.p.userData=$.jgrid.getAccessor(data,dReader.userdata)||{};if(!dReader.repeatitems){F=f=reader(frd)}if(ts.p.keyIndex===false){idn=dReader.id}else{idn=ts.p.keyIndex}if(f.length>0&&!isNaN(idn)){if(ts.p.remapColumns&&ts.p.remapColumns.length){idn=$.inArray(idn,ts.p.remapColumns)}idn=f[idn]}drows=$.jgrid.getAccessor(data,dReader.root);if(!drows){drows=[]}len=drows.length;i=0;var rn=parseInt(ts.p.rowNum,10),br=ts.p.scroll?$.jgrid.randId():1,altr;if(adjust){rn*=adjust+1}var afterInsRow=$.isFunction(ts.p.afterInsertRow),grpdata={},hiderow="";if(ts.p.grouping&&ts.p.groupingView.groupCollapse===true){hiderow=' style="display:none;"'}while(i<len){cur=drows[i];idr=$.jgrid.getAccessor(cur,idn);if(idr===undefined){idr=br+i;if(f.length===0){if(dReader.cell){var ccur=$.jgrid.getAccessor(cur,dReader.cell);idr=ccur[idn]||idr;ccur=null}}}altr=rcnt===1?0:rcnt;cn1=(altr+i)%2==1?cn:"";rowData.push("<tr"+hiderow+' id="'+idr+'" tabindex="-1" role="row" class= "ui-widget-content jqgrow ui-row-'+ts.p.direction+""+cn1+'">');if(ts.p.rownumbers===true){rowData.push(addRowNum(0,i,ts.p.page,ts.p.rowNum));ni=1}if(ts.p.multiselect){rowData.push(addMulti(idr,ni,i));gi=1}if(ts.p.subGrid){rowData.push($(ts).jqGrid("addSubGridCell",gi+ni,i+rcnt));si=1}if(dReader.repeatitems){if(dReader.cell){cur=$.jgrid.getAccessor(cur,dReader.cell)}if(!F){F=orderedCols(gi+si+ni)}}for(j=0;j<F.length;j++){v=$.jgrid.getAccessor(cur,F[j]);rowData.push(addCell(idr,v,j+gi+si+ni,i+rcnt,cur));rd[ts.p.colModel[j+gi+si+ni].name]=v}rowData.push("</tr>");if(ts.p.grouping){var grlen=ts.p.groupingView.groupField.length,grpitem=[];for(var z=0;z<grlen;z++){grpitem.push(rd[ts.p.groupingView.groupField[z]])}grpdata=$(ts).jqGrid("groupingPrepare",rowData,grpitem,grpdata,rd);rowData=[]}if(locdata||ts.p.treeGrid===true){rd[locid]=idr;ts.p.data.push(rd);ts.p._index[idr]=ts.p.data.length-1}if(ts.p.gridview===false){$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").append(rowData.join(""));if(afterInsRow){ts.p.afterInsertRow.call(ts,idr,rd,cur)}rowData=[]}rd={};ir++;i++;if(ir==rn){break}}if(ts.p.gridview===true){fpos=ts.p.treeANode>-1?ts.p.treeANode:0;if(ts.p.grouping){$(ts).jqGrid("groupingRender",grpdata,ts.p.colModel.length);grpdata=null}else{if(ts.p.treeGrid===true&&fpos>0){$(ts.rows[fpos]).after(rowData.join(""))}else{$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").append(rowData.join(""))}}}if(ts.p.subGrid===true){try{$(ts).jqGrid("addSubGrid",gi+ni)}catch(_){}}ts.p.totaltime=new Date()-startReq;if(ir>0){if(ts.p.records===0){ts.p.records=len}}rowData=null;if(ts.p.treeGrid===true){try{$(ts).jqGrid("setTreeNode",fpos+1,ir+fpos+1)}catch(e){}}if(!ts.p.treeGrid&&!ts.p.scroll){ts.grid.bDiv.scrollTop=0}ts.p.reccount=ir;ts.p.treeANode=-1;if(ts.p.userDataOnFooter){$(ts).jqGrid("footerData","set",ts.p.userData,true)}if(locdata){ts.p.records=len;ts.p.lastpage=Math.ceil(len/rn)}if(!more){ts.updatepager(false,true)}if(locdata){while(ir<len&&drows[ir]){cur=drows[ir];idr=$.jgrid.getAccessor(cur,idn);if(idr===undefined){idr=br+ir;if(f.length===0){if(dReader.cell){var ccur2=$.jgrid.getAccessor(cur,dReader.cell);idr=ccur2[idn]||idr;ccur2=null}}}if(cur){if(dReader.repeatitems){if(dReader.cell){cur=$.jgrid.getAccessor(cur,dReader.cell)}if(!F){F=orderedCols(gi+si+ni)}}for(j=0;j<F.length;j++){v=$.jgrid.getAccessor(cur,F[j]);rd[ts.p.colModel[j+gi+si+ni].name]=v}rd[locid]=idr;ts.p.data.push(rd);ts.p._index[idr]=ts.p.data.length-1;rd={}}ir++}}},addLocalData=function(){var st,fndsort=false,cmtypes={},grtypes=[],grindexes=[],srcformat,sorttype,newformat;if(!$.isArray(ts.p.data)){return}var grpview=ts.p.grouping?ts.p.groupingView:false;$.each(ts.p.colModel,function(i,v){sorttype=this.sorttype||"text";if(sorttype=="date"||sorttype=="datetime"){if(this.formatter&&typeof(this.formatter)==="string"&&this.formatter=="date"){if(this.formatoptions&&this.formatoptions.srcformat){srcformat=this.formatoptions.srcformat}else{srcformat=$.jgrid.formatter.date.srcformat}if(this.formatoptions&&this.formatoptions.newformat){newformat=this.formatoptions.newformat}else{newformat=$.jgrid.formatter.date.newformat}}else{srcformat=newformat=this.datefmt||"Y-m-d"}cmtypes[this.name]={stype:sorttype,srcfmt:srcformat,newfmt:newformat}}else{cmtypes[this.name]={stype:sorttype,srcfmt:"",newfmt:""}}if(ts.p.grouping&&this.name==grpview.groupField[0]){var grindex=this.name;if(typeof this.index!="undefined"){grindex=this.index}grtypes[0]=cmtypes[grindex];grindexes.push(grindex)}if(!fndsort&&(this.index==ts.p.sortname||this.name==ts.p.sortname)){st=this.name;fndsort=true}});if(ts.p.treeGrid){$(ts).jqGrid("SortTree",st,ts.p.sortorder,cmtypes[st].stype,cmtypes[st].srcfmt);return}var compareFnMap={eq:function(queryObj,op){return queryObj.equals},ne:function(queryObj,op){return queryObj.notEquals},lt:function(queryObj,op){return queryObj.less},le:function(queryObj,op){return queryObj.lessOrEquals},gt:function(queryObj,op){return queryObj.greater},ge:function(queryObj,op){return queryObj.greaterOrEquals},cn:function(queryObj,op){return queryObj.contains},nc:function(queryObj,op){return op==="OR"?queryObj.orNot().contains:queryObj.andNot().contains},bw:function(queryObj,op){return queryObj.startsWith},bn:function(queryObj,op){return op==="OR"?queryObj.orNot().startsWith:queryObj.andNot().startsWith},en:function(queryObj,op){return op==="OR"?queryObj.orNot().endsWith:queryObj.andNot().endsWith},ew:function(queryObj,op){return queryObj.endsWith},ni:function(queryObj,op){return op==="OR"?queryObj.orNot().equals:queryObj.andNot().equals},"in":function(queryObj,op){return queryObj.equals},nu:function(queryObj,op){return queryObj.isNull
},nn:function(queryObj,op){return op==="OR"?queryObj.orNot().isNull:queryObj.andNot().isNull}},query=$.jgrid.from(ts.p.data);if(ts.p.ignoreCase){query=query.ignoreCase()}function tojLinq(group){var s=0,index,opr,rule;if(group.groups!==undefined){for(index=0;index<group.groups.length;index++){try{tojLinq(group.groups[index])}catch(e){alert(e)}s++}}if(group.rules!==undefined){if(s>0){var result=query.select();query=$.jgrid.from(result)}try{for(index=0;index<group.rules.length;index++){rule=group.rules[index];opr=group.groupOp.toString().toUpperCase();if(compareFnMap[rule.op]&&rule.field){if(s>0&&opr&&opr==="OR"){query=query.or()}query=compareFnMap[rule.op](query,opr)(rule.field,rule.data,cmtypes[rule.field])}s++}}catch(g){alert(g)}}}if(ts.p.search===true){var srules=ts.p.postData.filters;if(srules){if(typeof srules=="string"){srules=$.jgrid.parse(srules)}tojLinq(srules)}else{try{query=compareFnMap[ts.p.postData.searchOper](query)(ts.p.postData.searchField,ts.p.postData.searchString,cmtypes[ts.p.postData.searchField])}catch(se){}}}if(ts.p.grouping){query.orderBy(grindexes,grpview.groupOrder[0],grtypes[0].stype,grtypes[0].srcfmt);grpview.groupDataSorted=true}if(st&&ts.p.sortorder&&fndsort){if(ts.p.sortorder.toUpperCase()=="DESC"){query.orderBy(ts.p.sortname,"d",cmtypes[st].stype,cmtypes[st].srcfmt)}else{query.orderBy(ts.p.sortname,"a",cmtypes[st].stype,cmtypes[st].srcfmt)}}var queryResults=query.select(),recordsperpage=parseInt(ts.p.rowNum,10),total=queryResults.length,page=parseInt(ts.p.page,10),totalpages=Math.ceil(total/recordsperpage),retresult={};queryResults=recordsperpage==-1?queryResults.slice((page-1)*recordsperpage):queryResults.slice((page-1)*recordsperpage,page*recordsperpage);query=null;cmtypes=null;retresult[ts.p.localReader.total]=totalpages;retresult[ts.p.localReader.page]=page;retresult[ts.p.localReader.records]=total;retresult[ts.p.localReader.root]=queryResults;queryResults=null;return retresult},updatepager=function(rn,dnd){var cp,last,base,from,to,tot,fmt,pgboxes="";base=parseInt(ts.p.page,10)-1;if(base<0){base=0}base=base*parseInt(ts.p.rowNum,10);to=base+ts.p.reccount;if(ts.p.scroll){var rows=$("tbody:first > tr:gt(0)",ts.grid.bDiv);base=to-rows.length;ts.p.reccount=rows.length;var rh=rows.outerHeight()||ts.grid.prevRowHeight;if(rh){var top=base*rh;var height=parseInt(ts.p.records,10)*rh;$(">div:first",ts.grid.bDiv).css({height:height}).children("div:first").css({height:top,display:top?"":"none"})}ts.grid.bDiv.scrollLeft=ts.grid.hDiv.scrollLeft}pgboxes=ts.p.pager?ts.p.pager:"";pgboxes+=ts.p.toppager?(pgboxes?","+ts.p.toppager:ts.p.toppager):"";if(pgboxes){fmt=$.jgrid.formatter.integer||{};cp=intNum(ts.p.page);last=intNum(ts.p.lastpage);$(".selbox",pgboxes).attr("disabled",false);if(ts.p.pginput===true){$(".ui-pg-input",pgboxes).val(ts.p.page);$("#sp_1",pgboxes).html($.fmatter?$.fmatter.util.NumberFormat(ts.p.lastpage,fmt):ts.p.lastpage)}if(ts.p.viewrecords){if(ts.p.reccount===0){$(".ui-paging-info",pgboxes).html(ts.p.emptyrecords)}else{from=base+1;tot=ts.p.records;if($.fmatter){from=$.fmatter.util.NumberFormat(from,fmt);to=$.fmatter.util.NumberFormat(to,fmt);tot=$.fmatter.util.NumberFormat(tot,fmt)}$(".ui-paging-info",pgboxes).html($.jgrid.format(ts.p.recordtext,from,to,tot))}}if(ts.p.pgbuttons===true){if(cp<=0){cp=last=0}if(cp==1||cp===0){$("#first, #prev",ts.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover");if(ts.p.toppager){$("#first_t, #prev_t",ts.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")}}else{$("#first, #prev",ts.p.pager).removeClass("ui-state-disabled");if(ts.p.toppager){$("#first_t, #prev_t",ts.p.toppager).removeClass("ui-state-disabled")}}if(cp==last||cp===0){$("#next, #last",ts.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover");if(ts.p.toppager){$("#next_t, #last_t",ts.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")}}else{$("#next, #last",ts.p.pager).removeClass("ui-state-disabled");if(ts.p.toppager){$("#next_t, #last_t",ts.p.toppager).removeClass("ui-state-disabled")}}}}if(rn===true&&ts.p.rownumbers===true){$("td.jqgrid-rownum",ts.rows).each(function(i){$(this).html(base+1+i)})}if(dnd&&ts.p.jqgdnd){$(ts).jqGrid("gridDnD","updateDnD")}if($.isFunction(ts.p.gridComplete)){ts.p.gridComplete.call(ts)}},beginReq=function(){ts.grid.hDiv.loading=true;if(ts.p.hiddengrid){return}switch(ts.p.loadui){case"disable":break;case"enable":$("#load_"+$.jgrid.jqID(ts.p.id)).show();break;case"block":$("#lui_"+$.jgrid.jqID(ts.p.id)).show();$("#load_"+$.jgrid.jqID(ts.p.id)).show();break}},endReq=function(){ts.grid.hDiv.loading=false;switch(ts.p.loadui){case"disable":break;case"enable":$("#load_"+$.jgrid.jqID(ts.p.id)).hide();break;case"block":$("#lui_"+$.jgrid.jqID(ts.p.id)).hide();$("#load_"+$.jgrid.jqID(ts.p.id)).hide();break}},populate=function(npage){if(!ts.grid.hDiv.loading){var pvis=ts.p.scroll&&npage===false;var prm={},dt,dstr,pN=ts.p.prmNames;if(ts.p.page<=0){ts.p.page=1}if(pN.search!==null){prm[pN.search]=ts.p.search}if(pN.nd!==null){prm[pN.nd]=new Date().getTime()}if(pN.rows!==null){prm[pN.rows]=ts.p.rowNum}if(pN.page!==null){prm[pN.page]=ts.p.page}if(pN.sort!==null){prm[pN.sort]=ts.p.sortname}if(pN.order!==null){prm[pN.order]=ts.p.sortorder}if(ts.p.rowTotal!==null&&pN.totalrows!==null){prm[pN.totalrows]=ts.p.rowTotal}var lc=ts.p.loadComplete;var lcf=$.isFunction(lc);if(!lcf){lc=null}var adjust=0;npage=npage||1;if(npage>1){if(pN.npage!==null){prm[pN.npage]=npage;adjust=npage-1;npage=1}else{lc=function(req){ts.p.page++;ts.grid.hDiv.loading=false;if(lcf){ts.p.loadComplete.call(ts,req)}populate(npage-1)}}}else{if(pN.npage!==null){delete ts.p.postData[pN.npage]}}if(ts.p.grouping){$(ts).jqGrid("groupingSetup");if(ts.p.groupingView.groupDataSorted===true){prm[pN.sort]=ts.p.groupingView.groupField[0]+" "+ts.p.groupingView.groupOrder[0]+", "+prm[pN.sort]}}$.extend(ts.p.postData,prm);var rcnt=!ts.p.scroll?1:ts.rows.length-1;if($.isFunction(ts.p.datatype)){ts.p.datatype.call(ts,ts.p.postData,"load_"+ts.p.id);return}else{if($.isFunction(ts.p.beforeRequest)){ts.p.beforeRequest.call(ts)}}dt=ts.p.datatype.toLowerCase();switch(dt){case"json":case"jsonp":case"xml":case"script":$.ajax($.extend({url:ts.p.url,type:ts.p.mtype,dataType:dt,data:$.isFunction(ts.p.serializeGridData)?ts.p.serializeGridData.call(ts,ts.p.postData):ts.p.postData,success:function(data,st){if(dt==="xml"){addXmlData(data,ts.grid.bDiv,rcnt,npage>1,adjust)}else{addJSONData(data,ts.grid.bDiv,rcnt,npage>1,adjust)}if(lc){lc.call(ts,data)}if(pvis){ts.grid.populateVisible()}if(ts.p.loadonce||ts.p.treeGrid){ts.p.datatype="local"}data=null;endReq()},error:function(xhr,st,err){if($.isFunction(ts.p.loadError)){ts.p.loadError.call(ts,xhr,st,err)}endReq();xhr=null},beforeSend:function(xhr){beginReq();if($.isFunction(ts.p.loadBeforeSend)){ts.p.loadBeforeSend.call(ts,xhr)}}},$.jgrid.ajaxOptions,ts.p.ajaxGridOptions));break;case"xmlstring":beginReq();dstr=$.jgrid.stringToDoc(ts.p.datastr);addXmlData(dstr,ts.grid.bDiv);if(lcf){ts.p.loadComplete.call(ts,dstr)}ts.p.datatype="local";ts.p.datastr=null;endReq();break;case"jsonstring":beginReq();if(typeof ts.p.datastr=="string"){dstr=$.jgrid.parse(ts.p.datastr)}else{dstr=ts.p.datastr}addJSONData(dstr,ts.grid.bDiv);if(lcf){ts.p.loadComplete.call(ts,dstr)}ts.p.datatype="local";ts.p.datastr=null;endReq();break;case"local":case"clientside":beginReq();ts.p.datatype="local";var req=addLocalData();addJSONData(req,ts.grid.bDiv,rcnt,npage>1,adjust);if(lc){lc.call(ts,req)}if(pvis){ts.grid.populateVisible()
}endReq();break}}},setPager=function(pgid,tp){var sep="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",pginp="",pgl="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",str="",pgcnt,lft,cent,rgt,twd,tdw,i,clearVals=function(onpaging){var ret;if($.isFunction(ts.p.onPaging)){ret=ts.p.onPaging.call(ts,onpaging)}ts.p.selrow=null;if(ts.p.multiselect){ts.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false)}ts.p.savedRow=[];if(ret=="stop"){return false}return true};pgid=pgid.substr(1);pgcnt="pg_"+pgid;lft=pgid+"_left";cent=pgid+"_center";rgt=pgid+"_right";$("#"+$.jgrid.jqID(pgid)).append("<div id='"+pgcnt+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+lft+"' align='left'></td><td id='"+cent+"' align='center' style='white-space:pre;'></td><td id='"+rgt+"' align='right'></td></tr></tbody></table></div>").attr("dir","ltr");if(ts.p.rowList.length>0){str="<td dir='"+dir+"'>";str+="<select class='ui-pg-selbox' role='listbox'>";for(i=0;i<ts.p.rowList.length;i++){str+='<option role="option" value="'+ts.p.rowList[i]+'"'+((ts.p.rowNum==ts.p.rowList[i])?' selected="selected"':"")+">"+ts.p.rowList[i]+"</option>"}str+="</select></td>"}if(dir=="rtl"){pgl+=str}if(ts.p.pginput===true){pginp="<td dir='"+dir+"'>"+$.jgrid.format(ts.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1'></span>")+"</td>"}if(ts.p.pgbuttons===true){var po=["first"+tp,"prev"+tp,"next"+tp,"last"+tp];if(dir=="rtl"){po.reverse()}pgl+="<td id='"+po[0]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>";pgl+="<td id='"+po[1]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>";pgl+=pginp!==""?sep+pginp+sep:"";pgl+="<td id='"+po[2]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>";pgl+="<td id='"+po[3]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>"}else{if(pginp!==""){pgl+=pginp}}if(dir=="ltr"){pgl+=str}pgl+="</tr></tbody></table>";if(ts.p.viewrecords===true){$("td#"+pgid+"_"+ts.p.recordpos,"#"+pgcnt).append("<div dir='"+dir+"' style='text-align:"+ts.p.recordpos+"' class='ui-paging-info'></div>")}$("td#"+pgid+"_"+ts.p.pagerpos,"#"+pgcnt).append(pgl);tdw=$(".ui-jqgrid").css("font-size")||"11px";$(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+tdw+";visibility:hidden;' ></div>");twd=$(pgl).clone().appendTo("#testpg").width();$("#testpg").remove();if(twd>0){if(pginp!==""){twd+=50}$("td#"+pgid+"_"+ts.p.pagerpos,"#"+pgcnt).width(twd)}ts.p._nvtd=[];ts.p._nvtd[0]=twd?Math.floor((ts.p.width-twd)/2):Math.floor(ts.p.width/3);ts.p._nvtd[1]=0;pgl=null;$(".ui-pg-selbox","#"+pgcnt).bind("change",function(){ts.p.page=Math.round(ts.p.rowNum*(ts.p.page-1)/this.value-0.5)+1;ts.p.rowNum=this.value;if(tp){$(".ui-pg-selbox",ts.p.pager).val(this.value)}else{if(ts.p.toppager){$(".ui-pg-selbox",ts.p.toppager).val(this.value)}}if(!clearVals("records")){return false}populate();return false});if(ts.p.pgbuttons===true){$(".ui-pg-button","#"+pgcnt).hover(function(e){if($(this).hasClass("ui-state-disabled")){this.style.cursor="default"}else{$(this).addClass("ui-state-hover");this.style.cursor="pointer"}},function(e){if($(this).hasClass("ui-state-disabled")){}else{$(this).removeClass("ui-state-hover");this.style.cursor="default"}});$("#first"+tp+", #prev"+tp+", #next"+tp+", #last"+tp,"#"+pgid).click(function(e){var cp=intNum(ts.p.page,1),last=intNum(ts.p.lastpage,1),selclick=false,fp=true,pp=true,np=true,lp=true;if(last===0||last===1){fp=false;pp=false;np=false;lp=false}else{if(last>1&&cp>=1){if(cp===1){fp=false;pp=false}else{if(cp>1&&cp<last){}else{if(cp===last){np=false;lp=false}}}}else{if(last>1&&cp===0){np=false;lp=false;cp=last-1}}}if(this.id==="first"+tp&&fp){ts.p.page=1;selclick=true}if(this.id==="prev"+tp&&pp){ts.p.page=(cp-1);selclick=true}if(this.id==="next"+tp&&np){ts.p.page=(cp+1);selclick=true}if(this.id==="last"+tp&&lp){ts.p.page=last;selclick=true}if(selclick){if(!clearVals(this.id)){return false}populate()}return false})}if(ts.p.pginput===true){$("input.ui-pg-input","#"+pgcnt).keypress(function(e){var key=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(key==13){ts.p.page=($(this).val()>0)?$(this).val():ts.p.page;if(!clearVals("user")){return false}populate();return false}return this})}},sortData=function(index,idxcol,reload,sor){if(!ts.p.colModel[idxcol].sortable){return}var so;if(ts.p.savedRow.length>0){return}if(!reload){if(ts.p.lastsort==idxcol){if(ts.p.sortorder=="asc"){ts.p.sortorder="desc"}else{if(ts.p.sortorder=="desc"){ts.p.sortorder="asc"}}}else{ts.p.sortorder=ts.p.colModel[idxcol].firstsortorder||"asc"}ts.p.page=1}if(sor){if(ts.p.lastsort==idxcol&&ts.p.sortorder==sor&&!reload){return}else{ts.p.sortorder=sor}}var thd=$("thead:first",ts.grid.hDiv).get(0);$("tr th:eq("+ts.p.lastsort+") span.ui-grid-ico-sort",thd).addClass("ui-state-disabled");$("tr th:eq("+ts.p.lastsort+")",thd).attr("aria-selected","false");$("tr th:eq("+idxcol+") span.ui-icon-"+ts.p.sortorder,thd).removeClass("ui-state-disabled");$("tr th:eq("+idxcol+")",thd).attr("aria-selected","true");if(!ts.p.viewsortcols[0]){if(ts.p.lastsort!=idxcol){$("tr th:eq("+ts.p.lastsort+") span.s-ico",thd).hide();$("tr th:eq("+idxcol+") span.s-ico",thd).show()}}index=index.substring(5);ts.p.sortname=ts.p.colModel[idxcol].index||index;so=ts.p.sortorder;if($.isFunction(ts.p.onSortCol)){if(ts.p.onSortCol.call(ts,index,idxcol,so)=="stop"){ts.p.lastsort=idxcol;return}}if(ts.p.datatype=="local"){if(ts.p.deselectAfterSort){$(ts).jqGrid("resetSelection")}}else{ts.p.selrow=null;if(ts.p.multiselect){$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false)}ts.p.selarrrow=[];ts.p.savedRow=[]}if(ts.p.scroll){var sscroll=ts.grid.bDiv.scrollLeft;emptyRows(ts.grid.bDiv,true,false);ts.grid.hDiv.scrollLeft=sscroll}if(ts.p.subGrid&&ts.p.datatype=="local"){$("td.sgexpanded","#"+$.jgrid.jqID(ts.p.id)).each(function(){$(this).trigger("click")})}populate();ts.p.lastsort=idxcol;if(ts.p.sortname!=index&&idxcol){ts.p.lastsort=idxcol}},setColWidth=function(){var initwidth=0,brd=isSafari?0:ts.p.cellLayout,vc=0,lvc,scw=ts.p.scrollOffset,cw,hs=false,aw,gw=0,cl=0,cr;$.each(ts.p.colModel,function(i){if(typeof this.hidden==="undefined"){this.hidden=false}this.widthOrg=cw=intNum(this.width,0);if(this.hidden===false){initwidth+=cw+brd;if(this.fixed){gw+=cw+brd}else{vc++}cl++}});if(isNaN(ts.p.width)){ts.p.width=grid.width=initwidth}else{grid.width=ts.p.width}ts.p.tblwidth=initwidth;if(ts.p.shrinkToFit===false&&ts.p.forceFit===true){ts.p.forceFit=false}if(ts.p.shrinkToFit===true&&vc>0){aw=grid.width-brd*vc-gw;if(isNaN(ts.p.height)){}else{aw-=scw;hs=true}initwidth=0;$.each(ts.p.colModel,function(i){if(this.hidden===false&&!this.fixed){cw=Math.round(aw*this.width/(ts.p.tblwidth-brd*vc-gw));this.width=cw;initwidth+=cw;lvc=i}});cr=0;if(hs){if(grid.width-gw-(initwidth+brd*vc)!==scw){cr=grid.width-gw-(initwidth+brd*vc)-scw}}else{if(!hs&&Math.abs(grid.width-gw-(initwidth+brd*vc))!==1){cr=grid.width-gw-(initwidth+brd*vc)}}ts.p.colModel[lvc].width+=cr;ts.p.tblwidth=initwidth+cr+brd*vc+gw;if(ts.p.tblwidth>ts.p.width){ts.p.colModel[lvc].width-=(ts.p.tblwidth-parseInt(ts.p.width,10));
ts.p.tblwidth=ts.p.width}}},nextVisible=function(iCol){var ret=iCol,j=iCol,i;for(i=iCol+1;i<ts.p.colModel.length;i++){if(ts.p.colModel[i].hidden!==true){j=i;break}}return j-ret},getOffset=function(iCol){var i,ret={},brd1=isSafari?0:ts.p.cellLayout;ret[0]=ret[1]=ret[2]=0;for(i=0;i<=iCol;i++){if(ts.p.colModel[i].hidden===false){ret[0]+=ts.p.colModel[i].width+brd1}}if(ts.p.direction=="rtl"){ret[0]=ts.p.width-ret[0]}ret[0]=ret[0]-ts.grid.bDiv.scrollLeft;if($(ts.grid.cDiv).is(":visible")){ret[1]+=$(ts.grid.cDiv).height()+parseInt($(ts.grid.cDiv).css("padding-top"),10)+parseInt($(ts.grid.cDiv).css("padding-bottom"),10)}if(ts.p.toolbar[0]===true&&(ts.p.toolbar[1]=="top"||ts.p.toolbar[1]=="both")){ret[1]+=$(ts.grid.uDiv).height()+parseInt($(ts.grid.uDiv).css("border-top-width"),10)+parseInt($(ts.grid.uDiv).css("border-bottom-width"),10)}if(ts.p.toppager){ret[1]+=$(ts.grid.topDiv).height()+parseInt($(ts.grid.topDiv).css("border-bottom-width"),10)}ret[2]+=$(ts.grid.bDiv).height()+$(ts.grid.hDiv).height();return ret};this.p.id=this.id;if($.inArray(ts.p.multikey,sortkeys)==-1){ts.p.multikey=false}ts.p.keyIndex=false;for(i=0;i<ts.p.colModel.length;i++){ts.p.colModel[i]=$.extend(true,{},ts.p.cmTemplate,ts.p.colModel[i].template||{},ts.p.colModel[i]);if(ts.p.keyIndex===false&&ts.p.colModel[i].key===true){ts.p.keyIndex=i}}ts.p.sortorder=ts.p.sortorder.toLowerCase();if(ts.p.grouping===true){ts.p.scroll=false;ts.p.rownumbers=false;ts.p.subGrid=false;ts.p.treeGrid=false;ts.p.gridview=true}if(this.p.treeGrid===true){try{$(this).jqGrid("setTreeGrid")}catch(_){}if(ts.p.datatype!="local"){ts.p.localReader={id:"_id_"}}}if(this.p.subGrid){try{$(ts).jqGrid("setSubGrid")}catch(s){}}if(this.p.multiselect){this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>");this.p.colModel.unshift({name:"cb",width:isSafari?ts.p.multiselectWidth+ts.p.cellLayout:ts.p.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}if(this.p.rownumbers){this.p.colNames.unshift("");this.p.colModel.unshift({name:"rn",width:ts.p.rownumWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}ts.p.xmlReader=$.extend(true,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:true,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:true,cell:"cell"}},ts.p.xmlReader);ts.p.jsonReader=$.extend(true,{root:"rows",page:"page",total:"total",records:"records",repeatitems:true,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},ts.p.jsonReader);ts.p.localReader=$.extend(true,{root:"rows",page:"page",total:"total",records:"records",repeatitems:false,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},ts.p.localReader);if(ts.p.scroll){ts.p.pgbuttons=false;ts.p.pginput=false;ts.p.rowList=[]}if(ts.p.data.length){refreshIndex()}var thead="<thead><tr class='ui-jqgrid-labels' role='rowheader'>",tdc,idn,w,res,sort,td,ptr,tbody,imgs,iac="",idc="";if(ts.p.shrinkToFit===true&&ts.p.forceFit===true){for(i=ts.p.colModel.length-1;i>=0;i--){if(!ts.p.colModel[i].hidden){ts.p.colModel[i].resizable=false;break}}}if(ts.p.viewsortcols[1]=="horizontal"){iac=" ui-i-asc";idc=" ui-i-desc"}tdc=isMSIE?"class='ui-th-div-ie'":"";imgs="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+iac+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+dir+"'></span>";imgs+="<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+idc+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+dir+"'></span></span>";for(i=0;i<this.p.colNames.length;i++){var tooltip=ts.p.headertitles?(' title="'+$.jgrid.stripHtml(ts.p.colNames[i])+'"'):"";thead+="<th id='"+ts.p.id+"_"+ts.p.colModel[i].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+dir+"'"+tooltip+">";idn=ts.p.colModel[i].index||ts.p.colModel[i].name;thead+="<div id='jqgh_"+ts.p.colModel[i].name+"' "+tdc+">"+ts.p.colNames[i];if(!ts.p.colModel[i].width){ts.p.colModel[i].width=150}else{ts.p.colModel[i].width=parseInt(ts.p.colModel[i].width,10)}if(typeof(ts.p.colModel[i].title)!=="boolean"){ts.p.colModel[i].title=true}if(idn==ts.p.sortname){ts.p.lastsort=i}thead+=imgs+"</div></th>"}thead+="</tr></thead>";imgs=null;$(this).append(thead);$("thead tr:first th",this).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});if(this.p.multiselect){var emp=[],chk;$("#cb_"+$.jgrid.jqID(ts.p.id),this).bind("click",function(){ts.p.selarrrow=[];if(this.checked){$(ts.rows).each(function(i){if(i>0){if(!$(this).hasClass("subgrid")&&!$(this).hasClass("jqgroup")&&!$(this).hasClass("ui-state-disabled")){$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id)).attr("checked","checked");$(this).addClass("ui-state-highlight").attr("aria-selected","true");ts.p.selarrrow.push(this.id);ts.p.selrow=this.id}}});chk=true;emp=[]}else{$(ts.rows).each(function(i){if(i>0){if(!$(this).hasClass("subgrid")&&!$(this).hasClass("ui-state-disabled")){$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id)).removeAttr("checked");$(this).removeClass("ui-state-highlight").attr("aria-selected","false");emp.push(this.id)}}});ts.p.selrow=null;chk=false}if($.isFunction(ts.p.onSelectAll)){ts.p.onSelectAll.call(ts,chk?ts.p.selarrrow:emp,chk)}})}if(ts.p.autowidth===true){var pw=$(eg).innerWidth();ts.p.width=pw>0?pw:"nw"}setColWidth();$(eg).css("width",grid.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+ts.p.id+"'>&#160;</div>");$(gv).css("width",grid.width+"px");thead=$("thead:first",ts).get(0);var tfoot="";if(ts.p.footerrow){tfoot+="<table role='grid' style='width:"+ts.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+dir+"'>"}var thr=$("tr:first",thead),firstr="<tr class='jqgfirstrow' role='row' style='height:auto'>";ts.p.disableClick=false;$("th",thr).each(function(j){w=ts.p.colModel[j].width;if(typeof ts.p.colModel[j].resizable==="undefined"){ts.p.colModel[j].resizable=true}if(ts.p.colModel[j].resizable){res=document.createElement("span");$(res).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+dir);if(!$.browser.opera){$(res).css("cursor","col-resize")}$(this).addClass(ts.p.resizeclass)}else{res=""}$(this).css("width",w+"px").prepend(res);var hdcol="";if(ts.p.colModel[j].hidden){$(this).css("display","none");hdcol="display:none;"}firstr+="<td role='gridcell' style='height:0px;width:"+w+"px;"+hdcol+"'></td>";grid.headers[j]={width:w,el:this};sort=ts.p.colModel[j].sortable;if(typeof sort!=="boolean"){ts.p.colModel[j].sortable=true;sort=true}var nm=ts.p.colModel[j].name;if(!(nm=="cb"||nm=="subgrid"||nm=="rn")){if(ts.p.viewsortcols[2]){$("div",this).addClass("ui-jqgrid-sortable")}}if(sort){if(ts.p.viewsortcols[0]){$("div span.s-ico",this).show();if(j==ts.p.lastsort){$("div span.ui-icon-"+ts.p.sortorder,this).removeClass("ui-state-disabled")}}else{if(j==ts.p.lastsort){$("div span.s-ico",this).show();$("div span.ui-icon-"+ts.p.sortorder,this).removeClass("ui-state-disabled")}}}if(ts.p.footerrow){tfoot+="<td role='gridcell' "+formatCol(j,0,"",null,"",false)+">&#160;</td>"}}).mousedown(function(e){if($(e.target).closest("th>span.ui-jqgrid-resize").length!=1){return}var ci=$.jgrid.getCellIndex(this);if(ts.p.forceFit===true){ts.p.nv=nextVisible(ci)}grid.dragStart(ci,e,getOffset(ci));
return false}).click(function(e){if(ts.p.disableClick){ts.p.disableClick=false;return false}var s="th>div.ui-jqgrid-sortable",r,d;if(!ts.p.viewsortcols[2]){s="th>div>span>span.ui-grid-ico-sort"}var t=$(e.target).closest(s);if(t.length!=1){return}var ci=$.jgrid.getCellIndex(this);if(!ts.p.viewsortcols[2]){r=true;d=t.attr("sort")}sortData($("div",this)[0].id,ci,r,d);return false});if(ts.p.sortable&&$.fn.sortable){try{$(ts).jqGrid("sortableColumns",thr)}catch(e){}}if(ts.p.footerrow){tfoot+="</tr></tbody></table>"}firstr+="</tr>";tbody=document.createElement("tbody");this.appendChild(tbody);$(this).addClass("ui-jqgrid-btable").append(firstr);firstr=null;var hTable=$("<table class='ui-jqgrid-htable' style='width:"+ts.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(thead),hg=(ts.p.caption&&ts.p.hiddengrid===true)?true:false,hb=$("<div class='ui-jqgrid-hbox"+(dir=="rtl"?"-rtl":"")+"'></div>");thead=null;grid.hDiv=document.createElement("div");$(grid.hDiv).css({width:grid.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(hb);$(hb).append(hTable);hTable=null;if(hg){$(grid.hDiv).hide()}if(ts.p.pager){if(typeof ts.p.pager=="string"){if(ts.p.pager.substr(0,1)!="#"){ts.p.pager="#"+ts.p.pager}}else{ts.p.pager="#"+$(ts.p.pager).attr("id")}$(ts.p.pager).css({width:grid.width+"px"}).appendTo(eg).addClass("ui-state-default ui-jqgrid-pager ui-corner-bottom");if(hg){$(ts.p.pager).hide()}setPager(ts.p.pager,"")}if(ts.p.cellEdit===false&&ts.p.hoverrows===true){$(ts).bind("mouseover",function(e){ptr=$(e.target).closest("tr.jqgrow");if($(ptr).attr("class")!=="subgrid"){$(ptr).addClass("ui-state-hover")}return false}).bind("mouseout",function(e){ptr=$(e.target).closest("tr.jqgrow");$(ptr).removeClass("ui-state-hover");return false})}var ri,ci;$(ts).before(grid.hDiv).click(function(e){td=e.target;ptr=$(td,ts.rows).closest("tr.jqgrow");if($(ptr).length===0||ptr[0].className.indexOf("ui-state-disabled")>-1){return this}var scb=$(td).hasClass("cbox"),cSel=true;if($.isFunction(ts.p.beforeSelectRow)){cSel=ts.p.beforeSelectRow.call(ts,ptr[0].id,e)}if(td.tagName=="A"||((td.tagName=="INPUT"||td.tagName=="TEXTAREA"||td.tagName=="OPTION"||td.tagName=="SELECT")&&!scb)){return this}if(cSel===true){if(ts.p.cellEdit===true){if(ts.p.multiselect&&scb){$(ts).jqGrid("setSelection",ptr[0].id,true)}else{ri=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);try{$(ts).jqGrid("editCell",ri,ci,true)}catch(_){}}}else{if(!ts.p.multikey){if(ts.p.multiselect&&ts.p.multiboxonly){if(scb){$(ts).jqGrid("setSelection",ptr[0].id,true)}else{$(ts.p.selarrrow).each(function(i,n){var ind=ts.rows.namedItem(n);$(ind).removeClass("ui-state-highlight");$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(n)).attr("checked",false)});ts.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false);$(ts).jqGrid("setSelection",ptr[0].id,true)}}else{$(ts).jqGrid("setSelection",ptr[0].id,true)}}else{if(e[ts.p.multikey]){$(ts).jqGrid("setSelection",ptr[0].id,true)}else{if(ts.p.multiselect&&scb){scb=$("[id^=jqg_"+$.jgrid.jqID(ts.p.id)+"_]").attr("checked");$("[id^=jqg_"+$.jgrid.jqID(ts.p.id)+"_]").attr("checked",!scb)}}}}if($.isFunction(ts.p.onCellSelect)){ri=ptr[0].id;ci=$.jgrid.getCellIndex(td);ts.p.onCellSelect.call(ts,ri,ci,$(td).html(),e)}e.stopPropagation()}else{return this}}).bind("reloadGrid",function(e,opts){if(ts.p.treeGrid===true){ts.p.datatype=ts.p.treedatatype}if(opts&&opts.current){ts.grid.selectionPreserver(ts)}if(ts.p.datatype=="local"){$(ts).jqGrid("resetSelection");if(ts.p.data.length){refreshIndex()}}else{if(!ts.p.treeGrid){ts.p.selrow=null;if(ts.p.multiselect){ts.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false)}ts.p.savedRow=[]}}if(ts.p.scroll){emptyRows(ts.grid.bDiv,true,false)}if(opts&&opts.page){var page=opts.page;if(page>ts.p.lastpage){page=ts.p.lastpage}if(page<1){page=1}ts.p.page=page;if(ts.grid.prevRowHeight){ts.grid.bDiv.scrollTop=(page-1)*ts.grid.prevRowHeight*ts.p.rowNum}else{ts.grid.bDiv.scrollTop=0}}if(ts.grid.prevRowHeight&&ts.p.scroll){delete ts.p.lastpage;ts.grid.populateVisible()}else{ts.grid.populate()}return false});if($.isFunction(this.p.ondblClickRow)){$(this).dblclick(function(e){td=e.target;ptr=$(td,ts.rows).closest("tr.jqgrow");if($(ptr).length===0){return false}ri=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);ts.p.ondblClickRow.call(ts,$(ptr).attr("id"),ri,ci,e);return false})}if($.isFunction(this.p.onRightClickRow)){$(this).bind("contextmenu",function(e){td=e.target;ptr=$(td,ts.rows).closest("tr.jqgrow");if($(ptr).length===0){return false}if(!ts.p.multiselect){$(ts).jqGrid("setSelection",ptr[0].id,true)}ri=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);ts.p.onRightClickRow.call(ts,$(ptr).attr("id"),ri,ci,e);return false})}grid.bDiv=document.createElement("div");if(isMSIE){if(String(ts.p.height).toLowerCase()==="auto"){ts.p.height="100%"}}$(grid.bDiv).append($('<div style="position:relative;'+(isMSIE&&$.browser.version<8?"height:0.01%;":"")+'"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:ts.p.height+(isNaN(ts.p.height)?"":"px"),width:(grid.width)+"px"}).scroll(grid.scrollGrid);$("table:first",grid.bDiv).css({width:ts.p.tblwidth+"px"});if(isMSIE){if($("tbody",this).size()==2){$("tbody:gt(0)",this).remove()}if(ts.p.multikey){$(grid.bDiv).bind("selectstart",function(){return false})}}else{if(ts.p.multikey){$(grid.bDiv).bind("mousedown",function(){return false})}}if(hg){$(grid.bDiv).hide()}grid.cDiv=document.createElement("div");var arf=ts.p.hidegrid===true?$("<a role='link' href='javascript:void(0)'/>").addClass("ui-jqgrid-titlebar-close HeaderButton").hover(function(){arf.addClass("ui-state-hover")},function(){arf.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css((dir=="rtl"?"left":"right"),"0px"):"";$(grid.cDiv).append(arf).append("<span class='ui-jqgrid-title"+(dir=="rtl"?"-rtl":"")+"'>"+ts.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header ui-corner-top ui-helper-clearfix");$(grid.cDiv).insertBefore(grid.hDiv);if(ts.p.toolbar[0]){grid.uDiv=document.createElement("div");if(ts.p.toolbar[1]=="top"){$(grid.uDiv).insertBefore(grid.hDiv)}else{if(ts.p.toolbar[1]=="bottom"){$(grid.uDiv).insertAfter(grid.hDiv)}}if(ts.p.toolbar[1]=="both"){grid.ubDiv=document.createElement("div");$(grid.uDiv).insertBefore(grid.hDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id);$(grid.ubDiv).insertAfter(grid.hDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id);if(hg){$(grid.ubDiv).hide()}}else{$(grid.uDiv).width(grid.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id)}if(hg){$(grid.uDiv).hide()}}if(ts.p.toppager){ts.p.toppager=$.jgrid.jqID(ts.p.id)+"_toppager";grid.topDiv=$("<div id='"+ts.p.toppager+"'></div>")[0];ts.p.toppager="#"+ts.p.toppager;$(grid.topDiv).insertBefore(grid.hDiv).addClass("ui-state-default ui-jqgrid-toppager").width(grid.width);setPager(ts.p.toppager,"_t")}if(ts.p.footerrow){grid.sDiv=$("<div class='ui-jqgrid-sdiv'></div>")[0];hb=$("<div class='ui-jqgrid-hbox"+(dir=="rtl"?"-rtl":"")+"'></div>");$(grid.sDiv).append(hb).insertAfter(grid.hDiv).width(grid.width);$(hb).append(tfoot);grid.footers=$(".ui-jqgrid-ftable",grid.sDiv)[0].rows[0].cells;if(ts.p.rownumbers){grid.footers[0].className="ui-state-default jqgrid-rownum"}if(hg){$(grid.sDiv).hide()}}hb=null;if(ts.p.caption){var tdt=ts.p.datatype;if(ts.p.hidegrid===true){$(".ui-jqgrid-titlebar-close",grid.cDiv).click(function(e){var onHdCl=$.isFunction(ts.p.onHeaderClick),elems=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",counter,self=this;
if(ts.p.toolbar[0]===true){if(ts.p.toolbar[1]=="both"){elems+=", #"+$(grid.ubDiv).attr("id")}elems+=", #"+$(grid.uDiv).attr("id")}counter=$(elems,"#gview_"+$.jgrid.jqID(ts.p.id)).length;if(ts.p.gridstate=="visible"){$(elems,"#gbox_"+$.jgrid.jqID(ts.p.id)).slideUp("fast",function(){counter--;if(counter===0){$("span",self).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");ts.p.gridstate="hidden";if($("#gbox_"+$.jgrid.jqID(ts.p.id)).hasClass("ui-resizable")){$(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(ts.p.id)).hide()}if(onHdCl){if(!hg){ts.p.onHeaderClick.call(ts,ts.p.gridstate,e)}}}})}else{if(ts.p.gridstate=="hidden"){$(elems,"#gbox_"+$.jgrid.jqID(ts.p.id)).slideDown("fast",function(){counter--;if(counter===0){$("span",self).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");if(hg){ts.p.datatype=tdt;populate();hg=false}ts.p.gridstate="visible";if($("#gbox_"+$.jgrid.jqID(ts.p.id)).hasClass("ui-resizable")){$(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(ts.p.id)).show()}if(onHdCl){if(!hg){ts.p.onHeaderClick.call(ts,ts.p.gridstate,e)}}}})}}return false});if(hg){ts.p.datatype="local";$(".ui-jqgrid-titlebar-close",grid.cDiv).trigger("click")}}}else{$(grid.cDiv).hide()}$(grid.hDiv).after(grid.bDiv).mousemove(function(e){if(grid.resizing){grid.dragMove(e);return false}});$(".ui-jqgrid-labels",grid.hDiv).bind("selectstart",function(){return false});$(document).mouseup(function(e){if(grid.resizing){grid.dragEnd();return false}return true});ts.formatCol=formatCol;ts.sortData=sortData;ts.updatepager=updatepager;ts.refreshIndex=refreshIndex;ts.formatter=function(rowId,cellval,colpos,rwdat,act){return formatter(rowId,cellval,colpos,rwdat,act)};$.extend(grid,{populate:populate,emptyRows:emptyRows});this.grid=grid;ts.addXmlData=function(d){addXmlData(d,ts.grid.bDiv)};ts.addJSONData=function(d){addJSONData(d,ts.grid.bDiv)};this.grid.cols=this.rows[0].cells;populate();ts.p.hiddengrid=false;$(window).unload(function(){ts=null})})};$.jgrid.extend({getGridParam:function(pName){var $t=this[0];if(!$t||!$t.grid){return}if(!pName){return $t.p}else{return typeof($t.p[pName])!="undefined"?$t.p[pName]:null}},setGridParam:function(newParams){return this.each(function(){if(this.grid&&typeof(newParams)==="object"){$.extend(true,this.p,newParams)}})},getDataIDs:function(){var ids=[],i=0,len,j=0;this.each(function(){len=this.rows.length;if(len&&len>0){while(i<len){if($(this.rows[i]).hasClass("jqgrow")){ids[j]=this.rows[i].id;j++}i++}}});return ids},setSelection:function(selection,onsr){return this.each(function(){var $t=this,stat,pt,ner,ia,tpsr;if(selection===undefined){return}onsr=onsr===false?false:true;pt=$t.rows.namedItem(selection+"");if(!pt||pt.className.indexOf("ui-state-disabled")>-1){return}function scrGrid(iR){var ch=$($t.grid.bDiv)[0].clientHeight,st=$($t.grid.bDiv)[0].scrollTop,rpos=$t.rows[iR].offsetTop,rh=$t.rows[iR].clientHeight;if(rpos+rh>=ch+st){$($t.grid.bDiv)[0].scrollTop=rpos-(ch+st)+rh+st}else{if(rpos<ch+st){if(rpos<st){$($t.grid.bDiv)[0].scrollTop=rpos}}}}if($t.p.scrollrows===true){ner=$t.rows.namedItem(selection).rowIndex;if(ner>=0){scrGrid(ner)}}if(!$t.p.multiselect){if(pt.className!=="ui-subgrid"){if($t.p.selrow!=pt.id){$($t.rows.namedItem($t.p.selrow)).removeClass("ui-state-highlight").attr({"aria-selected":"false",tabindex:"-1"});$(pt).addClass("ui-state-highlight").attr({"aria-selected":true,tabindex:"0"});stat=true}else{stat=false}$t.p.selrow=pt.id;if($t.p.onSelectRow&&onsr){$t.p.onSelectRow.call($t,pt.id,stat)}}}else{$t.p.selrow=pt.id;ia=$.inArray($t.p.selrow,$t.p.selarrrow);if(ia===-1){if(pt.className!=="ui-subgrid"){$(pt).addClass("ui-state-highlight").attr("aria-selected","true")}stat=true;$("#jqg_"+$.jgrid.jqID($t.p.id)+"_"+$.jgrid.jqID($t.p.selrow)).attr("checked",stat);$t.p.selarrrow.push($t.p.selrow)}else{if(pt.className!=="ui-subgrid"){$(pt).removeClass("ui-state-highlight").attr("aria-selected","false")}stat=false;$("#jqg_"+$.jgrid.jqID($t.p.id)+"_"+$.jgrid.jqID($t.p.selrow)).attr("checked",stat);$t.p.selarrrow.splice(ia,1);tpsr=$t.p.selarrrow[0];$t.p.selrow=(tpsr===undefined)?null:tpsr}if($t.p.onSelectRow&&onsr){$t.p.onSelectRow.call($t,pt.id,stat)}}})},resetSelection:function(rowid){return this.each(function(){var t=this,ind,sr;if(typeof(rowid)!=="undefined"){sr=rowid===t.p.selrow?t.p.selrow:rowid;$("#"+$.jgrid.jqID(t.p.id)+" tbody:first tr#"+$.jgrid.jqID(sr)).removeClass("ui-state-highlight").attr("aria-selected","false");if(t.p.multiselect){$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(sr)).attr("checked",false);$("#cb_"+$.jgrid.jqID(t.p.id)).attr("checked",false)}sr=null}else{if(!t.p.multiselect){if(t.p.selrow){$("#"+$.jgrid.jqID(t.p.id)+" tbody:first tr#"+$.jgrid.jqID(t.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false");t.p.selrow=null}}else{$(t.p.selarrrow).each(function(i,n){ind=t.rows.namedItem(n);$(ind).removeClass("ui-state-highlight").attr("aria-selected","false");$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(n)).attr("checked",false)});$("#cb_"+$.jgrid.jqID(t.p.id)).attr("checked",false);t.p.selarrrow=[]}}t.p.savedRow=[]})},getRowData:function(rowid){var res={},resall,getall=false,len,j=0;this.each(function(){var $t=this,nm,ind;if(typeof(rowid)=="undefined"){getall=true;resall=[];len=$t.rows.length}else{ind=$t.rows.namedItem(rowid);if(!ind){return res}len=2}while(j<len){if(getall){ind=$t.rows[j]}if($(ind).hasClass("jqgrow")){$("td",ind).each(function(i){nm=$t.p.colModel[i].name;if(nm!=="cb"&&nm!=="subgrid"&&nm!=="rn"){if($t.p.treeGrid===true&&nm==$t.p.ExpandColumn){res[nm]=$.jgrid.htmlDecode($("span:first",this).html())}else{try{res[nm]=$.unformat(this,{rowId:ind.id,colModel:$t.p.colModel[i]},i)}catch(e){res[nm]=$.jgrid.htmlDecode($(this).html())}}}});if(getall){resall.push(res);res={}}}j++}});return resall?resall:res},delRowData:function(rowid){var success=false,rowInd,ia,ri;this.each(function(){var $t=this;rowInd=$t.rows.namedItem(rowid);if(!rowInd){return false}else{ri=rowInd.rowIndex;$(rowInd).remove();$t.p.records--;$t.p.reccount--;$t.updatepager(true,false);success=true;if($t.p.multiselect){ia=$.inArray(rowid,$t.p.selarrrow);if(ia!=-1){$t.p.selarrrow.splice(ia,1)}}if(rowid==$t.p.selrow){$t.p.selrow=null}}if($t.p.datatype=="local"){var pos=$t.p._index[rowid];if(typeof(pos)!="undefined"){$t.p.data.splice(pos,1);$t.refreshIndex()}}if($t.p.altRows===true&&success){var cn=$t.p.altclass;$($t.rows).each(function(i){if(i%2==1){$(this).addClass(cn)}else{$(this).removeClass(cn)}})}});return success},setRowData:function(rowid,data,cssp){var nm,success=true,title;this.each(function(){if(!this.grid){return false}var t=this,vl,ind,cp=typeof cssp,lcdata={};ind=t.rows.namedItem(rowid);if(!ind){return false}if(data){try{$(this.p.colModel).each(function(i){nm=this.name;if(data[nm]!==undefined){lcdata[nm]=this.formatter&&typeof(this.formatter)==="string"&&this.formatter=="date"?$.unformat.date(data[nm],this):data[nm];vl=t.formatter(rowid,data[nm],i,data,"edit");title=this.title?{title:$.jgrid.stripHtml(vl)}:{};if(t.p.treeGrid===true&&nm==t.p.ExpandColumn){$("td:eq("+i+") > span:first",ind).html(vl).attr(title)}else{$("td:eq("+i+")",ind).html(vl).attr(title)}}});if(t.p.datatype=="local"){var pos=t.p._index[rowid];if(t.p.treeGrid){for(var key in t.p.treeReader){if(lcdata.hasOwnProperty(t.p.treeReader[key])){delete lcdata[t.p.treeReader[key]]}}}if(typeof(pos)!="undefined"){t.p.data[pos]=$.extend(true,t.p.data[pos],lcdata)}lcdata=null}}catch(e){success=false}}if(success){if(cp==="string"){$(ind).addClass(cssp)
}else{if(cp==="object"){$(ind).css(cssp)}}}});return success},addRowData:function(rowid,rdata,pos,src){if(!pos){pos="last"}var success=false,nm,row,gi,si,ni,sind,i,v,prp="",aradd,cnm,cn,data,cm;if(rdata){if($.isArray(rdata)){aradd=true;pos="last";cnm=rowid}else{rdata=[rdata];aradd=false}this.each(function(){var t=this,datalen=rdata.length;ni=t.p.rownumbers===true?1:0;gi=t.p.multiselect===true?1:0;si=t.p.subGrid===true?1:0;if(!aradd){if(typeof(rowid)!="undefined"){rowid=rowid+""}else{rowid=$.jgrid.randId();if(t.p.keyIndex!==false){cnm=t.p.colModel[t.p.keyIndex+gi+si+ni].name;if(typeof rdata[0][cnm]!="undefined"){rowid=rdata[0][cnm]}}}}cn=t.p.altclass;var k=0,cna="",lcdata={},air=$.isFunction(t.p.afterInsertRow)?true:false;while(k<datalen){data=rdata[k];row="";if(aradd){try{rowid=data[cnm]}catch(e){rowid=$.jgrid.randId()}cna=t.p.altRows===true?(t.rows.length-1)%2===0?cn:"":""}if(ni){prp=t.formatCol(0,1,"",null,rowid,true);row+='<td role="gridcell" aria-describedby="'+t.p.id+'_rn" class="ui-state-default jqgrid-rownum" '+prp+">0</td>"}if(gi){v='<input role="checkbox" type="checkbox" id="jqg_'+t.p.id+"_"+rowid+'" class="cbox"/>';prp=t.formatCol(ni,1,"",null,rowid,true);row+='<td role="gridcell" aria-describedby="'+t.p.id+'_cb" '+prp+">"+v+"</td>"}if(si){row+=$(t).jqGrid("addSubGridCell",gi+ni,1)}for(i=gi+si+ni;i<t.p.colModel.length;i++){cm=t.p.colModel[i];nm=cm.name;lcdata[nm]=cm.formatter&&typeof(cm.formatter)==="string"&&cm.formatter=="date"?$.unformat.date(data[nm],cm):data[nm];v=t.formatter(rowid,$.jgrid.getAccessor(data,nm),i,data,"edit");prp=t.formatCol(i,1,v,rowid,data,true);row+='<td role="gridcell" aria-describedby="'+t.p.id+"_"+nm+'" '+prp+">"+v+"</td>"}row='<tr id="'+rowid+'" role="row" tabindex="-1" class="ui-widget-content jqgrow ui-row-'+t.p.direction+" "+cna+'">'+row+"</tr>";if(t.p.subGrid===true){row=$(row)[0];$(t).jqGrid("addSubGrid",row,gi+ni)}if(t.rows.length===0){$("table:first",t.grid.bDiv).append(row)}else{switch(pos){case"last":$(t.rows[t.rows.length-1]).after(row);break;case"first":$(t.rows[0]).after(row);break;case"after":sind=t.rows.namedItem(src);if(sind){if($(t.rows[sind.rowIndex+1]).hasClass("ui-subgrid")){$(t.rows[sind.rowIndex+1]).after(row)}else{$(sind).after(row)}}break;case"before":sind=t.rows.namedItem(src);if(sind){$(sind).before(row);sind=sind.rowIndex}break}}t.p.records++;t.p.reccount++;if(air){t.p.afterInsertRow.call(t,rowid,data,data)}k++;if(t.p.datatype=="local"){lcdata[t.p.localReader.id]=rowid;t.p._index[rowid]=t.p.data.length;t.p.data.push(lcdata);lcdata={}}}if(t.p.altRows===true&&!aradd){if(pos=="last"){if((t.rows.length-1)%2==1){$(t.rows[t.rows.length-1]).addClass(cn)}}else{$(t.rows).each(function(i){if(i%2==1){$(this).addClass(cn)}else{$(this).removeClass(cn)}})}}t.updatepager(true,true);success=true})}return success},footerData:function(action,data,format){var nm,success=false,res={},title;function isEmpty(obj){for(var i in obj){if(obj.hasOwnProperty(i)){return false}}return true}if(typeof(action)=="undefined"){action="get"}if(typeof(format)!="boolean"){format=true}action=action.toLowerCase();this.each(function(){var t=this,vl;if(!t.grid||!t.p.footerrow){return false}if(action=="set"){if(isEmpty(data)){return false}}success=true;$(this.p.colModel).each(function(i){nm=this.name;if(action=="set"){if(data[nm]!==undefined){vl=format?t.formatter("",data[nm],i,data,"edit"):data[nm];title=this.title?{title:$.jgrid.stripHtml(vl)}:{};$("tr.footrow td:eq("+i+")",t.grid.sDiv).html(vl).attr(title);success=true}}else{if(action=="get"){res[nm]=$("tr.footrow td:eq("+i+")",t.grid.sDiv).html()}}})});return action=="get"?res:success},showHideCol:function(colname,show){return this.each(function(){var $t=this,fndh=false,brd=$.browser.webkit||$.browser.safari?0:$t.p.cellLayout,cw;if(!$t.grid){return}if(typeof colname==="string"){colname=[colname]}show=show!="none"?"":"none";var sw=show===""?true:false;$(this.p.colModel).each(function(i){if($.inArray(this.name,colname)!==-1&&this.hidden===sw){$("tr",$t.grid.hDiv).each(function(){$(this).children("th:eq("+i+")").css("display",show)});$($t.rows).each(function(j){$(this).children("td:eq("+i+")").css("display",show)});if($t.p.footerrow){$($t.grid.sDiv).children("td:eq("+i+")").css("display",show)}cw=this.widthOrg?this.widthOrg:parseInt(this.width,10);if(show==="none"){$t.p.tblwidth-=cw+brd}else{$t.p.tblwidth+=cw+brd}this.hidden=!sw;fndh=true}});if(fndh===true){if($t.grid.width!==$t.p.tblwidth){$($t).jqGrid("setGridWidth",$t.p.shrinkToFit===true?$t.grid.width:$t.p.tblwidth,true)}}})},hideCol:function(colname){return this.each(function(){$(this).jqGrid("showHideCol",colname,"none")})},showCol:function(colname){return this.each(function(){$(this).jqGrid("showHideCol",colname,"")})},remapColumns:function(permutation,updateCells,keepHeader){function resortArray(a){var ac;if(a.length){ac=$.makeArray(a)}else{ac=$.extend({},a)}$.each(permutation,function(i){a[i]=ac[this]})}var ts=this.get(0);function resortRows(parent,clobj){$(">tr"+(clobj||""),parent).each(function(){var row=this;var elems=$.makeArray(row.cells);$.each(permutation,function(){var e=elems[this];if(e){row.appendChild(e)}})})}resortArray(ts.p.colModel);resortArray(ts.p.colNames);resortArray(ts.grid.headers);resortRows($("thead:first",ts.grid.hDiv),keepHeader&&":not(.ui-jqgrid-labels)");if(updateCells){resortRows($("#"+$.jgrid.jqID(ts.p.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot")}if(ts.p.footerrow){resortRows($("tbody:first",ts.grid.sDiv))}if(ts.p.remapColumns){if(!ts.p.remapColumns.length){ts.p.remapColumns=$.makeArray(permutation)}else{resortArray(ts.p.remapColumns)}}ts.p.lastsort=$.inArray(ts.p.lastsort,permutation);if(ts.p.treeGrid){ts.p.expColInd=$.inArray(ts.p.expColInd,permutation)}},setGridWidth:function(nwidth,shrink){return this.each(function(){if(!this.grid){return}var $t=this,cw,initwidth=0,brd=$.browser.webkit||$.browser.safari?0:$t.p.cellLayout,lvc,vc=0,hs=false,scw=$t.p.scrollOffset,aw,gw=0,cl=0,cr;if(typeof shrink!="boolean"){shrink=$t.p.shrinkToFit}if(isNaN(nwidth)){return}else{nwidth=parseInt(nwidth,10);$t.grid.width=$t.p.width=nwidth}$("#gbox_"+$.jgrid.jqID($t.p.id)).css("width",nwidth+"px");$("#gview_"+$.jgrid.jqID($t.p.id)).css("width",nwidth+"px");$($t.grid.bDiv).css("width",nwidth+"px");$($t.grid.hDiv).css("width",nwidth+"px");if($t.p.pager){$($t.p.pager).css("width",nwidth+"px")}if($t.p.toppager){$($t.p.toppager).css("width",nwidth+"px")}if($t.p.toolbar[0]===true){$($t.grid.uDiv).css("width",nwidth+"px");if($t.p.toolbar[1]=="both"){$($t.grid.ubDiv).css("width",nwidth+"px")}}if($t.p.footerrow){$($t.grid.sDiv).css("width",nwidth+"px")}if(shrink===false&&$t.p.forceFit===true){$t.p.forceFit=false}if(shrink===true){$.each($t.p.colModel,function(i){if(this.hidden===false){cw=this.widthOrg?this.widthOrg:parseInt(this.width,10);initwidth+=cw+brd;if(this.fixed){gw+=cw+brd}else{vc++}cl++}});if(vc===0){return}$t.p.tblwidth=initwidth;aw=nwidth-brd*vc-gw;if(!isNaN($t.p.height)){if($($t.grid.bDiv)[0].clientHeight<$($t.grid.bDiv)[0].scrollHeight||$t.rows.length===1){hs=true;aw-=scw}}initwidth=0;var cle=$t.grid.cols.length>0;$.each($t.p.colModel,function(i){if(this.hidden===false&&!this.fixed){cw=this.widthOrg?this.widthOrg:parseInt(this.width,10);cw=Math.round(aw*cw/($t.p.tblwidth-brd*vc-gw));if(cw<0){return}this.width=cw;initwidth+=cw;$t.grid.headers[i].width=cw;$t.grid.headers[i].el.style.width=cw+"px";if($t.p.footerrow){$t.grid.footers[i].style.width=cw+"px"}if(cle){$t.grid.cols[i].style.width=cw+"px"}lvc=i}});
cr=0;if(hs){if(nwidth-gw-(initwidth+brd*vc)!==scw){cr=nwidth-gw-(initwidth+brd*vc)-scw}}else{if(Math.abs(nwidth-gw-(initwidth+brd*vc))!==1){cr=nwidth-gw-(initwidth+brd*vc)}}$t.p.colModel[lvc].width+=cr;$t.p.tblwidth=initwidth+cr+brd*vc+gw;if($t.p.tblwidth>nwidth){var delta=$t.p.tblwidth-parseInt(nwidth,10);$t.p.tblwidth=nwidth;cw=$t.p.colModel[lvc].width=$t.p.colModel[lvc].width-delta}else{cw=$t.p.colModel[lvc].width}$t.grid.headers[lvc].width=cw;$t.grid.headers[lvc].el.style.width=cw+"px";if(cle){$t.grid.cols[lvc].style.width=cw+"px"}$("table:first",$t.grid.bDiv).css("width",$t.p.tblwidth+"px");$("table:first",$t.grid.hDiv).css("width",$t.p.tblwidth+"px");$t.grid.hDiv.scrollLeft=$t.grid.bDiv.scrollLeft;if($t.p.footerrow){$t.grid.footers[lvc].style.width=cw+"px";$("table:first",$t.grid.sDiv).css("width",$t.p.tblwidth+"px")}}})},setGridHeight:function(nh){return this.each(function(){var $t=this;if(!$t.grid){return}$($t.grid.bDiv).css({height:nh+(isNaN(nh)?"":"px")});$t.p.height=nh;if($t.p.scroll){$t.grid.populateVisible()}})},setCaption:function(newcap){return this.each(function(){this.p.caption=newcap;$("span.ui-jqgrid-title",this.grid.cDiv).html(newcap);$(this.grid.cDiv).show()})},setLabel:function(colname,nData,prop,attrp){return this.each(function(){var $t=this,pos=-1;if(!$t.grid){return}if(isNaN(colname)){$($t.p.colModel).each(function(i){if(this.name==colname){pos=i;return false}})}else{pos=parseInt(colname,10)}if(pos>=0){var thecol=$("tr.ui-jqgrid-labels th:eq("+pos+")",$t.grid.hDiv);if(nData){var ico=$(".s-ico",thecol);$("[id^=jqgh_]",thecol).empty().html(nData).append(ico);$t.p.colNames[pos]=nData}if(prop){if(typeof prop==="string"){$(thecol).addClass(prop)}else{$(thecol).css(prop)}}if(typeof attrp==="object"){$(thecol).attr(attrp)}}})},setCell:function(rowid,colname,nData,cssp,attrp,forceupd){return this.each(function(){var $t=this,pos=-1,v,title;if(!$t.grid){return}if(isNaN(colname)){$($t.p.colModel).each(function(i){if(this.name==colname){pos=i;return false}})}else{pos=parseInt(colname,10)}if(pos>=0){var ind=$t.rows.namedItem(rowid);if(ind){var tcell=$("td:eq("+pos+")",ind);if(nData!==""||forceupd===true){v=$t.formatter(rowid,nData,pos,ind,"edit");title=$t.p.colModel[pos].title?{title:$.jgrid.stripHtml(v)}:{};if($t.p.treeGrid&&$(".tree-wrap",$(tcell)).length>0){$("span",$(tcell)).html(v).attr(title)}else{$(tcell).html(v).attr(title)}if($t.p.datatype=="local"){var cm=$t.p.colModel[pos],index;nData=cm.formatter&&typeof(cm.formatter)==="string"&&cm.formatter=="date"?$.unformat.date(nData,cm):nData;index=$t.p._index[rowid];if(typeof index!="undefined"){$t.p.data[index][cm.name]=nData}}}if(typeof cssp==="string"){$(tcell).addClass(cssp)}else{if(cssp){$(tcell).css(cssp)}}if(typeof attrp==="object"){$(tcell).attr(attrp)}}}})},getCell:function(rowid,col){var ret=false;this.each(function(){var $t=this,pos=-1;if(!$t.grid){return}if(isNaN(col)){$($t.p.colModel).each(function(i){if(this.name===col){pos=i;return false}})}else{pos=parseInt(col,10)}if(pos>=0){var ind=$t.rows.namedItem(rowid);if(ind){try{ret=$.unformat($("td:eq("+pos+")",ind),{rowId:ind.id,colModel:$t.p.colModel[pos]},pos)}catch(e){ret=$.jgrid.htmlDecode($("td:eq("+pos+")",ind).html())}}}});return ret},getCol:function(col,obj,mathopr){var ret=[],val,sum=0,min=0,max=0,v;obj=typeof(obj)!="boolean"?false:obj;if(typeof mathopr=="undefined"){mathopr=false}this.each(function(){var $t=this,pos=-1;if(!$t.grid){return}if(isNaN(col)){$($t.p.colModel).each(function(i){if(this.name===col){pos=i;return false}})}else{pos=parseInt(col,10)}if(pos>=0){var ln=$t.rows.length,i=0;if(ln&&ln>0){while(i<ln){if($($t.rows[i]).hasClass("jqgrow")){try{val=$.unformat($($t.rows[i].cells[pos]),{rowId:$t.rows[i].id,colModel:$t.p.colModel[pos]},pos)}catch(e){val=$.jgrid.htmlDecode($t.rows[i].cells[pos].innerHTML)}if(mathopr){v=parseFloat(val);sum+=v;min=Math.min(min,v);max=Math.max(min,v)}else{if(obj){ret.push({id:$t.rows[i].id,value:val})}else{ret.push(val)}}}i++}if(mathopr){switch(mathopr.toLowerCase()){case"sum":ret=sum;break;case"avg":ret=sum/ln;break;case"count":ret=ln;break;case"min":ret=min;break;case"max":ret=max;break}}}}});return ret},clearGridData:function(clearfooter){return this.each(function(){var $t=this;if(!$t.grid){return}if(typeof clearfooter!="boolean"){clearfooter=false}if($t.p.deepempty){$("#"+$.jgrid.jqID($t.p.id)+" tbody:first tr:gt(0)").remove()}else{var trf=$("#"+$.jgrid.jqID($t.p.id)+" tbody:first tr:first")[0];$("#"+$.jgrid.jqID($t.p.id)+" tbody:first").empty().append(trf)}if($t.p.footerrow&&clearfooter){$(".ui-jqgrid-ftable td",$t.grid.sDiv).html("&#160;")}$t.p.selrow=null;$t.p.selarrrow=[];$t.p.savedRow=[];$t.p.records=0;$t.p.page=1;$t.p.lastpage=0;$t.p.reccount=0;$t.p.data=[];$t.p_index={};$t.updatepager(true,false)})},getInd:function(rowid,rc){var ret=false,rw;this.each(function(){rw=this.rows.namedItem(rowid);if(rw){ret=rc===true?rw:rw.rowIndex}});return ret},bindKeys:function(settings){var o=$.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:true},settings||{});return this.each(function(){var $t=this;if(!$("body").is("[role]")){$("body").attr("role","application")}$t.p.scrollrows=o.scrollingRows;$($t).keydown(function(event){var target=$($t).find("tr[tabindex=0]")[0],id,r,mind,expanded=$t.p.treeReader.expanded_field;if(target){mind=$t.p._index[target.id];if(event.keyCode===37||event.keyCode===38||event.keyCode===39||event.keyCode===40){if(event.keyCode===38){r=target.previousSibling;id="";if(r){if($(r).is(":hidden")){while(r){r=r.previousSibling;if(!$(r).is(":hidden")&&$(r).hasClass("jqgrow")){id=r.id;break}}}else{id=r.id}}$($t).jqGrid("setSelection",id)}if(event.keyCode===40){r=target.nextSibling;id="";if(r){if($(r).is(":hidden")){while(r){r=r.nextSibling;if(!$(r).is(":hidden")&&$(r).hasClass("jqgrow")){id=r.id;break}}}else{id=r.id}}$($t).jqGrid("setSelection",id)}if(event.keyCode===37){if($t.p.treeGrid&&$t.p.data[mind][expanded]){$(target).find("div.treeclick").trigger("click")}if($.isFunction(o.onLeftKey)){o.onLeftKey.call($t,$t.p.selrow)}}if(event.keyCode===39){if($t.p.treeGrid&&!$t.p.data[mind][expanded]){$(target).find("div.treeclick").trigger("click")}if($.isFunction(o.onRightKey)){o.onRightKey.call($t,$t.p.selrow)}}return false}else{if(event.keyCode===13){if($.isFunction(o.onEnter)){o.onEnter.call($t,$t.p.selrow)}return false}else{if(event.keyCode===32){if($.isFunction(o.onSpace)){o.onSpace.call($t,$t.p.selrow)}return false}}}}})})},unbindKeys:function(){return this.each(function(){var $t=this;$($t).unbind("keydown")})},getLocalRow:function(rowid){var ret=false,ind;this.each(function(){if(typeof(rowid)!=="undefined"){ind=this.p._index[rowid];if(ind>=0){ret=this.p.data[ind]}}});return ret}})})(jQuery);(function(b){b.jgrid.extend({getColProp:function(j){var a={},g=this[0];if(!g.grid){return false}var h=g.p.colModel;for(var k=0;k<h.length;k++){if(h[k].name==j){a=h[k];break}}return a},setColProp:function(d,a){return this.each(function(){if(this.grid){if(a){var c=this.p.colModel;for(var f=0;f<c.length;f++){if(c[f].name==d){b.extend(this.p.colModel[f],a);break}}}}})},sortGrid:function(f,a,e){return this.each(function(){var c=this,k=-1;if(!c.grid){return}if(!f){f=c.p.sortname}for(var d=0;d<c.p.colModel.length;d++){if(c.p.colModel[d].index==f||c.p.colModel[d].name==f){k=d;break}}if(k!=-1){var j=c.p.colModel[k].sortable;if(typeof j!=="boolean"){j=true}if(typeof a!=="boolean"){a=false}if(j){c.sortData("jqgh_"+f,k,a,e)}}})},GridDestroy:function(){return this.each(function(){if(this.grid){if(this.p.pager){b(this.p.pager).remove()
}var d=this.id;try{b("#gbox_"+d).remove()}catch(a){}}})},GridUnload:function(){return this.each(function(){if(!this.grid){return}var e={id:b(this).attr("id"),cl:b(this).attr("class")};if(this.p.pager){b(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom")}var a=document.createElement("table");b(a).attr({id:e.id});a.className=e.cl;var f=this.id;b(a).removeClass("ui-jqgrid-btable");if(b(this.p.pager).parents("#gbox_"+f).length===1){b(a).insertBefore("#gbox_"+f).show();b(this.p.pager).insertBefore("#gbox_"+f)}else{b(a).insertBefore("#gbox_"+f).show()}b("#gbox_"+f).remove()})},setGridState:function(a){return this.each(function(){if(!this.grid){return}var d=this;if(a=="hidden"){b(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+d.p.id).slideUp("fast");if(d.p.pager){b(d.p.pager).slideUp("fast")}if(d.p.toppager){b(d.p.toppager).slideUp("fast")}if(d.p.toolbar[0]===true){if(d.p.toolbar[1]=="both"){b(d.grid.ubDiv).slideUp("fast")}b(d.grid.uDiv).slideUp("fast")}if(d.p.footerrow){b(".ui-jqgrid-sdiv","#gbox_"+d.p.id).slideUp("fast")}b(".ui-jqgrid-titlebar-close span",d.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");d.p.gridstate="hidden"}else{if(a=="visible"){b(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+d.p.id).slideDown("fast");if(d.p.pager){b(d.p.pager).slideDown("fast")}if(d.p.toppager){b(d.p.toppager).slideDown("fast")}if(d.p.toolbar[0]===true){if(d.p.toolbar[1]=="both"){b(d.grid.ubDiv).slideDown("fast")}b(d.grid.uDiv).slideDown("fast")}if(d.p.footerrow){b(".ui-jqgrid-sdiv","#gbox_"+d.p.id).slideDown("fast")}b(".ui-jqgrid-titlebar-close span",d.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");d.p.gridstate="visible"}}})},filterToolbar:function(a){a=b.extend({autosearch:true,searchOnEnter:true,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:false,groupOp:"AND",defaultSearch:"bw"},a||{});return this.each(function(){var k=this;if(this.ftoolbar){return}var q=function(){var f={},g=0,x,w,v={},j;b.each(k.p.colModel,function(t,u){w=this.index||this.name;switch(this.stype){case"select":j=(this.searchoptions&&this.searchoptions.sopt)?this.searchoptions.sopt[0]:"eq";x=b("#gs_"+b.jgrid.jqID(w),k.grid.hDiv).val();if(x){f[w]=x;v[w]=j;g++}else{try{delete k.p.postData[w]}catch(s){}}break;case"text":j=(this.searchoptions&&this.searchoptions.sopt)?this.searchoptions.sopt[0]:a.defaultSearch;x=b("#gs_"+b.jgrid.jqID(w),k.grid.hDiv).val();if(x){f[w]=x;v[w]=j;g++}else{try{delete k.p.postData[w]}catch(r){}}break}});var c=g>0?true:false;if(a.stringResult===true||k.p.datatype=="local"){var y='{"groupOp":"'+a.groupOp+'","rules":[';var d=0;b.each(f,function(s,r){if(d>0){y+=","}y+='{"field":"'+s+'",';y+='"op":"'+v[s]+'",';r+="";y+='"data":"'+r.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';d++});y+="]}";b.extend(k.p.postData,{filters:y});b.each(["searchField","searchString","searchOper"],function(s,r){if(k.p.postData.hasOwnProperty(r)){delete k.p.postData[r]}})}else{b.extend(k.p.postData,f)}var e;if(k.p.searchurl){e=k.p.url;b(k).jqGrid("setGridParam",{url:k.p.searchurl})}var h=false;if(b.isFunction(a.beforeSearch)){h=a.beforeSearch.call(k)}if(!h){b(k).jqGrid("setGridParam",{search:c}).trigger("reloadGrid",[{page:1}])}if(e){b(k).jqGrid("setGridParam",{url:e})}if(b.isFunction(a.afterSearch)){a.afterSearch()}};var m=function(u){var h={},w,j=0,v;u=(typeof u!="boolean")?true:u;b.each(k.p.colModel,function(y,A){w=(this.searchoptions&&this.searchoptions.defaultValue)?this.searchoptions.defaultValue:"";v=this.index||this.name;switch(this.stype){case"select":var r;b("#gs_"+b.jgrid.jqID(v)+" option",k.grid.hDiv).each(function(x){if(x===0){this.selected=true}if(b(this).text()==w){this.selected=true;r=b(this).val();return false}});if(r){h[v]=r;j++}else{try{delete k.p.postData[v]}catch(t){}}break;case"text":b("#gs_"+b.jgrid.jqID(v),k.grid.hDiv).val(w);if(w){h[v]=w;j++}else{try{delete k.p.postData[v]}catch(s){}}break}});var e=j>0?true:false;if(a.stringResult===true||k.p.datatype=="local"){var d='{"groupOp":"'+a.groupOp+'","rules":[';var f=0;b.each(h,function(s,r){if(f>0){d+=","}d+='{"field":"'+s+'",';d+='"op":"eq",';r+="";d+='"data":"'+r.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';f++});d+="]}";b.extend(k.p.postData,{filters:d});b.each(["searchField","searchString","searchOper"],function(s,r){if(k.p.postData.hasOwnProperty(r)){delete k.p.postData[r]}})}else{b.extend(k.p.postData,h)}var g;if(k.p.searchurl){g=k.p.url;b(k).jqGrid("setGridParam",{url:k.p.searchurl})}var c=false;if(b.isFunction(a.beforeClear)){c=a.beforeClear.call(k)}if(!c){if(u){b(k).jqGrid("setGridParam",{search:e}).trigger("reloadGrid",[{page:1}])}}if(g){b(k).jqGrid("setGridParam",{url:g})}if(b.isFunction(a.afterClear)){a.afterClear()}};var o=function(){var c=b("tr.ui-search-toolbar",k.grid.hDiv);if(c.css("display")=="none"){c.show()}else{c.hide()}};function l(e,c){var d=b(e);if(d[0]){jQuery.each(c,function(){if(this.data!==undefined){d.bind(this.type,this.data,this.fn)}else{d.bind(this.type,this.fn)}})}}var n=b("<tr class='ui-search-toolbar' role='rowheader'></tr>");var p;b.each(k.p.colModel,function(H,d){var E=this,G,h,J,C,f;h=b("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+k.p.direction+"'></th>");G=b("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>");if(this.hidden===true){b(h).css("display","none")}this.search=this.search===false?false:true;if(typeof this.stype=="undefined"){this.stype="text"}J=b.extend({},this.searchoptions||{});if(this.search){switch(this.stype){case"select":C=this.surl||J.dataUrl;if(C){f=G;b.ajax(b.extend({url:C,dataType:"html",complete:function(t,r){if(J.buildSelect!==undefined){var s=J.buildSelect(t);if(s){b(f).append(s)}}else{b(f).append(t.responseText)}if(J.defaultValue){b("select",f).val(J.defaultValue)}b("select",f).attr({name:E.index||E.name,id:"gs_"+E.name});if(J.attr){b("select",f).attr(J.attr)}b("select",f).css({width:"100%"});if(J.dataInit!==undefined){J.dataInit(b("select",f)[0])}if(J.dataEvents!==undefined){l(b("select",f)[0],J.dataEvents)}if(a.autosearch===true){b("select",f).change(function(u){q();return false})}t=null}},b.jgrid.ajaxOptions,k.p.ajaxSelectOptions||{}))}else{var j;if(E.searchoptions&&E.searchoptions.value){j=E.searchoptions.value}else{if(E.editoptions&&E.editoptions.value){j=E.editoptions.value}}if(j){var K=document.createElement("select");K.style.width="100%";b(K).attr({name:E.index||E.name,id:"gs_"+E.name});var e,g,c;if(typeof j==="string"){e=j.split(";");for(var I=0;I<e.length;I++){g=e[I].split(":");c=document.createElement("option");c.value=g[0];c.innerHTML=g[1];K.appendChild(c)}}else{if(typeof j==="object"){for(var D in j){if(j.hasOwnProperty(D)){c=document.createElement("option");c.value=D;c.innerHTML=j[D];K.appendChild(c)}}}}if(J.defaultValue){b(K).val(J.defaultValue)}if(J.attr){b(K).attr(J.attr)}if(J.dataInit!==undefined){J.dataInit(K)}if(J.dataEvents!==undefined){l(K,J.dataEvents)}b(G).append(K);if(a.autosearch===true){b(K).change(function(r){q();return false})}}}break;case"text":var F=J.defaultValue?J.defaultValue:"";b(G).append("<input type='text' style='width:95%;padding:0px;' name='"+(E.index||E.name)+"' id='gs_"+E.name+"' value='"+F+"'/>");if(J.attr){b("input",G).attr(J.attr)}if(J.dataInit!==undefined){J.dataInit(b("input",G)[0])}if(J.dataEvents!==undefined){l(b("input",G)[0],J.dataEvents)}if(a.autosearch===true){if(a.searchOnEnter){b("input",G).keypress(function(s){var r=s.charCode?s.charCode:s.keyCode?s.keyCode:0;
if(r==13){q();return false}return this})}else{b("input",G).keydown(function(s){var r=s.which;switch(r){case 13:return false;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:if(p){clearTimeout(p)}p=setTimeout(function(){q()},500)}})}}break}}b(h).append(G);b(n).append(h)});b("table thead",k.grid.hDiv).append(n);this.ftoolbar=true;this.triggerToolbar=q;this.clearToolbar=m;this.toggleToolbar=o})}})})(jQuery);(function(t){t.fn.jqm=function(a){var b={overlay:50,closeoverlay:true,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:f,ajaxText:"",target:f,modal:f,toTop:f,onShow:f,onHide:f,onLoad:f};return this.each(function(){if(this._jqm){return m[this._jqm].c=t.extend({},m[this._jqm].c,a)}e++;this._jqm=e;m[e]={c:t.extend(b,t.jqm.params,a),a:f,w:t(this).addClass("jqmID"+e),s:e};if(b.trigger){t(this).jqmAddTrigger(b.trigger)}})};t.fn.jqmAddClose=function(a){return p(this,a,"jqmHide")};t.fn.jqmAddTrigger=function(a){return p(this,a,"jqmShow")};t.fn.jqmShow=function(a){return this.each(function(){t.jqm.open(this._jqm,a)})};t.fn.jqmHide=function(a){return this.each(function(){t.jqm.close(this._jqm,a)})};t.jqm={hash:{},open:function(b,d){var c=m[b],a=c.c,g="."+a.closeClass,n=(parseInt(c.w.css("z-index")));n=(n>0)?n:3000;var h=t("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":n-1,opacity:a.overlay/100});if(c.a){return f}c.t=d;c.a=true;c.w.css("z-index",n);if(a.modal){if(!w[0]){setTimeout(function(){q("bind")},1)}w.push(b)}else{if(a.overlay>0){if(a.closeoverlay){c.w.jqmAddClose(h)}}else{h=f}}c.o=(h)?h.addClass(a.overlayClass).prependTo("body"):f;if(u){t("html,body").css({height:"100%",width:"100%"});if(h){h=h.css({position:"absolute"})[0];for(var l in {Top:1,Left:1}){h.style.setExpression(l.toLowerCase(),"(_=(document.documentElement.scroll"+l+" || document.body.scroll"+l+"))+'px'")}}}if(a.ajax){var j=a.target||c.w,k=a.ajax;j=(typeof j=="string")?t(j,c.w):t(j);k=(k.substr(0,1)=="@")?t(d).attr(k.substring(1)):k;j.html(a.ajaxText).load(k,function(){if(a.onLoad){a.onLoad.call(this,c)}if(g){c.w.jqmAddClose(t(g,c.w))}r(c)})}else{if(g){c.w.jqmAddClose(t(g,c.w))}}if(a.toTop&&c.o){c.w.before('<span id="jqmP'+c.w[0]._jqm+'"></span>').insertAfter(c.o)}(a.onShow)?a.onShow(c):c.w.show();r(c);return f},close:function(a){var b=m[a];if(!b.a){return f}b.a=f;if(w[0]){w.pop();if(!w[0]){q("unbind")}}if(b.c.toTop&&b.o){t("#jqmP"+b.w[0]._jqm).after(b.w).remove()}if(b.c.onHide){b.c.onHide(b)}else{b.w.hide();if(b.o){b.o.remove()}}return f},params:{}};var e=0,m=t.jqm.hash,w=[],u=t.browser.msie&&(t.browser.version=="6.0"),f=false,r=function(a){var b=t('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0});if(u){if(a.o){a.o.html('<p style="width:100%;height:100%"/>').prepend(b)}else{if(!t("iframe.jqm",a.w)[0]){a.w.prepend(b)}}}s(a)},s=function(a){try{t(":input:visible",a.w)[0].focus()}catch(b){}},q=function(a){t(document)[a]("keypress",v)[a]("keydown",v)[a]("mousedown",v)},v=function(c){var b=m[w[w.length-1]],a=(!t(c.target).parents(".jqmID"+b.s)[0]);if(a){s(b)}return !a},p=function(c,b,a){return c.each(function(){var d=this._jqm;t(b).each(function(){if(!this[a]){this[a]=[];t(this).click(function(){for(var h in {jqmShow:1,jqmHide:1}){for(var g in this[h]){if(m[this[h][g]]){m[this[h][g]].w[h](this)}}}return f})}this[a].push(d)})})}})(jQuery);(function(l){l.fn.jqDrag=function(a){return o(this,a,"d")};l.fn.jqResize=function(a,b){return o(this,a,"r",b)};l.jqDnR={dnr:{},e:0,drag:function(a){if(k.k=="d"){m.css({left:k.X+a.pageX-k.pX,top:k.Y+a.pageY-k.pY})}else{m.css({width:Math.max(a.pageX-k.pX+k.W,0),height:Math.max(a.pageY-k.pY+k.H,0)});if(M1){j.css({width:Math.max(a.pageX-M1.pX+M1.W,0),height:Math.max(a.pageY-M1.pY+M1.H,0)})}}return false},stop:function(){l(document).unbind("mousemove",f.drag).unbind("mouseup",f.stop)}};var f=l.jqDnR,k=f.dnr,m=f.e,j,o=function(a,b,c,d){return a.each(function(){b=(b)?l(b,a):a;b.bind("mousedown",{e:a,k:c},function(e){var g=e.data,h={};m=g.e;j=d?l(d):false;if(m.css("position")!="relative"){try{m.position(h)}catch(p){}}k={X:h.left||n("left")||0,Y:h.top||n("top")||0,W:n("width")||m[0].scrollWidth||0,H:n("height")||m[0].scrollHeight||0,pX:e.pageX,pY:e.pageY,k:g.k};if(j&&g.k!="d"){M1={X:h.left||f1("left")||0,Y:h.top||f1("top")||0,W:j[0].offsetWidth||f1("width")||0,H:j[0].offsetHeight||f1("height")||0,pX:e.pageX,pY:e.pageY,k:g.k}}else{M1=false}if(l("input.hasDatepicker",m[0])[0]){try{l("input.hasDatepicker",m[0]).datepicker("hide")}catch(s){}}l(document).mousemove(l.jqDnR.drag).mouseup(l.jqDnR.stop);return false})})},n=function(a){return parseInt(m.css(a))||false};f1=function(a){return parseInt(j.css(a))||false}})(jQuery);var xmlJsonClass={xml2json:function(f,j){if(f.nodeType===9){f=f.documentElement}var g=this.removeWhite(f);var h=this.toObj(g);var k=this.toJson(h,f.nodeName,"\t");return"{\n"+j+(j?k.replace(/\t/g,j):k.replace(/\t|\n/g,""))+"\n}"},json2xml:function(j,k){var h=function(a,s,n){var c="";var d,r;if(a instanceof Array){if(a.length===0){c+=n+"<"+s+">__EMPTY_ARRAY_</"+s+">\n"}else{for(d=0,r=a.length;d<r;d+=1){var b=n+h(a[d],s,n+"\t")+"\n";c+=b}}}else{if(typeof(a)==="object"){var e=false;c+=n+"<"+s;var m;for(m in a){if(a.hasOwnProperty(m)){if(m.charAt(0)==="@"){c+=" "+m.substr(1)+'="'+a[m].toString()+'"'}else{e=true}}}c+=e?">":"/>";if(e){for(m in a){if(a.hasOwnProperty(m)){if(m==="#text"){c+=a[m]}else{if(m==="#cdata"){c+="<![CDATA["+a[m]+"]]>"}else{if(m.charAt(0)!=="@"){c+=h(a[m],m,n+"\t")}}}}}c+=(c.charAt(c.length-1)==="\n"?n:"")+"</"+s+">"}}else{if(typeof(a)==="function"){c+=n+"<"+s+"><![CDATA["+a+"]]></"+s+">"}else{if(a.toString()==='""'||a.toString().length===0){c+=n+"<"+s+">__EMPTY_STRING_</"+s+">"}else{c+=n+"<"+s+">"+a.toString()+"</"+s+">"}}}}return c};var f="";var g;for(g in j){if(j.hasOwnProperty(g)){f+=h(j[g],g,"")}}return k?f.replace(/\t/g,k):f.replace(/\t|\n/g,"")},toObj:function(j){var m={};var n=/function/i;if(j.nodeType===1){if(j.attributes.length){var o;for(o=0;o<j.attributes.length;o+=1){m["@"+j.attributes[o].nodeName]=(j.attributes[o].nodeValue||"").toString()}}if(j.firstChild){var k=0,p=0,q=false;var l;for(l=j.firstChild;l;l=l.nextSibling){if(l.nodeType===1){q=true}else{if(l.nodeType===3&&l.nodeValue.match(/[^ \f\n\r\t\v]/)){k+=1}else{if(l.nodeType===4){p+=1}}}}if(q){if(k<2&&p<2){this.removeWhite(j);for(l=j.firstChild;l;l=l.nextSibling){if(l.nodeType===3){m["#text"]=this.escape(l.nodeValue)}else{if(l.nodeType===4){if(n.test(l.nodeValue)){m[l.nodeName]=[m[l.nodeName],l.nodeValue]}else{m["#cdata"]=this.escape(l.nodeValue)}}else{if(m[l.nodeName]){if(m[l.nodeName] instanceof Array){m[l.nodeName][m[l.nodeName].length]=this.toObj(l)}else{m[l.nodeName]=[m[l.nodeName],this.toObj(l)]}}else{m[l.nodeName]=this.toObj(l)}}}}}else{if(!j.attributes.length){m=this.escape(this.innerXml(j))}else{m["#text"]=this.escape(this.innerXml(j))}}}else{if(k){if(!j.attributes.length){m=this.escape(this.innerXml(j));if(m==="__EMPTY_ARRAY_"){m="[]"}else{if(m==="__EMPTY_STRING_"){m=""}}}else{m["#text"]=this.escape(this.innerXml(j))}}else{if(p){if(p>1){m=this.escape(this.innerXml(j))}else{for(l=j.firstChild;l;l=l.nextSibling){if(n.test(j.firstChild.nodeValue)){m=j.firstChild.nodeValue;break}else{m["#cdata"]=this.escape(l.nodeValue)}}}}}}}if(!j.attributes.length&&!j.firstChild){m=null}}else{if(j.nodeType===9){m=this.toObj(j.documentElement)}else{alert("unhandled node type: "+j.nodeType)}}return m},toJson:function(x,y,v,u){if(u===undefined){u=true}var m=y?('"'+y+'"'):"",t="\t",s="\n";
if(!u){t="";s=""}if(x==="[]"){m+=(y?":[]":"[]")}else{if(x instanceof Array){var w,o,q=[];for(o=0,w=x.length;o<w;o+=1){q[o]=this.toJson(x[o],"",v+t,u)}m+=(y?":[":"[")+(q.length>1?(s+v+t+q.join(","+s+v+t)+s+v):q.join(""))+"]"}else{if(x===null){m+=(y&&":")+"null"}else{if(typeof(x)==="object"){var n=[],r;for(r in x){if(x.hasOwnProperty(r)){n[n.length]=this.toJson(x[r],r,v+t,u)}}m+=(y?":{":"{")+(n.length>1?(s+v+t+n.join(","+s+v+t)+s+v):n.join(""))+"}"}else{if(typeof(x)==="string"){m+=(y&&":")+'"'+x.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"'}else{m+=(y&&":")+'"'+x.toString()+'"'}}}}}return m},innerXml:function(h){var c="";if("innerHTML" in h){c=h.innerHTML}else{var f=function(a){var d="",e;if(a.nodeType===1){d+="<"+a.nodeName;for(e=0;e<a.attributes.length;e+=1){d+=" "+a.attributes[e].nodeName+'="'+(a.attributes[e].nodeValue||"").toString()+'"'}if(a.firstChild){d+=">";for(var b=a.firstChild;b;b=b.nextSibling){d+=f(b)}d+="</"+a.nodeName+">"}else{d+="/>"}}else{if(a.nodeType===3){d+=a.nodeValue}else{if(a.nodeType===4){d+="<![CDATA["+a.nodeValue+"]]>"}}}return d};for(var g=h.firstChild;g;g=g.nextSibling){c+=f(g)}}return c},escape:function(b){return b.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(d){d.normalize();var f;for(f=d.firstChild;f;){if(f.nodeType===3){if(!f.nodeValue.match(/[^ \f\n\r\t\v]/)){var e=f.nextSibling;d.removeChild(f);f=e}else{f=f.nextSibling}}else{if(f.nodeType===1){this.removeWhite(f);f=f.nextSibling}else{f=f.nextSibling}}}return d}};(function(b){b.fmatter={};b.extend(b.fmatter,{isBoolean:function(a){return typeof a==="boolean"},isObject:function(a){return(a&&(typeof a==="object"||b.isFunction(a)))||false},isString:function(a){return typeof a==="string"},isNumber:function(a){return typeof a==="number"&&isFinite(a)},isNull:function(a){return a===null},isUndefined:function(a){return typeof a==="undefined"},isValue:function(a){return(this.isObject(a)||this.isString(a)||this.isNumber(a)||this.isBoolean(a))},isEmpty:function(a){if(!this.isString(a)&&this.isValue(a)){return false}else{if(!this.isValue(a)){return true}}a=b.trim(a).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return a===""}});b.fn.fmatter=function(j,h,k,a,m){var l=h;k=b.extend({},b.jgrid.formatter,k);if(b.fn.fmatter[j]){l=b.fn.fmatter[j](h,k,a,m)}return l};b.fmatter.util={NumberFormat:function(w,y){if(!b.fmatter.isNumber(w)){w*=1}if(b.fmatter.isNumber(w)){var u=(w<0);var p=w+"";var s=(y.decimalSeparator)?y.decimalSeparator:".";var r;if(b.fmatter.isNumber(y.decimalPlaces)){var q=y.decimalPlaces;var v=Math.pow(10,q);p=Math.round(w*v)/v+"";r=p.lastIndexOf(".");if(q>0){if(r<0){p+=s;r=p.length-1}else{if(s!=="."){p=p.replace(".",s)}}while((p.length-1-r)<q){p+="0"}}}if(y.thousandsSeparator){var a=y.thousandsSeparator;r=p.lastIndexOf(s);r=(r>-1)?r:p.length;var o=p.substring(r);var x=-1;for(var t=r;t>0;t--){x++;if((x%3===0)&&(t!==r)&&(!u||(t>1))){o=a+o}o=p.charAt(t-1)+o}p=o}p=(y.prefix)?y.prefix+p:p;p=(y.suffix)?p+y.suffix:p;return p}else{return w}},DateFormat:function(s,k,a,u){var aa=/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,T=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,Z=new RegExp("^/Date\\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\\)/$"),ae=((typeof k==="string")?k.match(Z):null),o=function(c,d){c=String(c);d=parseInt(d,10)||2;while(c.length<d){c="0"+c}return c},ai={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},af=0,V,Q,ag,S=["i18n"];S.i18n={dayNames:u.dayNames,monthNames:u.monthNames};if(s in u.masks){s=u.masks[s]}if(k.constructor===Number){if(String(s).toLowerCase()=="u"){k=k*1000}af=new Date(k)}else{if(k.constructor===Date){af=k}else{if(ae!==null){af=new Date(parseInt(ae[1],10));if(ae[3]){var ad=Number(ae[5])*60+Number(ae[6]);ad*=((ae[4]=="-")?1:-1);ad-=af.getTimezoneOffset();af.setTime(Number(Number(af)+(ad*60*1000)))}}else{k=String(k).split(/[\\\/:_;.,\t\T\s-]/);s=s.split(/[\\\/:_;.,\t\T\s-]/);for(Q=0,ag=s.length;Q<ag;Q++){if(s[Q]=="M"){V=b.inArray(k[Q],S.i18n.monthNames);if(V!==-1&&V<12){k[Q]=V+1}}if(s[Q]=="F"){V=b.inArray(k[Q],S.i18n.monthNames);if(V!==-1&&V>11){k[Q]=V+1-12}}if(k[Q]){ai[s[Q].toLowerCase()]=parseInt(k[Q],10)}}if(ai.f){ai.m=ai.f}if(ai.m===0&&ai.y===0&&ai.d===0){return"&#160;"}ai.m=parseInt(ai.m,10)-1;var j=ai.y;if(j>=70&&j<=99){ai.y=1900+ai.y}else{if(j>=0&&j<=69){ai.y=2000+ai.y}}af=new Date(ai.y,ai.m,ai.d,ai.h,ai.i,ai.s,ai.u)}}}if(a in u.masks){a=u.masks[a]}else{if(!a){a="Y-m-d"}}var N=af.getHours(),z=af.getMinutes(),G=af.getDate(),U=af.getMonth()+1,X=af.getTimezoneOffset(),Y=af.getSeconds(),w=af.getMilliseconds(),R=af.getDay(),ah=af.getFullYear(),ab=(R+6)%7+1,W=(new Date(ah,U-1,G)-new Date(ah,0,1))/86400000,ac={d:o(G),D:S.i18n.dayNames[R],j:G,l:S.i18n.dayNames[R+7],N:ab,S:u.S(G),w:R,z:W,W:ab<5?Math.floor((W+ab-1)/7)+1:Math.floor((W+ab-1)/7)||((new Date(ah-1,0,1).getDay()+6)%7<4?53:52),F:S.i18n.monthNames[U-1+12],m:o(U),M:S.i18n.monthNames[U-1],n:U,t:"?",L:"?",o:"?",Y:ah,y:String(ah).substring(2),a:N<12?u.AmPm[0]:u.AmPm[1],A:N<12?u.AmPm[2]:u.AmPm[3],B:"?",g:N%12||12,G:N,h:o(N%12||12),H:o(N),i:o(z),s:o(Y),u:w,e:"?",I:"?",O:(X>0?"-":"+")+o(Math.floor(Math.abs(X)/60)*100+Math.abs(X)%60,4),P:"?",T:(String(af).match(T)||[""]).pop().replace(n,""),Z:"?",c:"?",r:"?",U:Math.floor(af/1000)};return a.replace(aa,function(c){return c in ac?ac[c]:c.substring(1)})}};b.fn.fmatter.defaultFormat=function(d,a){return(b.fmatter.isValue(d)&&d!=="")?d:a.defaultValue?a.defaultValue:"&#160;"};b.fn.fmatter.email=function(d,a){if(!b.fmatter.isEmpty(d)){return'<a href="mailto:'+d+'">'+d+"</a>"}else{return b.fn.fmatter.defaultFormat(d,a)}};b.fn.fmatter.checkbox=function(h,k){var g=b.extend({},k.checkbox),j;if(!b.fmatter.isUndefined(k.colModel.formatoptions)){g=b.extend({},g,k.colModel.formatoptions)}if(g.disabled===true){j='disabled="disabled"'}else{j=""}if(b.fmatter.isEmpty(h)||b.fmatter.isUndefined(h)){h=b.fn.fmatter.defaultFormat(h,g)}h=h+"";h=h.toLowerCase();var a=h.search(/(false|0|no|off)/i)<0?" checked='checked' ":"";return'<input type="checkbox" '+a+' value="'+h+'" offval="no" '+j+"/>"};b.fn.fmatter.link=function(g,a){var f={target:a.target};var h="";if(!b.fmatter.isUndefined(a.colModel.formatoptions)){f=b.extend({},f,a.colModel.formatoptions)}if(f.target){h="target="+f.target}if(!b.fmatter.isEmpty(g)){return"<a "+h+' href="'+g+'">'+g+"</a>"}else{return b.fn.fmatter.defaultFormat(g,a)}};b.fn.fmatter.showlink=function(j,a){var g={baseLinkUrl:a.baseLinkUrl,showAction:a.showAction,addParam:a.addParam||"",target:a.target,idName:a.idName},k="",h;if(!b.fmatter.isUndefined(a.colModel.formatoptions)){g=b.extend({},g,a.colModel.formatoptions)}if(g.target){k="target="+g.target}h=g.baseLinkUrl+g.showAction+"?"+g.idName+"="+a.rowId+g.addParam;if(b.fmatter.isString(j)||b.fmatter.isNumber(j)){return"<a "+k+' href="'+h+'">'+j+"</a>"}else{return b.fn.fmatter.defaultFormat(j,a)}};b.fn.fmatter.integer=function(f,a){var e=b.extend({},a.integer);if(!b.fmatter.isUndefined(a.colModel.formatoptions)){e=b.extend({},e,a.colModel.formatoptions)}if(b.fmatter.isEmpty(f)){return e.defaultValue}return b.fmatter.util.NumberFormat(f,e)};b.fn.fmatter.number=function(f,a){var e=b.extend({},a.number);if(!b.fmatter.isUndefined(a.colModel.formatoptions)){e=b.extend({},e,a.colModel.formatoptions)}if(b.fmatter.isEmpty(f)){return e.defaultValue}return b.fmatter.util.NumberFormat(f,e)};b.fn.fmatter.currency=function(f,a){var e=b.extend({},a.currency);if(!b.fmatter.isUndefined(a.colModel.formatoptions)){e=b.extend({},e,a.colModel.formatoptions)
}if(b.fmatter.isEmpty(f)){return e.defaultValue}return b.fmatter.util.NumberFormat(f,e)};b.fn.fmatter.date=function(h,j,a,k){var g=b.extend({},j.date);if(!b.fmatter.isUndefined(j.colModel.formatoptions)){g=b.extend({},g,j.colModel.formatoptions)}if(!g.reformatAfterEdit&&k=="edit"){return b.fn.fmatter.defaultFormat(h,j)}else{if(!b.fmatter.isEmpty(h)){return b.fmatter.util.DateFormat(g.srcformat,h,g.newformat,g)}else{return b.fn.fmatter.defaultFormat(h,j)}}};b.fn.fmatter.select=function(t,y,x,q){t=t+"";var v=false,r=[];if(!b.fmatter.isUndefined(y.colModel.formatoptions)){v=y.colModel.formatoptions.value}else{if(!b.fmatter.isUndefined(y.colModel.editoptions)){v=y.colModel.editoptions.value}}if(v){var a=y.colModel.editoptions.multiple===true?true:false,j=[],p;if(a){j=t.split(",");j=b.map(j,function(c){return b.trim(c)})}if(b.fmatter.isString(v)){var w=v.split(";"),u=0;for(var s=0;s<w.length;s++){p=w[s].split(":");if(p.length>2){p[1]=jQuery.map(p,function(d,c){if(c>0){return d}}).join(":")}if(a){if(jQuery.inArray(p[0],j)>-1){r[u]=p[1];u++}}else{if(b.trim(p[0])==b.trim(t)){r[0]=p[1];break}}}}else{if(b.fmatter.isObject(v)){if(a){r=jQuery.map(j,function(d,c){return v[d]})}else{r[0]=v[t]||""}}}}t=r.join(", ");return t===""?b.fn.fmatter.defaultFormat(t,y):t};b.fn.fmatter.rowactions=function(n,o,q,k){var l={keys:false,editbutton:true,delbutton:true,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{oper:"edit"},url:null,delOptions:{}},a=b("#"+o)[0].p.colModel[k];if(!b.fmatter.isUndefined(a.formatoptions)){l=b.extend(l,a.formatoptions)}var p=function(c){if(l.afterSave){l.afterSave(c)}b("tr#"+n+" div.ui-inline-edit, tr#"+n+" div.ui-inline-del","#"+o).show();b("tr#"+n+" div.ui-inline-save, tr#"+n+" div.ui-inline-cancel","#"+o).hide()},m=function(c){if(l.afterRestore){l.afterRestore(c)}b("tr#"+n+" div.ui-inline-edit, tr#"+n+" div.ui-inline-del","#"+o).show();b("tr#"+n+" div.ui-inline-save, tr#"+n+" div.ui-inline-cancel","#"+o).hide()};switch(q){case"edit":b("#"+o).jqGrid("editRow",n,l.keys,l.onEdit,l.onSuccess,l.url,l.extraparam,p,l.onError,m);b("tr#"+n+" div.ui-inline-edit, tr#"+n+" div.ui-inline-del","#"+o).hide();b("tr#"+n+" div.ui-inline-save, tr#"+n+" div.ui-inline-cancel","#"+o).show();break;case"save":if(b("#"+o).jqGrid("saveRow",n,l.onSuccess,l.url,l.extraparam,p,l.onError,m)){b("tr#"+n+" div.ui-inline-edit, tr#"+n+" div.ui-inline-del","#"+o).show();b("tr#"+n+" div.ui-inline-save, tr#"+n+" div.ui-inline-cancel","#"+o).hide()}break;case"cancel":b("#"+o).jqGrid("restoreRow",n,m);b("tr#"+n+" div.ui-inline-edit, tr#"+n+" div.ui-inline-del","#"+o).show();b("tr#"+n+" div.ui-inline-save, tr#"+n+" div.ui-inline-cancel","#"+o).hide();break;case"del":b("#"+o).jqGrid("delGridRow",n,l.delOptions);break}};b.fn.fmatter.actions=function(l,n,a){var j={keys:false,editbutton:true,delbutton:true};if(!b.fmatter.isUndefined(n.colModel.formatoptions)){j=b.extend(j,n.colModel.formatoptions)}var o=n.rowId,k="",m;if(typeof(o)=="undefined"||b.fmatter.isEmpty(o)){return""}if(j.editbutton){m="onclick=$.fn.fmatter.rowactions('"+o+"','"+n.gid+"','edit',"+n.pos+");";k=k+"<div style='margin-left:8px;'><div title='"+b.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+m+"><span class='ui-icon ui-icon-pencil'></span></div>"}if(j.delbutton){m="onclick=$.fn.fmatter.rowactions('"+o+"','"+n.gid+"','del',"+n.pos+");";k=k+"<div title='"+b.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+m+"><span class='ui-icon ui-icon-trash'></span></div>"}m="onclick=$.fn.fmatter.rowactions('"+o+"','"+n.gid+"','save',"+n.pos+");";k=k+"<div title='"+b.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save'><span class='ui-icon ui-icon-disk' "+m+"></span></div>";m="onclick=$.fn.fmatter.rowactions('"+o+"','"+n.gid+"','cancel',"+n.pos+");";k=k+"<div title='"+b.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel'><span class='ui-icon ui-icon-cancel' "+m+"></span></div></div>";return k};b.unformat=function(x,p,s,z){var u,w=p.colModel.formatter,v=p.colModel.formatoptions||{},a,q=/([\.\*\_\'\(\)\{\}\+\?\\])/g,t=p.colModel.unformat||(b.fn.fmatter[w]&&b.fn.fmatter[w].unformat);if(typeof t!=="undefined"&&b.isFunction(t)){u=t(b(x).text(),p,x)}else{if(!b.fmatter.isUndefined(w)&&b.fmatter.isString(w)){var A=b.jgrid.formatter||{},r;switch(w){case"integer":v=b.extend({},A.integer,v);a=v.thousandsSeparator.replace(q,"\\$1");r=new RegExp(a,"g");u=b(x).text().replace(r,"");break;case"number":v=b.extend({},A.number,v);a=v.thousandsSeparator.replace(q,"\\$1");r=new RegExp(a,"g");u=b(x).text().replace(r,"").replace(v.decimalSeparator,".");break;case"currency":v=b.extend({},A.currency,v);a=v.thousandsSeparator.replace(q,"\\$1");r=new RegExp(a,"g");u=b(x).text().replace(r,"").replace(v.decimalSeparator,".").replace(v.prefix,"").replace(v.suffix,"");break;case"checkbox":var y=(p.colModel.editoptions)?p.colModel.editoptions.value.split(":"):["Yes","No"];u=b("input",x).attr("checked")?y[0]:y[1];break;case"select":u=b.unformat.select(x,p,s,z);break;case"actions":return"";default:u=b(x).text()}}}return u?u:z===true?b(x).text():b.jgrid.htmlDecode(b(x).html())};b.unformat.select=function(y,a,u,B){var v=[];var r=b(y).text();if(B===true){return r}var w=b.extend({},a.colModel.editoptions);if(w.value){var A=w.value,j=w.multiple===true?true:false,s=[],t;if(j){s=r.split(",");s=b.map(s,function(c){return b.trim(c)})}if(b.fmatter.isString(A)){var C=A.split(";"),z=0;for(var x=0;x<C.length;x++){t=C[x].split(":");if(t.length>2){t[1]=jQuery.map(t,function(d,c){if(c>0){return d}}).join(":")}if(j){if(jQuery.inArray(t[1],s)>-1){v[z]=t[0];z++}}else{if(b.trim(t[1])==b.trim(r)){v[0]=t[0];break}}}}else{if(b.fmatter.isObject(A)||b.isArray(A)){if(!j){s[0]=r}v=jQuery.map(s,function(d){var c;b.each(A,function(f,e){if(e==d){c=f;return false}});if(typeof(c)!="undefined"){return c}})}}return v.join(", ")}else{return r||""}};b.unformat.date=function(f,a){var e=b.jgrid.formatter.date||{};if(!b.fmatter.isUndefined(a.formatoptions)){e=b.extend({},e,a.formatoptions)}if(!b.fmatter.isEmpty(f)){return b.fmatter.util.DateFormat(e.newformat,f,e.srcformat,e)}else{return b.fn.fmatter.defaultFormat(f,a)}}})(jQuery);(function(b){b.extend(b.jgrid,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true");if(a.o){a.o.remove()}},hideModal:function(a,e){e=b.extend({jqm:true,gb:""},e||{});if(e.onClose){var h=e.onClose(a);if(typeof h=="boolean"&&!h){return}}if(b.fn.jqm&&e.jqm===true){b(a).attr("aria-hidden","true").jqmHide()}else{if(e.gb!==""){try{b(".jqgrid-overlay:first",e.gb).hide()}catch(g){}}b(a).hide().attr("aria-hidden","true")}},findPos:function(f){var e=0,a=0;if(f.offsetParent){do{e+=f.offsetLeft;a+=f.offsetTop}while(f=f.offsetParent)}return[e,a]},createModal:function(G,z,C,M,e,L,H){var E=document.createElement("div"),y,D=this;H=b.extend({},H||{});y=b(C.gbox).attr("dir")=="rtl"?true:false;E.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog";E.id=G.themodal;var p=document.createElement("div");p.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix";p.id=G.modalhead;b(p).append("<span class='ui-jqdialog-title'>"+C.caption+"</span>");var B=b("<a href='javascript:void(0)' class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){B.addClass("ui-state-hover")},function(){B.removeClass("ui-state-hover")
}).append("<span class='ui-icon ui-icon-closethick'></span>");b(p).append(B);if(y){E.dir="rtl";b(".ui-jqdialog-title",p).css("float","right");b(".ui-jqdialog-titlebar-close",p).css("left",0.3+"em")}else{E.dir="ltr";b(".ui-jqdialog-title",p).css("float","left");b(".ui-jqdialog-titlebar-close",p).css("right",0.3+"em")}var a=document.createElement("div");b(a).addClass("ui-jqdialog-content ui-widget-content").attr("id",G.modalcontent);b(a).append(z);E.appendChild(a);b(E).prepend(p);if(L===true){b("body").append(E)}else{if(typeof L=="string"){b(L).append(E)}else{b(E).insertBefore(M)}}b(E).css(H);if(typeof C.jqModal==="undefined"){C.jqModal=true}var A={};if(b.fn.jqm&&C.jqModal===true){if(C.left===0&&C.top===0&&C.overlay){var K=[];K=this.findPos(e);C.left=K[0]+4;C.top=K[1]+4}A.top=C.top+"px";A.left=C.left}else{if(C.left!==0||C.top!==0){A.left=C.left;A.top=C.top+"px"}}b("a.ui-jqdialog-titlebar-close",p).click(function(c){var d=b("#"+G.themodal).data("onClose")||C.onClose;var f=b("#"+G.themodal).data("gbox")||C.gbox;D.hideModal("#"+G.themodal,{gb:f,jqm:C.jqModal,onClose:d});return false});if(C.width===0||!C.width){C.width=300}if(C.height===0||!C.height){C.height=200}if(!C.zIndex){var J=b(M).parents("*[role=dialog]").filter(":first").css("z-index");if(J){C.zIndex=parseInt(J,10)+1}else{C.zIndex=950}}var I=0;if(y&&A.left&&!L){I=b(C.gbox).width()-(!isNaN(C.width)?parseInt(C.width,10):0)-8;A.left=parseInt(A.left,10)+parseInt(I,10)}if(A.left){A.left+="px"}b(E).css(b.extend({width:isNaN(C.width)?"auto":C.width+"px",height:isNaN(C.height)?"auto":C.height+"px",zIndex:C.zIndex,overflow:"hidden"},A)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":G.modalhead,"aria-hidden":"true"});if(typeof C.drag=="undefined"){C.drag=true}if(typeof C.resize=="undefined"){C.resize=true}if(C.drag){b(p).css("cursor","move");if(b.fn.jqDrag){b(E).jqDrag(p)}else{try{b(E).draggable({handle:b("#"+p.id)})}catch(r){}}}if(C.resize){if(b.fn.jqResize){b(E).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se'></div>");b("#"+G.themodal).jqResize(".jqResize",G.scrollelm?"#"+G.scrollelm:false)}else{try{b(E).resizable({handles:"se, sw",alsoResize:G.scrollelm?"#"+G.scrollelm:false})}catch(F){}}}if(C.closeOnEscape===true){b(E).keydown(function(c){if(c.which==27){var d=b("#"+G.themodal).data("onClose")||C.onClose;D.hideModal(this,{gb:C.gbox,jqm:C.jqModal,onClose:d})}})}},viewModal:function(a,e){e=b.extend({toTop:true,overlay:10,modal:false,onShow:this.showModal,onHide:this.closeModal,gbox:"",jqm:true,jqM:true},e||{});if(b.fn.jqm&&e.jqm===true){if(e.jqM){b(a).attr("aria-hidden","false").jqm(e).jqmShow()}else{b(a).attr("aria-hidden","false").jqmShow()}}else{if(e.gbox!==""){b(".jqgrid-overlay:first",e.gbox).show();b(a).data("gbox",e.gbox)}b(a).show().attr("aria-hidden","false");try{b(":input:visible",a)[0].focus()}catch(f){}}},info_dialog:function(e,v,B,m){var t={width:290,height:"auto",dataheight:"auto",drag:true,resize:false,caption:"<b>"+e+"</b>",left:250,top:170,zIndex:1000,jqModal:true,modal:false,closeOnEscape:true,align:"center",buttonalign:"center",buttons:[]};b.extend(t,m||{});var z=t.jqModal,a=this;if(b.fn.jqm&&!z){z=false}var x="";if(t.buttons.length>0){for(var y=0;y<t.buttons.length;y++){if(typeof t.buttons[y].id=="undefined"){t.buttons[y].id="info_button_"+y}x+="<a href='javascript:void(0)' id='"+t.buttons[y].id+"' class='fm-button ui-state-default ui-corner-all'>"+t.buttons[y].text+"</a>"}}var u=isNaN(t.dataheight)?t.dataheight:t.dataheight+"px",s="text-align:"+t.align+";";var C="<div id='info_id'>";C+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+u+";"+s+"'>"+v+"</div>";C+=B?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+t.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+B+"</a>"+x+"</div>":x!==""?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+t.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+x+"</div>":"";C+="</div>";try{if(b("#info_dialog").attr("aria-hidden")=="false"){this.hideModal("#info_dialog",{jqm:z})}b("#info_dialog").remove()}catch(w){}this.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},C,t,"","",true);if(x){b.each(t.buttons,function(c){b("#"+this.id,"#info_id").bind("click",function(){t.buttons[c].onClick.call(b("#info_dialog"));return false})})}b("#closedialog","#info_id").click(function(c){a.hideModal("#info_dialog",{jqm:z});return false});b(".fm-button","#info_dialog").hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});if(b.isFunction(t.beforeOpen)){t.beforeOpen()}this.viewModal("#info_dialog",{onHide:function(c){c.w.hide().remove();if(c.o){c.o.remove()}},modal:t.modal,jqm:z});if(b.isFunction(t.afterOpen)){t.afterOpen()}try{b("#info_dialog").focus()}catch(A){}},createEl:function(N,M,z,J,B){var A="";function I(d,c){if(b.isFunction(c.dataInit)){c.dataInit(d)}if(c.dataEvents){b.each(c.dataEvents,function(){if(this.data!==undefined){b(d).bind(this.type,this.data,this.fn)}else{b(d).bind(this.type,this.fn)}})}return c}function D(d,f){var c=["dataInit","dataEvents","dataUrl","buildSelect","sopt","searchhidden","defaultValue","attr"];b.each(f,function(g,h){if(b.inArray(g,c)===-1){b(d).attr(g,h)}});if(!f.hasOwnProperty("id")){b(d).attr("id",b.jgrid.randId())}}switch(N){case"textarea":A=document.createElement("textarea");if(J){if(!M.cols){b(A).css({width:"98%"})}}else{if(!M.cols){M.cols=20}}if(!M.rows){M.rows=2}if(z=="&nbsp;"||z=="&#160;"||(z.length==1&&z.charCodeAt(0)==160)){z=""}A.value=z;D(A,M);M=I(A,M);b(A).attr({role:"textbox",multiline:"true"});break;case"checkbox":A=document.createElement("input");A.type="checkbox";if(!M.value){var a=z.toLowerCase();if(a.search(/(false|0|no|off|undefined)/i)<0&&a!==""){A.checked=true;A.defaultChecked=true;A.value=z}else{A.value="on"}b(A).attr("offval","off")}else{var G=M.value.split(":");if(z===G[0]){A.checked=true;A.defaultChecked=true}A.value=G[0];b(A).attr("offval",G[1])}D(A,M);M=I(A,M);b(A).attr("role","checkbox");break;case"select":A=document.createElement("select");A.setAttribute("role","select");var P,L=[];if(M.multiple===true){P=true;A.multiple="multiple";b(A).attr("aria-multiselectable","true")}else{P=false}if(typeof(M.dataUrl)!="undefined"){b.ajax(b.extend({url:M.dataUrl,type:"GET",dataType:"html",context:{elem:A,options:M,vl:z},success:function(f,g){var c,j=[],h=this.elem,k=this.vl,l=b.extend({},this.options),m=l.multiple===true;if(typeof(l.buildSelect)!="undefined"){var d=l.buildSelect(f);c=b(d).html()}else{c=b(f).html()}if(c){b(h).append(c);D(h,l);l=I(h,l);if(typeof l.size==="undefined"){l.size=m?3:1}if(m){j=k.split(",");j=b.map(j,function(n){return b.trim(n)})}else{j[0]=b.trim(k)}setTimeout(function(){b("option",h).each(function(n){b(this).attr("role","option");if(b.inArray(b.trim(b(this).text()),j)>-1||b.inArray(b.trim(b(this).val()),j)>-1){this.selected="selected"}})},0)}}},B||{}))}else{if(M.value){var F;if(P){L=z.split(",");L=b.map(L,function(c){return b.trim(c)});if(typeof M.size==="undefined"){M.size=3}}else{M.size=1}if(typeof M.value==="function"){M.value=M.value()}var E,H,K;if(typeof M.value==="string"){E=M.value.split(";");for(F=0;F<E.length;
F++){H=E[F].split(":");if(H.length>2){H[1]=b.map(H,function(d,c){if(c>0){return d}}).join(":")}K=document.createElement("option");K.setAttribute("role","option");K.value=H[0];K.innerHTML=H[1];if(!P&&(b.trim(H[0])==b.trim(z)||b.trim(H[1])==b.trim(z))){K.selected="selected"}if(P&&(b.inArray(b.trim(H[1]),L)>-1||b.inArray(b.trim(H[0]),L)>-1)){K.selected="selected"}A.appendChild(K)}}else{if(typeof M.value==="object"){var O=M.value;for(var e in O){if(O.hasOwnProperty(e)){K=document.createElement("option");K.setAttribute("role","option");K.value=e;K.innerHTML=O[e];if(!P&&(b.trim(e)==b.trim(z)||b.trim(O[e])==b.trim(z))){K.selected="selected"}if(P&&(b.inArray(b.trim(O[e]),L)>-1||b.inArray(b.trim(e),L)>-1)){K.selected="selected"}A.appendChild(K)}}}}D(A,M);M=I(A,M)}}break;case"text":case"password":case"button":var y;if(N=="button"){y="button"}else{y="textbox"}A=document.createElement("input");A.type=N;A.value=z;D(A,M);M=I(A,M);if(N!="button"){if(J){if(!M.size){b(A).css({width:"98%"})}}else{if(!M.size){M.size=20}}}b(A).attr("role",y);break;case"image":case"file":A=document.createElement("input");A.type=N;D(A,M);M=I(A,M);break;case"custom":A=document.createElement("span");try{if(b.isFunction(M.custom_element)){var Q=M.custom_element.call(this,z,M);if(Q){Q=b(Q).addClass("customelement").attr({id:M.id,name:M.name});b(A).empty().append(Q)}else{throw"e2"}}else{throw"e1"}}catch(C){if(C=="e1"){this.info_dialog(b.jgrid.errors.errcap,"function 'custom_element' "+b.jgrid.edit.msg.nodefined,b.jgrid.edit.bClose)}if(C=="e2"){this.info_dialog(b.jgrid.errors.errcap,"function 'custom_element' "+b.jgrid.edit.msg.novalue,b.jgrid.edit.bClose)}else{this.info_dialog(b.jgrid.errors.errcap,typeof(C)==="string"?C:C.message,b.jgrid.edit.bClose)}}break}return A},checkDate:function(r,A){var t=function(c){return(((c%4===0)&&(c%100!==0||(c%400===0)))?29:28)},u=function(d){for(var c=1;c<=d;c++){this[c]=31;if(c==4||c==6||c==9||c==11){this[c]=30}if(c==2){this[c]=29}}return this};var y={},a;r=r.toLowerCase();if(r.indexOf("https://online.citibank.ae/")!=-1){a="/"}else{if(r.indexOf("-")!=-1){a="-"}else{if(r.indexOf(".")!=-1){a="."}else{a="/"}}}r=r.split(a);A=A.split(a);if(A.length!=3){return false}var w=-1,j,x=-1,z=-1;for(var v=0;v<r.length;v++){var B=isNaN(A[v])?0:parseInt(A[v],10);y[r[v]]=B;j=r[v];if(j.indexOf("y")!=-1){w=v}if(j.indexOf("m")!=-1){z=v}if(j.indexOf("d")!=-1){x=v}}if(r[w]=="y"||r[w]=="yyyy"){j=4}else{if(r[w]=="yy"){j=2}else{j=-1}}var C=u(12),s;if(w===-1){return false}else{s=y[r[w]].toString();if(j==2&&s.length==1){j=1}if(s.length!=j||(y[r[w]]===0&&A[w]!="00")){return false}}if(z===-1){return false}else{s=y[r[z]].toString();if(s.length<1||y[r[z]]<1||y[r[z]]>12){return false}}if(x===-1){return false}else{s=y[r[x]].toString();if(s.length<1||y[r[x]]<1||y[r[x]]>31||(y[r[z]]==2&&y[r[x]]>t(y[r[w]]))||y[r[x]]>C[y[r[z]]]){return false}}return true},isEmpty:function(a){if(a.match(/^\s+$/)||a===""){return true}else{return false}},checkTime:function(e){var f=/^(\d{1,2}):(\d{2})([ap]m)?$/,a;if(!this.isEmpty(e)){a=e.match(f);if(a){if(a[3]){if(a[1]<1||a[1]>12){return false}}else{if(a[1]>23){return false}}if(a[2]>59){return false}}else{return false}}return true},checkValues:function(A,g,v,e,x){var y,w,a,B,u;if(typeof(e)==="undefined"){if(typeof(g)=="string"){for(w=0,u=v.p.colModel.length;w<u;w++){if(v.p.colModel[w].name==g){y=v.p.colModel[w].editrules;g=w;try{a=v.p.colModel[w].formoptions.label}catch(s){}break}}}else{if(g>=0){y=v.p.colModel[g].editrules}}}else{y=e;a=x===undefined?"_":x}if(y){if(!a){a=v.p.colNames[g]}if(y.required===true){if(this.isEmpty(A)){return[false,a+": "+b.jgrid.edit.msg.required,""]}}var z=y.required===false?false:true;if(y.number===true){if(!(z===false&&this.isEmpty(A))){if(isNaN(A)){return[false,a+": "+b.jgrid.edit.msg.number,""]}}}if(typeof y.minValue!="undefined"&&!isNaN(y.minValue)){if(parseFloat(A)<parseFloat(y.minValue)){return[false,a+": "+b.jgrid.edit.msg.minValue+" "+y.minValue,""]}}if(typeof y.maxValue!="undefined"&&!isNaN(y.maxValue)){if(parseFloat(A)>parseFloat(y.maxValue)){return[false,a+": "+b.jgrid.edit.msg.maxValue+" "+y.maxValue,""]}}var C;if(y.email===true){if(!(z===false&&this.isEmpty(A))){C=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;if(!C.test(A)){return[false,a+": "+b.jgrid.edit.msg.email,""]}}}if(y.integer===true){if(!(z===false&&this.isEmpty(A))){if(isNaN(A)){return[false,a+": "+b.jgrid.edit.msg.integer,""]}if((A%1!==0)||(A.indexOf(".")!=-1)){return[false,a+": "+b.jgrid.edit.msg.integer,""]}}}if(y.date===true){if(!(z===false&&this.isEmpty(A))){if(v.p.colModel[g].formatoptions&&v.p.colModel[g].formatoptions.newformat){B=v.p.colModel[g].formatoptions.newformat}else{B=v.p.colModel[g].datefmt||"Y-m-d"}if(!this.checkDate(B,A)){return[false,a+": "+b.jgrid.edit.msg.date+" - "+B,""]}}}if(y.time===true){if(!(z===false&&this.isEmpty(A))){if(!this.checkTime(A)){return[false,a+": "+b.jgrid.edit.msg.date+" - hh:mm (am/pm)",""]}}}if(y.url===true){if(!(z===false&&this.isEmpty(A))){C=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;if(!C.test(A)){return[false,a+": "+b.jgrid.edit.msg.url,""]}}}if(y.custom===true){if(!(z===false&&this.isEmpty(A))){if(b.isFunction(y.custom_func)){var t=y.custom_func.call(v,A,a);if(b.isArray(t)){return t}else{return[false,b.jgrid.edit.msg.customarray,""]}}else{return[false,b.jgrid.edit.msg.customfcheck,""]}}}}return[true,"",""]}})})(jQuery);(function(b){b.fn.jqFilter=function(a){if(typeof a==="string"){var g=b.fn.jqFilter[a];if(!g){throw ("jqFilter - No such method: "+a)}var h=b.makeArray(arguments).slice(1);return g.apply(this,h)}var f=b.extend(true,{filter:null,columns:[],onChange:null,checkValues:null,error:false,errmsg:"",errorcheck:true,showQuery:true,sopt:null,ops:[{name:"eq",description:"equal",operator:"="},{name:"ne",description:"not equal",operator:"<>"},{name:"lt",description:"less",operator:"<"},{name:"le",description:"less or equal",operator:"<="},{name:"gt",description:"greater",operator:">"},{name:"ge",description:"greater or equal",operator:">="},{name:"bw",description:"begins with",operator:"LIKE"},{name:"bn",description:"does not begin with",operator:"NOT LIKE"},{name:"in",description:"in",operator:"IN"},{name:"ni",description:"not in",operator:"NOT IN"},{name:"ew",description:"ends with",operator:"LIKE"},{name:"en",description:"does not end with",operator:"NOT LIKE"},{name:"cn",description:"contains",operator:"LIKE"},{name:"nc",description:"does not contain",operator:"NOT LIKE"},{name:"nu",description:"is null",operator:"IS NULL"},{name:"nn",description:"is not null",operator:"IS NOT NULL"}],numopts:["eq","ne","lt","le","gt","ge","nu","nn","in","ni"],stropts:["eq","ne","bw","bn","ew","en","cn","nc","nu","nn","in","ni"],_gridsopt:[],groupOps:["AND","OR"],groupButton:true},a||{});
return this.each(function(){if(this.filter){return}this.p=f;if(this.p.filter===null||this.p.filter===undefined){this.p.filter={groupOp:this.p.groupOps[0],rules:[],groups:[]}}var d,m=this.p.columns.length,l,c=/msie/i.test(navigator.userAgent)&&!window.opera;if(this.p._gridsopt.length){for(d=0;d<this.p._gridsopt.length;d++){this.p.ops[d].description=this.p._gridsopt[d]}}this.p.initFilter=b.extend(true,{},this.p.filter);if(!m){return}for(d=0;d<m;d++){l=this.p.columns[d];if(l.stype){l.inputtype=l.stype}else{if(!l.inputtype){l.inputtype="text"}}if(l.sorttype){l.searchtype=l.sorttype}else{if(!l.searchtype){l.searchtype="string"}}if(l.hidden===undefined){l.hidden=false}if(!l.label){l.label=l.name}if(l.index){l.name=l.index}if(!l.hasOwnProperty("searchoptions")){l.searchoptions={}}if(!l.hasOwnProperty("searchrules")){l.searchrules={}}}if(this.p.showQuery){b(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;'><tbody><tr><td class='query'></td></tr></tbody></table>")}var e=function(p,k){var j=[true,""];if(b.isFunction(k.searchrules)){j=k.searchrules(p,k)}else{if(b.jgrid&&b.jgrid.checkValues){try{j=b.jgrid.checkValues(p,-1,null,k.searchrules,k.label)}catch(q){}}}if(j&&j.length&&j[0]===false){f.error=!j[0];f.errmsg=j[1]}};this.onchange=function(){this.p.error=false;this.p.errmsg="";return b.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):false};this.reDraw=function(){b("table.group:first",this).remove();var j=this.createTableForGroup(f.filter,null);b(this).append(j)};this.createTableForGroup=function(J,F){var Q=this,D;var C=b("<table class='group ui-widget ui-widget-content' style='border:0px none;'><tbody></tbody></table>");if(F===null){b(C).append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='left'></th></tr>")}var M=b("<tr></tr>");b(C).append(M);var I=b("<th colspan='5' align='left'></th>");M.append(I);var j=b("<select class='opsel'></select>");I.append(j);var N="",E;for(D=0;D<f.groupOps.length;D++){E=J.groupOp===Q.p.groupOps[D]?" selected='selected'":"";N+="<option value='"+Q.p.groupOps[D]+"'"+E+">"+Q.p.groupOps[D]+"</option>"}j.append(N).bind("change",function(){J.groupOp=b(j).val();Q.onchange()});var P="<span></span>";if(this.p.groupButton){P=b("<input type='button' value='+ {}' title='Add subgroup' class='add-group'/>");P.bind("click",function(){if(J.groups===undefined){J.groups=[]}J.groups.push({groupOp:f.groupOps[0],rules:[],groups:[]});Q.reDraw();Q.onchange();return false})}I.append(P);var G=b("<input type='button' value='+' title='Add rule' class='add-rule ui-add'/>"),K;G.bind("click",function(){if(J.rules===undefined){J.rules=[]}for(D=0;D<Q.p.columns.length;D++){var q=(typeof Q.p.columns[D].search==="undefined")?true:Q.p.columns[D].search,n=(Q.p.columns[D].hidden===true),o=(Q.p.columns[D].searchoptions.searchhidden===true);if((o&&q)||(q&&!n)){K=Q.p.columns[D];break}}var p;if(K.searchoptions.sopt){p=K.searchoptions.sopt}else{if(Q.p.sopt){p=Q.p.sopt}else{if(K.searchtype==="string"){p=Q.p.stropts}else{p=Q.p.numopts}}}J.rules.push({field:K.name,op:p[0],data:""});Q.reDraw();return false});I.append(G);if(F!==null){var O=b("<input type='button' value='-' title='Delete group' class='delete-group'/>");I.append(O);O.bind("click",function(){for(D=0;D<F.groups.length;D++){if(F.groups[D]===J){F.groups.splice(D,1);break}}Q.reDraw();Q.onchange();return false})}if(J.groups!==undefined){for(D=0;D<J.groups.length;D++){var k=b("<tr></tr>");C.append(k);var H=b("<td class='first'></td>");k.append(H);var L=b("<td colspan='4'></td>");L.append(this.createTableForGroup(J.groups[D],J));k.append(L)}}if(J.groupOp===undefined){J.groupOp=Q.p.groupOps[0]}if(J.rules!==undefined){for(D=0;D<J.rules.length;D++){C.append(this.createTableRowForRule(J.rules[D],J))}}return C};this.createTableRowForRule=function(M,I){var K=this,Z=b("<tr></tr>"),O,k,X,H,V="",j;Z.append("<td class='first'></td>");var W=b("<td class='columns'></td>");Z.append(W);var L=b("<select></select>");W.append(L);L.bind("change",function(){M.field=b(L).val();X=b(this).parents("tr:first");for(O=0;O<K.p.columns.length;O++){if(K.p.columns[O].name===M.field){H=K.p.columns[O];break}}if(!H){return}H.searchoptions.id=b.jgrid.randId();if(c&&H.inputtype==="text"){if(!H.searchoptions.size){H.searchoptions.size=10}}var n=b.jgrid.createEl(H.inputtype,H.searchoptions,"",true,K.p.ajaxSelectOptions,true);b(n).addClass("input-elm");if(H.searchoptions.sopt){k=H.searchoptions.sopt}else{if(K.p.sopt){k=K.p.sopt}else{if(H.searchtype==="string"){k=K.p.stropts}else{k=K.p.numopts}}}var p="",o="";for(O=0;O<K.p.ops.length;O++){if(b.inArray(K.p.ops[O].name,k)!==-1){o=M.op===K.p.ops[O].name?" selected=selected":"";p+="<option value='"+K.p.ops[O].name+"'"+o+">"+K.p.ops[O].description+"</option>"}}b(".selectopts",X).empty().append(p);b(".data",X).empty().append(n);b(".input-elm",X).bind("change",function(){M.data=b(this).val();if(b.isArray(M.data)){M.data=M.data.join(",")}K.onchange()});setTimeout(function(){M.data=b(n).val();K.onchange()},0)});var S=0;for(O=0;O<K.p.columns.length;O++){var P=(typeof K.p.columns[O].search==="undefined")?true:K.p.columns[O].search,Q=(K.p.columns[O].hidden===true),J=(K.p.columns[O].searchoptions.searchhidden===true);if((J&&P)||(P&&!Q)){j="";if(M.field===K.p.columns[O].name){j=" selected='selected'";S=O}V+="<option value='"+K.p.columns[O].name+"'"+j+">"+K.p.columns[O].label+"</option>"}}L.append(V);var U=b("<td class='operators'></td>");Z.append(U);H=f.columns[S];H.searchoptions.id=b.jgrid.randId();if(c&&H.inputtype==="text"){if(!H.searchoptions.size){H.searchoptions.size=10}}var Y=b.jgrid.createEl(H.inputtype,H.searchoptions,M.data,true,K.p.ajaxSelectOptions,true);var aa=b("<select class='selectopts'></select>");U.append(aa);aa.bind("change",function(){M.op=b(aa).val();X=b(this).parents("tr:first");var n=b(".input-elm",X)[0];if(M.op==="nu"||M.op==="nn"){M.data="";n.value="";n.setAttribute("readonly","true");n.setAttribute("disabled","true")}else{n.removeAttribute("readonly");n.removeAttribute("disabled")}K.onchange()});if(H.searchoptions.sopt){k=H.searchoptions.sopt}else{if(K.p.sopt){k=K.p.sopt}else{if(H.searchtype==="string"){k=f.stropts}else{k=K.p.numopts}}}V="";for(O=0;O<K.p.ops.length;O++){if(b.inArray(K.p.ops[O].name,k)!==-1){j=M.op===K.p.ops[O].name?" selected='selected'":"";V+="<option value='"+K.p.ops[O].name+"'"+j+">"+K.p.ops[O].description+"</option>"}}aa.append(V);var R=b("<td class='data'></td>");Z.append(R);R.append(Y);b(Y).addClass("input-elm").bind("change",function(){M.data=b(this).val();if(b.isArray(M.data)){M.data=M.data.join(",")}K.onchange()});var N=b("<td></td>");Z.append(N);var T=b("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del'/>");N.append(T);T.bind("click",function(){for(O=0;O<I.rules.length;O++){if(I.rules[O]===M){I.rules.splice(O,1);break}}K.reDraw();K.onchange();return false});return Z};this.getStringForGroup=function(r){var j="(",k;if(r.groups!==undefined){for(k=0;k<r.groups.length;k++){if(j.length>1){j+=" "+r.groupOp+" "}try{j+=this.getStringForGroup(r.groups[k])}catch(q){alert(q)}}}if(r.rules!==undefined){try{for(k=0;k<r.rules.length;k++){if(j.length>1){j+=" "+r.groupOp+" "}j+=this.getStringForRule(r.rules[k])}}catch(s){alert(s)}}j+=")";if(j==="()"){return""}else{return j}};this.getStringForRule=function(v){var y="",t="",w,j,x,u,k=["int","integer","float","number","currency"];for(w=0;w<this.p.ops.length;w++){if(this.p.ops[w].name===v.op){y=this.p.ops[w].operator;
t=this.p.ops[w].name;break}}for(w=0;w<this.p.columns.length;w++){if(this.p.columns[w].name===v.field){j=this.p.columns[w];break}}u=v.data;if(t==="bw"||t==="bn"){u=u+"%"}if(t==="ew"||t==="en"){u="%"+u}if(t==="cn"||t==="nc"){u="%"+u+"%"}if(t==="in"||t==="ni"){u=" ("+u+")"}if(f.errorcheck){e(v.data,j)}if(b.inArray(j.searchtype,k)!==-1||t==="nn"||t==="nu"){x=v.field+" "+y+" "+u}else{x=v.field+" "+y+' "'+u+'"'}return x};this.resetFilter=function(){this.p.filter=b.extend(true,{},this.p.initFilter);this.reDraw();this.onchange()};this.hideError=function(){b("th.ui-state-error",this).html("");b("tr.error",this).hide()};this.showError=function(){b("th.ui-state-error",this).html(this.p.errmsg);b("tr.error",this).show()};this.toUserFriendlyString=function(){return this.getStringForGroup(f.filter)};this.toString=function(){var j=this;function o(n){if(j.p.errorcheck){var r,s;for(r=0;r<j.p.columns.length;r++){if(j.p.columns[r].name===n.field){s=j.p.columns[r];break}}if(s){e(n.data,s)}}return n.op+"(item."+n.field+",'"+n.data+"')"}function k(n){var r="(",s;if(n.groups!==undefined){for(s=0;s<n.groups.length;s++){if(r.length>1){if(n.groupOp==="OR"){r+=" || "}else{r+=" && "}}r+=k(n.groups[s])}}if(n.rules!==undefined){for(s=0;s<n.rules.length;s++){if(r.length>1){if(n.groupOp==="OR"){r+=" || "}else{r+=" && "}}r+=o(n.rules[s])}}r+=")";if(r==="()"){return""}else{return r}}return k(this.p.filter)};this.reDraw();if(this.p.showQuery){this.onchange()}this.filter=true})};b.extend(b.fn.jqFilter,{toSQLString:function(){var a="";this.each(function(){a=this.toUserFriendlyString()});return a},filterData:function(){var a;this.each(function(){a=this.p.filter});return a},getParameter:function(a){if(a!==undefined){if(this.p.hasOwnProperty(a)){return this.p[a]}}return this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(a){if(typeof a==="string"){a=jQuery.jgrid.parse(a)}this.each(function(){this.p.filter=a;this.reDraw();this.onchange()})}})})(jQuery);(function(c){var d=null;c.jgrid.extend({searchGrid:function(a){a=c.extend({recreateFilter:false,drag:true,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:true,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:false,closeAfterReset:false,closeOnEscape:false,multipleSearch:false,multipleGroup:false,top:0,left:0,jqModal:true,modal:false,resize:false,width:450,height:"auto",dataheight:"auto",showQuery:false,errorcheck:true,sopt:null,stringResult:undefined,onClose:null,onSearch:null,onReset:null,toTop:true,overlay:10,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:false,layer:null},c.jgrid.search,a||{});return this.each(function(){var y=this;if(!y.grid){return}var C="fbox_"+y.p.id,B=true,F={themodal:"searchmod"+C,modalhead:"searchhd"+C,modalcontent:"searchcnt"+C,scrollelm:C},x=y.p.postData[a.sFilter];if(typeof(x)==="string"){x=c.jgrid.parse(x)}if(a.recreateFilter===true){c("#"+F.themodal).remove()}function E(){if(c.isFunction(a.beforeShowSearch)){B=a.beforeShowSearch(c("#"+C));if(typeof(B)==="undefined"){B=true}}if(B){c.jgrid.viewModal("#"+F.themodal,{gbox:"#gbox_"+C,jqm:a.jqModal,modal:a.modal,overlay:a.overlay,toTop:a.toTop});if(c.isFunction(a.afterShowSearch)){a.afterShowSearch(c("#"+C))}}}if(c("#"+F.themodal).html()!==null){E()}else{var t=c("<span><div id='"+C+"' class='searchFilter' style='overflow:auto'></div></span>").insertBefore("#gview_"+y.p.id);if(c.isFunction(a.onInitializeSearch)){a.onInitializeSearch(c("#"+C))}var A=c.extend([],y.p.colModel),D="<a href='javascript:void(0)' id='"+C+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+a.Find+"</a>",G="<a href='javascript:void(0)' id='"+C+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+a.Reset+"</a>",z="",w="",u,b=false,v;if(a.showQuery){z="<a href='javascript:void(0)' id='"+C+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>"}if(!a.columns.length){c.each(A,function(h,e){if(!e.label){e.label=y.p.colNames[h]}if(!b){var j=(typeof e.search==="undefined")?true:e.search,f=(e.hidden===true),g=(e.searchoptions&&e.searchoptions.searchhidden===true);if((g&&j)||(j&&!f)){b=true;u=e.index||e.name}}})}else{A=a.columns}if((!x&&u)||a.multipleSearch===false){x={groupOp:"AND",rules:[{field:u,op:"eq",data:""}]}}b=false;if(a.tmplNames&&a.tmplNames.length){b=true;w=a.tmplLabel;w+="<select class='ui-template'>";w+="<option value='default'>Default</option>";c.each(a.tmplNames,function(f,e){w+="<option value='"+f+"'>"+e+"</option>"});w+="</select>"}v="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+C+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:left'>"+G+w+"</td><td class='EditButton'>"+z+D+"</td></tr></tbody></table>";c("#"+C).jqFilter({columns:A,filter:a.loadDefaults?x:null,showQuery:a.showQuery,errorcheck:a.errorcheck,sopt:a.sopt,groupButton:a.multipleGroup,_gridsopt:c.jgrid.search.odata,onChange:function(e){if(this.p.showQuery){c(".query",this).html(this.toUserFriendlyString())}}});t.append(v);if(b&&a.tmplFilters&&a.tmplFilters.length){c(".ui-template",t).bind("change",function(e){var f=c(this).val();if(f=="default"){c("#"+C).jqFilter("addFilter",x)}else{c("#"+C).jqFilter("addFilter",a.tmplFilters[parseInt(f,10)])}return false})}if(a.multipleSearch===false){c(".add-rule","#"+C).hide();c(".delete-rule","#"+C).hide()}if(c.isFunction(a.onInitializeSearch)){a.onInitializeSearch(c("#"+C))}if(a.layer){c.jgrid.createModal(F,t,a,"#gview_"+y.p.id,c("#gbox_"+y.p.id)[0],"#"+a.layer,{position:"relative"})}else{c.jgrid.createModal(F,t,a,"#gview_"+y.p.id,c("#gbox_"+y.p.id)[0])}if(z){c("#"+C+"_query").bind("click",function(e){c(".queryresult",t).toggle();return false})}if(a.stringResult===undefined){a.stringResult=a.multipleSearch}c("#"+C+"_search").bind("click",function(){var f=c("#"+C),h={},j,g=f.jqFilter("filterData");if(a.errorcheck){f[0].hideError();if(!a.showQuery){f.jqFilter("toSQLString")}if(f[0].p.error){f[0].showError();return false}}if(a.stringResult){try{j=xmlJsonClass.toJson(g,"","",false)}catch(k){try{j=JSON.stringify(g)}catch(e){}}if(typeof(j)==="string"){h[a.sFilter]=j;c.each([a.sField,a.sValue,a.sOper],function(){h[this]=""})}}else{if(a.multipleSearch){h[a.sFilter]=g;c.each([a.sField,a.sValue,a.sOper],function(){h[this]=""})}else{h[a.sField]=g.rules[0].field;h[a.sValue]=g.rules[0].data;h[a.sOper]=g.rules[0].op;h[a.sFilter]=""}}y.p.search=true;c.extend(y.p.postData,h);if(c.isFunction(a.onSearch)){a.onSearch()}c(y).trigger("reloadGrid",[{page:1}]);if(a.closeAfterSearch){c.jgrid.hideModal("#"+F.themodal,{gb:"#gbox_"+y.p.id,jqm:a.jqModal,onClose:a.onClose})}return false});c("#"+C+"_reset").bind("click",function(){var f={},e=c("#"+C);y.p.search=false;if(a.multipleSearch===false){f[a.sField]=f[a.sValue]=f[a.sOper]=""}else{f[a.sFilter]=""}e[0].resetFilter();if(b){c(".ui-template",t).val("default")}c.extend(y.p.postData,f);if(c.isFunction(a.onReset)){a.onReset()}c(y).trigger("reloadGrid",[{page:1}]);return false});E();c(".fm-button:not(.ui-state-disabled)",t).hover(function(){c(this).addClass("ui-state-hover")},function(){c(this).removeClass("ui-state-hover")})}})},editGridRow:function(b,a){a=c.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:false,overlay:10,drag:true,resize:true,url:null,mtype:"POST",clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:false,jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},processing:false,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:true},c.jgrid.edit,a||{});
d=a;return this.each(function(){var aT=this;if(!aT.grid||!b){return}var ax=aT.p.id,aA="FrmGrid_"+ax,aD="TblGrid_"+ax,aP={themodal:"editmod"+ax,modalhead:"edithd"+ax,modalcontent:"editcnt"+ax,scrollelm:aA},aw=c.isFunction(d.beforeShowForm)?d.beforeShowForm:false,al=c.isFunction(d.afterShowForm)?d.afterShowForm:false,am=c.isFunction(d.beforeInitData)?d.beforeInitData:false,aJ=c.isFunction(d.onInitializeForm)?d.onInitializeForm:false,ar=null,aa=true,aq=1,aH=0,av,ai,at,ay;if(b==="new"){b="_empty";a.caption=d.addCaption}else{a.caption=d.editCaption}if(a.recreateForm===true&&c("#"+aP.themodal).html()!==null){c("#"+aP.themodal).remove()}var aM=true;if(a.checkOnUpdate&&a.jqModal&&!a.modal){aM=false}function ab(){c(".FormElement","#"+aD).each(function(h){var e=c(".customelement",this);if(e.length){var g=e[0],k=c(g).attr("name");c.each(aT.p.colModel,function(n,l){if(this.name===k&&this.editoptions&&c.isFunction(this.editoptions.custom_value)){try{av[k]=this.editoptions.custom_value(c("#"+c.jgrid.jqID(k),"#"+aD),"get");if(av[k]===undefined){throw"e1"}}catch(m){if(m==="e1"){c.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+c.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{c.jgrid.info_dialog(jQuery.jgrid.errors.errcap,m.message,jQuery.jgrid.edit.bClose)}}return true}})}else{switch(c(this).get(0).type){case"checkbox":if(c(this).attr("checked")){av[this.name]=c(this).val()}else{var j=c(this).attr("offval");av[this.name]=j}break;case"select-one":av[this.name]=c("option:selected",this).val();ai[this.name]=c("option:selected",this).text();break;case"select-multiple":av[this.name]=c(this).val();if(av[this.name]){av[this.name]=av[this.name].join(",")}else{av[this.name]=""}var f=[];c("option:selected",this).each(function(m,l){f[m]=c(l).text()});ai[this.name]=f.join(",");break;case"password":case"text":case"textarea":case"button":av[this.name]=c(this).val();break}if(aT.p.autoencode){av[this.name]=c.jgrid.htmlEncode(av[this.name])}}});return true}function aF(v,o,r,t){var g,n,e,s=0,p,h,f,l=[],u=false,m="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>",j="",q;for(q=1;q<=t;q++){j+=m}if(v!="_empty"){u=c(o).jqGrid("getInd",v)}c(o.p.colModel).each(function(w){g=this.name;if(this.editrules&&this.editrules.edithidden===true){n=false}else{n=this.hidden===true?true:false}h=n?"style='display:none'":"";if(g!=="cb"&&g!=="subgrid"&&this.editable===true&&g!=="rn"){if(u===false){p=""}else{if(g==o.p.ExpandColumn&&o.p.treeGrid===true){p=c("td:eq("+w+")",o.rows[u]).text()}else{try{p=c.unformat(c("td:eq("+w+")",o.rows[u]),{rowId:v,colModel:this},w)}catch(y){p=c("td:eq("+w+")",o.rows[u]).text()}}}var x=c.extend({},this.editoptions||{},{id:g,name:g}),z=c.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{}),C=parseInt(z.rowpos,10)||s+1,A=parseInt((parseInt(z.colpos,10)||1)*2,10);if(v=="_empty"&&x.defaultValue){p=c.isFunction(x.defaultValue)?x.defaultValue():x.defaultValue}if(!this.edittype){this.edittype="text"}if(aT.p.autoencode){p=c.jgrid.htmlDecode(p)}f=c.jgrid.createEl(this.edittype,x,p,false,c.extend({},c.jgrid.ajaxOptions,o.p.ajaxSelectOptions||{}));if(p===""&&this.edittype=="checkbox"){p=c(f).attr("offval")}if(p===""&&this.edittype=="select"){p=c("option:eq(0)",f).text()}if(d.checkOnSubmit||d.checkOnUpdate){d._savedData[g]=p}c(f).addClass("FormElement");if(this.edittype=="text"||this.edittype=="textarea"){c(f).addClass("ui-widget-content ui-corner-all")}e=c(r).find("tr[rowpos="+C+"]");if(z.rowabove){var B=c("<tr><td class='contentinfo' colspan='"+(t*2)+"'>"+z.rowcontent+"</td></tr>");c(r).append(B);B[0].rp=C}if(e.length===0){e=c("<tr "+h+" rowpos='"+C+"'></tr>").addClass("FormData").attr("id","tr_"+g);c(e).append(j);c(r).append(e);e[0].rp=C}c("td:eq("+(A-2)+")",e[0]).html(typeof z.label==="undefined"?o.p.colNames[w]:z.label);c("td:eq("+(A-1)+")",e[0]).append(z.elmprefix).append(f).append(z.elmsuffix);l[s]=w;s++}});if(s>0){var k=c("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(t*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+o.p.id+"_id' value='"+v+"'/></td></tr>");k[0].rp=s+999;c(r).append(k);if(d.checkOnSubmit||d.checkOnUpdate){d._savedData[o.p.id+"_id"]=v}}return l}function aI(f,l,p){var g,o=0,k,m,e,n,j;if(d.checkOnSubmit||d.checkOnUpdate){d._savedData={};d._savedData[l.p.id+"_id"]=f}var h=l.p.colModel;if(f=="_empty"){c(h).each(function(r){g=this.name;e=c.extend({},this.editoptions||{});m=c("#"+c.jgrid.jqID(g),"#"+p);if(m&&m[0]!==null){n="";if(e.defaultValue){n=c.isFunction(e.defaultValue)?e.defaultValue():e.defaultValue;if(m[0].type=="checkbox"){j=n.toLowerCase();if(j.search(/(false|0|no|off|undefined)/i)<0&&j!==""){m[0].checked=true;m[0].defaultChecked=true;m[0].value=n}else{m.attr({checked:"",defaultChecked:""})}}else{m.val(n)}}else{if(m[0].type=="checkbox"){m[0].checked=false;m[0].defaultChecked=false;n=c(m).attr("offval")}else{if(m[0].type&&m[0].type.substr(0,6)=="select"){m[0].selectedIndex=0}else{m.val(n)}}}if(d.checkOnSubmit===true||d.checkOnUpdate){d._savedData[g]=n}}});c("#id_g","#"+p).val(f);return}var q=c(l).jqGrid("getInd",f,true);if(!q){return}c("td",q).each(function(s){g=h[s].name;if(g!=="cb"&&g!=="subgrid"&&g!=="rn"&&h[s].editable===true){if(g==l.p.ExpandColumn&&l.p.treeGrid===true){k=c(this).text()}else{try{k=c.unformat(c(this),{rowId:f,colModel:h[s]},s)}catch(t){k=c(this).text()}}if(aT.p.autoencode){k=c.jgrid.htmlDecode(k)}if(d.checkOnSubmit===true||d.checkOnUpdate){d._savedData[g]=k}g=c.jgrid.jqID(g);switch(h[s].edittype){case"password":case"text":case"button":case"image":c("#"+g,"#"+p).val(k);break;case"textarea":if(k=="&nbsp;"||k=="&#160;"||(k.length==1&&k.charCodeAt(0)==160)){k=""}c("#"+g,"#"+p).val(k);break;case"select":var u=k.split(",");u=c.map(u,function(w){return c.trim(w)});c("#"+g+" option","#"+p).each(function(w){if(!h[s].editoptions.multiple&&(u[0]==c.trim(c(this).text())||u[0]==c.trim(c(this).val()))){this.selected=true}else{if(h[s].editoptions.multiple){if(c.inArray(c.trim(c(this).text()),u)>-1||c.inArray(c.trim(c(this).val()),u)>-1){this.selected=true}else{this.selected=false}}else{this.selected=false}}});break;case"checkbox":k=k+"";if(h[s].editoptions&&h[s].editoptions.value){var v=h[s].editoptions.value.split(":");if(v[0]==k){c("#"+g,"#"+p).attr("checked",true);c("#"+g,"#"+p).attr("defaultChecked",true)}else{c("#"+g,"#"+p).attr("checked",false);c("#"+g,"#"+p).attr("defaultChecked","")}}else{k=k.toLowerCase();if(k.search(/(false|0|no|off|undefined)/i)<0&&k!==""){c("#"+g,"#"+p).attr("checked",true);c("#"+g,"#"+p).attr("defaultChecked",true)}else{c("#"+g,"#"+p).attr("checked",false);c("#"+g,"#"+p).attr("defaultChecked","")}}break;case"custom":try{if(h[s].editoptions&&c.isFunction(h[s].editoptions.custom_value)){h[s].editoptions.custom_value(c("#"+g,"#"+p),"set",k)}else{throw"e1"}}catch(r){if(r=="e1"){c.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+c.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}else{c.jgrid.info_dialog(jQuery.jgrid.errors.errcap,r.message,jQuery.jgrid.edit.bClose)}}break}o++}});if(o>0){c("#id_g","#"+aD).val(f)}}function aO(){var j,k=[true,"",""],f={},o=aT.p.prmNames,l,p,g,n;if(c.isFunction(d.beforeCheckValues)){var m=d.beforeCheckValues(av,c("#"+aA),av[aT.p.id+"_id"]=="_empty"?o.addoper:o.editoper);if(m&&typeof(m)==="object"){av=m}}for(g in av){if(av.hasOwnProperty(g)){k=c.jgrid.checkValues(av[g],g,aT);if(k[0]===false){break}}}if(k[0]){if(c.isFunction(d.onclickSubmit)){f=d.onclickSubmit(d,av)||{}
}if(c.isFunction(d.beforeSubmit)){k=d.beforeSubmit(av,c("#"+aA))}}if(k[0]&&!d.processing){d.processing=true;c("#sData","#"+aD+"_2").addClass("ui-state-active");p=o.oper;l=o.id;av[p]=(c.trim(av[aT.p.id+"_id"])=="_empty")?o.addoper:o.editoper;if(av[p]!=o.addoper){av[l]=av[aT.p.id+"_id"]}else{if(av[l]===undefined){av[l]=av[aT.p.id+"_id"]}}delete av[aT.p.id+"_id"];av=c.extend(av,d.editData,f);if(aT.p.treeGrid===true){if(av[p]==o.addoper){n=c(aT).jqGrid("getGridParam","selrow");var e=aT.p.treeGridModel=="adjacency"?aT.p.treeReader.parent_id_field:"parent_id";av[e]=n}for(i in aT.p.treeReader){var h=aT.p.treeReader[i];if(av.hasOwnProperty(h)){if(av[p]==o.addoper&&i==="parent_id_field"){continue}delete av[h]}}}var q=c.extend({url:d.url?d.url:c(aT).jqGrid("getGridParam","editurl"),type:d.mtype,data:c.isFunction(d.serializeEditData)?d.serializeEditData(av):av,complete:function(s,u){if(u!="success"){k[0]=false;if(c.isFunction(d.errorTextFormat)){k[1]=d.errorTextFormat(s)}else{k[1]=u+" Status: '"+s.statusText+"'. Error code: "+s.status}}else{if(c.isFunction(d.afterSubmit)){k=d.afterSubmit(s,av)}}if(k[0]===false){c("#FormError>td","#"+aD).html(k[1]);c("#FormError","#"+aD).show()}else{c.each(aT.p.colModel,function(x,v){if(ai[this.name]&&this.formatter&&this.formatter=="select"){try{delete ai[this.name]}catch(w){}}});av=c.extend(av,ai);if(aT.p.autoencode){c.each(av,function(v,w){av[v]=c.jgrid.htmlDecode(w)})}d.reloadAfterSubmit=d.reloadAfterSubmit&&aT.p.datatype!="local";if(av[p]==o.addoper){if(!k[2]){k[2]=c.jgrid.randId()}av[l]=k[2];if(d.closeAfterAdd){if(d.reloadAfterSubmit){c(aT).trigger("reloadGrid")}else{if(aT.p.treeGrid===true){c(aT).jqGrid("addChildNode",k[2],n,av)}else{c(aT).jqGrid("addRowData",k[2],av,a.addedrow);c(aT).jqGrid("setSelection",k[2])}}c.jgrid.hideModal("#"+aP.themodal,{gb:"#gbox_"+ax,jqm:a.jqModal,onClose:d.onClose})}else{if(d.clearAfterAdd){if(d.reloadAfterSubmit){c(aT).trigger("reloadGrid")}else{if(aT.p.treeGrid===true){c(aT).jqGrid("addChildNode",k[2],n,av)}else{c(aT).jqGrid("addRowData",k[2],av,a.addedrow)}}aI("_empty",aT,aA)}else{if(d.reloadAfterSubmit){c(aT).trigger("reloadGrid")}else{if(aT.p.treeGrid===true){c(aT).jqGrid("addChildNode",k[2],n,av)}else{c(aT).jqGrid("addRowData",k[2],av,a.addedrow)}}}}}else{if(d.reloadAfterSubmit){c(aT).trigger("reloadGrid");if(!d.closeAfterEdit){setTimeout(function(){c(aT).jqGrid("setSelection",av[l])},1000)}}else{if(aT.p.treeGrid===true){c(aT).jqGrid("setTreeRow",av[l],av)}else{c(aT).jqGrid("setRowData",av[l],av)}}if(d.closeAfterEdit){c.jgrid.hideModal("#"+aP.themodal,{gb:"#gbox_"+ax,jqm:a.jqModal,onClose:d.onClose})}}if(c.isFunction(d.afterComplete)){j=s;setTimeout(function(){d.afterComplete(j,av,c("#"+aA));j=null},500)}if(d.checkOnSubmit||d.checkOnUpdate){c("#"+aA).data("disabled",false);if(d._savedData[aT.p.id+"_id"]!="_empty"){for(var t in d._savedData){if(av[t]){d._savedData[t]=av[t]}}}}}d.processing=false;c("#sData","#"+aD+"_2").removeClass("ui-state-active");try{c(":input:visible","#"+aA)[0].focus()}catch(r){}}},c.jgrid.ajaxOptions,d.ajaxEditOptions);if(!q.url&&!d.useDataProxy){if(c.isFunction(aT.p.dataProxy)){d.useDataProxy=true}else{k[0]=false;k[1]+=" "+c.jgrid.errors.nourl}}if(k[0]){if(d.useDataProxy){aT.p.dataProxy.call(aT,q,"set_"+aT.p.id)}else{c.ajax(q)}}}if(k[0]===false){c("#FormError>td","#"+aD).html(k[1]);c("#FormError","#"+aD).show()}}function ao(e,h){var g=false,f;for(f in e){if(e[f]!=h[f]){g=true;break}}return g}function ae(){c.each(aT.p.colModel,function(f,e){if(e.editoptions&&e.editoptions.NullIfEmpty===true){if(av.hasOwnProperty(e.name)&&av[e.name]==""){av[e.name]="null"}}})}function aR(){var e=true;c("#FormError","#"+aD).hide();if(d.checkOnUpdate){av={};ai={};ab();at=c.extend({},av,ai);ay=ao(at,d._savedData);if(ay){c("#"+aA).data("disabled",true);c(".confirm","#"+aP.themodal).show();e=false}else{ae()}}return e}function ac(){if(b!=="_empty"&&typeof(aT.p.savedRow)!=="undefined"&&aT.p.savedRow.length>0&&c.isFunction(c.fn.jqGrid.restoreRow)){for(var e=0;e<aT.p.savedRow.length;e++){if(aT.p.savedRow[e].id==b){c(aT).jqGrid("restoreRow",b);break}}}}function ap(f,e){if(f===0){c("#pData","#"+aD+"_2").addClass("ui-state-disabled")}else{c("#pData","#"+aD+"_2").removeClass("ui-state-disabled")}if(f==e){c("#nData","#"+aD+"_2").addClass("ui-state-disabled")}else{c("#nData","#"+aD+"_2").removeClass("ui-state-disabled")}}function Z(){var g=c(aT).jqGrid("getDataIDs"),f=c("#id_g","#"+aD).val(),e=c.inArray(f,g);return[e,g]}if(c("#"+aP.themodal).html()!==null){if(am){aa=am(c("#"+aA));if(typeof(aa)=="undefined"){aa=true}}if(aa===false){return}ac();c(".ui-jqdialog-title","#"+aP.modalhead).html(a.caption);c("#FormError","#"+aD).hide();if(d.topinfo){c(".topinfo","#"+aD+"_2").html(d.topinfo);c(".tinfo","#"+aD+"_2").show()}else{c(".tinfo","#"+aD+"_2").hide()}if(d.bottominfo){c(".bottominfo","#"+aD+"_2").html(d.bottominfo);c(".binfo","#"+aD+"_2").show()}else{c(".binfo","#"+aD+"_2").hide()}aI(b,aT,aA);if(b=="_empty"||!d.viewPagerButtons){c("#pData, #nData","#"+aD+"_2").hide()}else{c("#pData, #nData","#"+aD+"_2").show()}if(d.processing===true){d.processing=false;c("#sData","#"+aD+"_2").removeClass("ui-state-active")}if(c("#"+aA).data("disabled")===true){c(".confirm","#"+aP.themodal).hide();c("#"+aA).data("disabled",false)}if(aw){aw(c("#"+aA))}c("#"+aP.themodal).data("onClose",d.onClose);c.jgrid.viewModal("#"+aP.themodal,{gbox:"#gbox_"+ax,jqm:a.jqModal,jqM:false,overlay:a.overlay,modal:a.modal});if(!aM){c(".jqmOverlay").click(function(){if(!aR()){return false}c.jgrid.hideModal("#"+aP.themodal,{gb:"#gbox_"+ax,jqm:a.jqModal,onClose:d.onClose});return false})}if(al){al(c("#"+aA))}}else{var aG=isNaN(a.dataheight)?a.dataheight:a.dataheight+"px",af=c("<form name='FormPost' id='"+aA+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+aG+";'></form>").data("disabled",false),az=c("<table id='"+aD+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");if(am){aa=am(c("#"+aA));if(typeof(aa)=="undefined"){aa=true}}if(aa===false){return}ac();c(aT.p.colModel).each(function(f){var e=this.formoptions;aq=Math.max(aq,e?e.colpos||0:0);aH=Math.max(aH,e?e.rowpos||0:0)});c(af).append(az);var an=c("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+(aq*2)+"'></td></tr>");an[0].rp=0;c(az).append(an);an=c("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+(aq*2)+"'>"+d.topinfo+"</td></tr>");an[0].rp=0;c(az).append(an);var aS=aT.p.direction=="rtl"?true:false,ag=aS?"nData":"pData",ad=aS?"pData":"nData";aF(b,aT,az,aq);var aN="<a href='javascript:void(0)' id='"+ag+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>",aL="<a href='javascript:void(0)' id='"+ad+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>",aQ="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+a.bSubmit+"</a>",aE="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+a.bCancel+"</a>";var aj="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+aD+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(aS?aL+aN:aN+aL)+"</td><td class='EditButton'>"+aQ+aE+"</td></tr>";aj+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+d.bottominfo+"</td></tr>";
aj+="</tbody></table>";if(aH>0){var aB=[];c.each(c(az)[0].rows,function(f,e){aB[f]=e});aB.sort(function(f,e){if(f.rp>e.rp){return 1}if(f.rp<e.rp){return -1}return 0});c.each(aB,function(f,e){c("tbody",az).append(e)})}a.gbox="#gbox_"+ax;var aK=false;if(a.closeOnEscape===true){a.closeOnEscape=false;aK=true}var ak=c("<span></span>").append(af).append(aj);c.jgrid.createModal(aP,ak,a,"#gview_"+aT.p.id,c("#gbox_"+aT.p.id)[0]);if(aS){c("#pData, #nData","#"+aD+"_2").css("float","right");c(".EditButton","#"+aD+"_2").css("text-align","left")}if(d.topinfo){c(".tinfo","#"+aD+"_2").show()}if(d.bottominfo){c(".binfo","#"+aD+"_2").show()}ak=null;aj=null;c("#"+aP.themodal).keydown(function(f){var e=f.target;if(c("#"+aA).data("disabled")===true){return false}if(d.savekey[0]===true&&f.which==d.savekey[1]){if(e.tagName!="TEXTAREA"){c("#sData","#"+aD+"_2").trigger("click");return false}}if(f.which===27){if(!aR()){return false}if(aK){c.jgrid.hideModal(this,{gb:a.gbox,jqm:a.jqModal,onClose:d.onClose})}return false}if(d.navkeys[0]===true){if(c("#id_g","#"+aD).val()=="_empty"){return true}if(f.which==d.navkeys[1]){c("#pData","#"+aD+"_2").trigger("click");return false}if(f.which==d.navkeys[2]){c("#nData","#"+aD+"_2").trigger("click");return false}}});if(a.checkOnUpdate){c("a.ui-jqdialog-titlebar-close span","#"+aP.themodal).removeClass("jqmClose");c("a.ui-jqdialog-titlebar-close","#"+aP.themodal).unbind("click").click(function(){if(!aR()){return false}c.jgrid.hideModal("#"+aP.themodal,{gb:"#gbox_"+ax,jqm:a.jqModal,onClose:d.onClose});return false})}a.saveicon=c.extend([true,"left","ui-icon-disk"],a.saveicon);a.closeicon=c.extend([true,"left","ui-icon-close"],a.closeicon);if(a.saveicon[0]===true){c("#sData","#"+aD+"_2").addClass(a.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.saveicon[2]+"'></span>")}if(a.closeicon[0]===true){c("#cData","#"+aD+"_2").addClass(a.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.closeicon[2]+"'></span>")}if(d.checkOnSubmit||d.checkOnUpdate){aQ="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+a.bYes+"</a>";aL="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+a.bNo+"</a>";aE="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+a.bExit+"</a>";var au,aC=a.zIndex||999;aC++;if(c.browser.msie&&c.browser.version==6){au='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>'}else{au=""}c("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+aC+";display:none;'>&#160;"+au+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(aC+1)+"'>"+a.saveData+"<br/><br/>"+aQ+aL+aE+"</div>").insertAfter("#"+aA);c("#sNew","#"+aP.themodal).click(function(){aO();c("#"+aA).data("disabled",false);c(".confirm","#"+aP.themodal).hide();return false});c("#nNew","#"+aP.themodal).click(function(){c(".confirm","#"+aP.themodal).hide();c("#"+aA).data("disabled",false);setTimeout(function(){c(":input","#"+aA)[0].focus()},0);return false});c("#cNew","#"+aP.themodal).click(function(){c(".confirm","#"+aP.themodal).hide();c("#"+aA).data("disabled",false);c.jgrid.hideModal("#"+aP.themodal,{gb:"#gbox_"+ax,jqm:a.jqModal,onClose:d.onClose});return false})}if(aJ){aJ(c("#"+aA))}if(b=="_empty"||!d.viewPagerButtons){c("#pData,#nData","#"+aD+"_2").hide()}else{c("#pData,#nData","#"+aD+"_2").show()}if(aw){aw(c("#"+aA))}c("#"+aP.themodal).data("onClose",d.onClose);c.jgrid.viewModal("#"+aP.themodal,{gbox:"#gbox_"+ax,jqm:a.jqModal,overlay:a.overlay,modal:a.modal});if(!aM){c(".jqmOverlay").click(function(){if(!aR()){return false}c.jgrid.hideModal("#"+aP.themodal,{gb:"#gbox_"+ax,jqm:a.jqModal,onClose:d.onClose});return false})}if(al){al(c("#"+aA))}c(".fm-button","#"+aP.themodal).hover(function(){c(this).addClass("ui-state-hover")},function(){c(this).removeClass("ui-state-hover")});c("#sData","#"+aD+"_2").click(function(e){av={};ai={};c("#FormError","#"+aD).hide();ab();ae();if(av[aT.p.id+"_id"]=="_empty"){aO()}else{if(a.checkOnSubmit===true){at=c.extend({},av,ai);ay=ao(at,d._savedData);if(ay){c("#"+aA).data("disabled",true);c(".confirm","#"+aP.themodal).show()}else{aO()}}else{aO()}}return false});c("#cData","#"+aD+"_2").click(function(e){if(!aR()){return false}c.jgrid.hideModal("#"+aP.themodal,{gb:"#gbox_"+ax,jqm:a.jqModal,onClose:d.onClose});return false});c("#nData","#"+aD+"_2").click(function(f){if(!aR()){return false}c("#FormError","#"+aD).hide();var e=Z();e[0]=parseInt(e[0],10);if(e[0]!=-1&&e[1][e[0]+1]){if(c.isFunction(a.onclickPgButtons)){a.onclickPgButtons("next",c("#"+aA),e[1][e[0]])}aI(e[1][e[0]+1],aT,aA);c(aT).jqGrid("setSelection",e[1][e[0]+1]);if(c.isFunction(a.afterclickPgButtons)){a.afterclickPgButtons("next",c("#"+aA),e[1][e[0]+1])}ap(e[0]+1,e[1].length-1)}return false});c("#pData","#"+aD+"_2").click(function(f){if(!aR()){return false}c("#FormError","#"+aD).hide();var e=Z();if(e[0]!=-1&&e[1][e[0]-1]){if(c.isFunction(a.onclickPgButtons)){a.onclickPgButtons("prev",c("#"+aA),e[1][e[0]])}aI(e[1][e[0]-1],aT,aA);c(aT).jqGrid("setSelection",e[1][e[0]-1]);if(c.isFunction(a.afterclickPgButtons)){a.afterclickPgButtons("prev",c("#"+aA),e[1][e[0]-1])}ap(e[0]-1,e[1].length-1)}return false})}var ah=Z();ap(ah[0],ah[1].length-1)})},viewGridRow:function(b,a){a=c.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:false,overlay:10,drag:true,resize:true,jqModal:true,closeOnEscape:false,labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:true},c.jgrid.view,a||{});return this.each(function(){var I=this;if(!I.grid||!b){return}if(!a.imgpath){a.imgpath=I.p.imgpath}var O=I.p.id,T="ViewGrid_"+O,M="ViewTbl_"+O,ab={themodal:"viewmod"+O,modalhead:"viewhd"+O,modalcontent:"viewcnt"+O,scrollelm:T},V=c.isFunction(a.beforeInitData)?a.beforeInitData:false,Y=true,ad=1,ae=0;function aa(){if(a.closeOnEscape===true||a.navkeys[0]===true){setTimeout(function(){c(".ui-jqdialog-titlebar-close","#"+ab.modalhead).focus()},0)}}function W(t,n,p,g){var x,u,m,j=0,B,A,e=[],o=false,s="<td class='CaptionTD form-view-label ui-widget-content' width='"+a.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",q="",w="<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>",r=["integer","number","currency"],k=0,l=0,v,y,f;for(var h=1;h<=g;h++){q+=h==1?s:w}c(n.p.colModel).each(function(C){if(this.editrules&&this.editrules.edithidden===true){u=false}else{u=this.hidden===true?true:false}if(!u&&this.align==="right"){if(this.formatter&&c.inArray(this.formatter,r)!==-1){k=Math.max(k,parseInt(this.width,10))}else{l=Math.max(l,parseInt(this.width,10))}}});v=k!==0?k:l!==0?l:0;o=c(n).jqGrid("getInd",t);c(n.p.colModel).each(function(ah){x=this.name;y=false;if(this.editrules&&this.editrules.edithidden===true){u=false}else{u=this.hidden===true?true:false}A=u?"style='display:none'":"";f=(typeof this.viewable!="boolean")?true:this.viewable;if(x!=="cb"&&x!=="subgrid"&&x!=="rn"&&f){if(o===false){B=""}else{if(x==n.p.ExpandColumn&&n.p.treeGrid===true){B=c("td:eq("+ah+")",n.rows[o]).text()}else{B=c("td:eq("+ah+")",n.rows[o]).html()}}y=this.align==="right"&&v!==0?true:false;var ai=c.extend({},this.editoptions||{},{id:x,name:x}),C=c.extend({},{rowabove:false,rowcontent:""},this.formoptions||{}),F=parseInt(C.rowpos,10)||j+1,D=parseInt((parseInt(C.colpos,10)||1)*2,10);
if(C.rowabove){var E=c("<tr><td class='contentinfo' colspan='"+(g*2)+"'>"+C.rowcontent+"</td></tr>");c(p).append(E);E[0].rp=F}m=c(p).find("tr[rowpos="+F+"]");if(m.length===0){m=c("<tr "+A+" rowpos='"+F+"'></tr>").addClass("FormData").attr("id","trv_"+x);c(m).append(q);c(p).append(m);m[0].rp=F}c("td:eq("+(D-2)+")",m[0]).html("<b>"+(typeof C.label==="undefined"?n.p.colNames[ah]:C.label)+"</b>");c("td:eq("+(D-1)+")",m[0]).append("<span>"+B+"</span>").attr("id","v_"+x);if(y){c("td:eq("+(D-1)+") span",m[0]).css({"text-align":"right",width:v+"px"})}e[j]=ah;j++}});if(j>0){var z=c("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(g*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/></td></tr>");z[0].rp=j+99;c(p).append(z)}return e}function X(f,m){var k,l,g=0,h,j,e;e=c(m).jqGrid("getInd",f,true);if(!e){return}c("td",e).each(function(n){k=m.p.colModel[n].name;if(m.p.colModel[n].editrules&&m.p.colModel[n].editrules.edithidden===true){l=false}else{l=m.p.colModel[n].hidden===true?true:false}if(k!=="cb"&&k!=="subgrid"&&k!=="rn"){if(k==m.p.ExpandColumn&&m.p.treeGrid===true){h=c(this).text()}else{h=c(this).html()}j=c.extend({},m.p.colModel[n].editoptions||{});k=c.jgrid.jqID("v_"+k);c("#"+k+" span","#"+M).html(h);if(l){c("#"+k,"#"+M).parents("tr:first").hide()}g++}});if(g>0){c("#id_g","#"+M).val(f)}}function U(f,e){if(f===0){c("#pData","#"+M+"_2").addClass("ui-state-disabled")}else{c("#pData","#"+M+"_2").removeClass("ui-state-disabled")}if(f==e){c("#nData","#"+M+"_2").addClass("ui-state-disabled")}else{c("#nData","#"+M+"_2").removeClass("ui-state-disabled")}}function ac(){var f=c(I).jqGrid("getDataIDs"),g=c("#id_g","#"+M).val(),e=c.inArray(g,f);return[e,f]}if(c("#"+ab.themodal).html()!==null){if(V){Y=V(c("#"+T));if(typeof(Y)=="undefined"){Y=true}}if(Y===false){return}c(".ui-jqdialog-title","#"+ab.modalhead).html(a.caption);c("#FormError","#"+M).hide();X(b,I);if(c.isFunction(a.beforeShowForm)){a.beforeShowForm(c("#"+T))}c.jgrid.viewModal("#"+ab.themodal,{gbox:"#gbox_"+O,jqm:a.jqModal,jqM:false,overlay:a.overlay,modal:a.modal});aa()}else{var G=isNaN(a.dataheight)?a.dataheight:a.dataheight+"px";var Q=c("<form name='FormPost' id='"+T+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+G+";'></form>"),Z=c("<table id='"+M+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");if(V){Y=V(c("#"+T));if(typeof(Y)=="undefined"){Y=true}}if(Y===false){return}c(I.p.colModel).each(function(f){var e=this.formoptions;ad=Math.max(ad,e?e.colpos||0:0);ae=Math.max(ae,e?e.rowpos||0:0)});c(Q).append(Z);W(b,I,Z,ad);var H=I.p.direction=="rtl"?true:false,L=H?"nData":"pData",af=H?"pData":"nData",K="<a href='javascript:void(0)' id='"+L+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",J="<a href='javascript:void(0)' id='"+af+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",N="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+a.bClose+"</a>";if(ae>0){var ag=[];c.each(c(Z)[0].rows,function(f,e){ag[f]=e});ag.sort(function(e,f){if(e.rp>f.rp){return 1}if(e.rp<f.rp){return -1}return 0});c.each(ag,function(f,e){c("tbody",Z).append(e)})}a.gbox="#gbox_"+O;var P=false;if(a.closeOnEscape===true){a.closeOnEscape=false;P=true}var S=c("<span></span>").append(Q).append("<table border='0' class='EditTable' id='"+M+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+a.labelswidth+"'>"+(H?J+K:K+J)+"</td><td class='EditButton'>"+N+"</td></tr></tbody></table>");c.jgrid.createModal(ab,S,a,"#gview_"+I.p.id,c("#gview_"+I.p.id)[0]);if(H){c("#pData, #nData","#"+M+"_2").css("float","right");c(".EditButton","#"+M+"_2").css("text-align","left")}if(!a.viewPagerButtons){c("#pData, #nData","#"+M+"_2").hide()}S=null;c("#"+ab.themodal).keydown(function(e){if(e.which===27){if(P){c.jgrid.hideModal(this,{gb:a.gbox,jqm:a.jqModal,onClose:a.onClose})}return false}if(a.navkeys[0]===true){if(e.which===a.navkeys[1]){c("#pData","#"+M+"_2").trigger("click");return false}if(e.which===a.navkeys[2]){c("#nData","#"+M+"_2").trigger("click");return false}}});a.closeicon=c.extend([true,"left","ui-icon-close"],a.closeicon);if(a.closeicon[0]===true){c("#cData","#"+M+"_2").addClass(a.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.closeicon[2]+"'></span>")}if(c.isFunction(a.beforeShowForm)){a.beforeShowForm(c("#"+T))}c.jgrid.viewModal("#"+ab.themodal,{gbox:"#gbox_"+O,jqm:a.jqModal,modal:a.modal});c(".fm-button:not(.ui-state-disabled)","#"+M+"_2").hover(function(){c(this).addClass("ui-state-hover")},function(){c(this).removeClass("ui-state-hover")});aa();c("#cData","#"+M+"_2").click(function(e){c.jgrid.hideModal("#"+ab.themodal,{gb:"#gbox_"+O,jqm:a.jqModal,onClose:a.onClose});return false});c("#nData","#"+M+"_2").click(function(f){c("#FormError","#"+M).hide();var e=ac();e[0]=parseInt(e[0],10);if(e[0]!=-1&&e[1][e[0]+1]){if(c.isFunction(a.onclickPgButtons)){a.onclickPgButtons("next",c("#"+T),e[1][e[0]])}X(e[1][e[0]+1],I);c(I).jqGrid("setSelection",e[1][e[0]+1]);if(c.isFunction(a.afterclickPgButtons)){a.afterclickPgButtons("next",c("#"+T),e[1][e[0]+1])}U(e[0]+1,e[1].length-1)}aa();return false});c("#pData","#"+M+"_2").click(function(e){c("#FormError","#"+M).hide();var f=ac();if(f[0]!=-1&&f[1][f[0]-1]){if(c.isFunction(a.onclickPgButtons)){a.onclickPgButtons("prev",c("#"+T),f[1][f[0]])}X(f[1][f[0]-1],I);c(I).jqGrid("setSelection",f[1][f[0]-1]);if(c.isFunction(a.afterclickPgButtons)){a.afterclickPgButtons("prev",c("#"+T),f[1][f[0]-1])}U(f[0]-1,f[1].length-1)}aa();return false})}var R=ac();U(R[0],R[1].length-1)})},delGridRow:function(b,a){a=c.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,overlay:10,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:false,serializeDelData:null,useDataProxy:false},c.jgrid.del,a||{});d=a;return this.each(function(){var y=this;if(!y.grid){return}if(!b){return}var x=typeof a.beforeShowForm==="function"?true:false,G=typeof a.afterShowForm==="function"?true:false,L=c.isFunction(a.beforeInitData)?a.beforeInitData:false,I=y.p.id,H={},C=true,B="DelTbl_"+I,M,w,z,D,F={themodal:"delmod"+I,modalhead:"delhd"+I,modalcontent:"delcnt"+I,scrollelm:B};if(jQuery.isArray(b)){b=b.join()}if(c("#"+F.themodal).html()!==null){if(L){C=L(c("#"+B));if(typeof(C)=="undefined"){C=true}}if(C===false){return}c("#DelData>td","#"+B).text(b);c("#DelError","#"+B).hide();if(d.processing===true){d.processing=false;c("#dData","#"+B).removeClass("ui-state-active")}if(x){a.beforeShowForm(c("#"+B))}c.jgrid.viewModal("#"+F.themodal,{gbox:"#gbox_"+I,jqm:a.jqModal,jqM:false,overlay:a.overlay,modal:a.modal});if(G){a.afterShowForm(c("#"+B))}}else{var K=isNaN(a.dataheight)?a.dataheight:a.dataheight+"px";var A="<div id='"+B+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+K+";'>";A+="<table class='DelTable'><tbody>";A+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";A+="<tr id='DelData' style='display:none'><td >"+b+"</td></tr>";A+='<tr><td class="delmsg" style="white-space:pre;">'+a.msg+"</td></tr><tr><td >&#160;</td></tr>";
A+="</tbody></table></div>";var E="<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+a.bSubmit+"</a>",J="<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+a.bCancel+"</a>";A+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+B+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr></tr><tr><td class='DelButton EditButton'>"+E+"&#160;"+J+"</td></tr></tbody></table>";a.gbox="#gbox_"+I;c.jgrid.createModal(F,A,a,"#gview_"+y.p.id,c("#gview_"+y.p.id)[0]);if(L){C=L(c("#"+B));if(typeof(C)=="undefined"){C=true}}if(C===false){return}c(".fm-button","#"+B+"_2").hover(function(){c(this).addClass("ui-state-hover")},function(){c(this).removeClass("ui-state-hover")});a.delicon=c.extend([true,"left","ui-icon-scissors"],a.delicon);a.cancelicon=c.extend([true,"left","ui-icon-cancel"],a.cancelicon);if(a.delicon[0]===true){c("#dData","#"+B+"_2").addClass(a.delicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.delicon[2]+"'></span>")}if(a.cancelicon[0]===true){c("#eData","#"+B+"_2").addClass(a.cancelicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.cancelicon[2]+"'></span>")}c("#dData","#"+B+"_2").click(function(g){var e=[true,""];H={};var h=c("#DelData>td","#"+B).text();if(typeof a.onclickSubmit==="function"){H=a.onclickSubmit(d,h)||{}}if(typeof a.beforeSubmit==="function"){e=a.beforeSubmit(h)}if(e[0]&&!d.processing){d.processing=true;c(this).addClass("ui-state-active");z=y.p.prmNames;M=c.extend({},d.delData,H);D=z.oper;M[D]=z.deloper;w=z.id;M[w]=h;var f=c.extend({url:d.url?d.url:c(y).jqGrid("getGridParam","editurl"),type:a.mtype,data:c.isFunction(a.serializeDelData)?a.serializeDelData(M):M,complete:function(l,n){if(n!="success"){e[0]=false;if(c.isFunction(d.errorTextFormat)){e[1]=d.errorTextFormat(l)}else{e[1]=n+" Status: '"+l.statusText+"'. Error code: "+l.status}}else{if(typeof d.afterSubmit==="function"){e=d.afterSubmit(l,M)}}if(e[0]===false){c("#DelError>td","#"+B).html(e[1]);c("#DelError","#"+B).show()}else{if(d.reloadAfterSubmit&&y.p.datatype!="local"){c(y).trigger("reloadGrid")}else{var j=[];j=h.split(",");if(y.p.treeGrid===true){try{c(y).jqGrid("delTreeNode",j[0])}catch(k){}}else{for(var m=0;m<j.length;m++){c(y).jqGrid("delRowData",j[m])}}y.p.selrow=null;y.p.selarrrow=[]}if(c.isFunction(d.afterComplete)){setTimeout(function(){d.afterComplete(l,h)},500)}}d.processing=false;c("#dData","#"+B+"_2").removeClass("ui-state-active");if(e[0]){c.jgrid.hideModal("#"+F.themodal,{gb:"#gbox_"+I,jqm:a.jqModal,onClose:d.onClose})}}},c.jgrid.ajaxOptions,a.ajaxDelOptions);if(!f.url&&!d.useDataProxy){if(c.isFunction(y.p.dataProxy)){d.useDataProxy=true}else{e[0]=false;e[1]+=" "+c.jgrid.errors.nourl}}if(e[0]){if(d.useDataProxy){y.p.dataProxy.call(y,f,"del_"+y.p.id)}else{c.ajax(f)}}}if(e[0]===false){c("#DelError>td","#"+B).html(e[1]);c("#DelError","#"+B).show()}return false});c("#eData","#"+B+"_2").click(function(e){c.jgrid.hideModal("#"+F.themodal,{gb:"#gbox_"+I,jqm:a.jqModal,onClose:d.onClose});return false});if(x){a.beforeShowForm(c("#"+B))}c.jgrid.viewModal("#"+F.themodal,{gbox:"#gbox_"+I,jqm:a.jqModal,overlay:a.overlay,modal:a.modal});if(G){a.afterShowForm(c("#"+B))}}if(a.closeOnEscape===true){setTimeout(function(){c(".ui-jqdialog-titlebar-close","#"+F.modalhead).focus()},0)}})},navGrid:function(l,b,m,k,n,o,a){b=c.extend({edit:true,editicon:"ui-icon-pencil",add:true,addicon:"ui-icon-plus",del:true,delicon:"ui-icon-trash",search:true,searchicon:"ui-icon-search",refresh:true,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:false,viewicon:"ui-icon-document",position:"left",closeOnEscape:true,beforeRefresh:null,afterRefresh:null,cloneToTop:false},c.jgrid.nav,b||{});return this.each(function(){if(this.nav){return}var z={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},h=this,j,A,f,y;if(!h.grid||typeof l!="string"){return}if(c("#"+z.themodal).html()===null){if(typeof window.innerWidth!="undefined"){j=window.innerWidth;A=window.innerHeight}else{if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0){j=document.documentElement.clientWidth;A=document.documentElement.clientHeight}else{j=1024;A=768}}c.jgrid.createModal(z,"<div>"+b.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+h.p.id,jqModal:true,drag:true,resize:true,caption:b.alertcap,top:A/2-25,left:j/2-100,width:200,height:"auto",closeOnEscape:b.closeOnEscape},"","",true)}var e=1;if(b.cloneToTop&&h.p.toppager){e=2}for(var g=0;g<e;g++){var E,C=c("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),B="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",x,D;if(g===0){x=l;D=h.p.id;if(x==h.p.toppager){D+="_top";e=1}}else{x=h.p.toppager;D=h.p.id+"_top"}if(h.p.direction=="rtl"){c(C).attr("dir","rtl").css("float","right")}if(b.add){k=k||{};E=c("<td class='ui-pg-button ui-corner-all'></td>");c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.addicon+"'></span>"+b.addtext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.addtitle||"",id:k.id||"add_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){if(typeof b.addfunc=="function"){b.addfunc()}else{c(h).jqGrid("editGridRow","new",k)}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}if(b.edit){E=c("<td class='ui-pg-button ui-corner-all'></td>");m=m||{};c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.editicon+"'></span>"+b.edittext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.edittitle||"",id:m.id||"edit_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){var p=h.p.selrow;if(p){if(typeof b.editfunc=="function"){b.editfunc(p)}else{c(h).jqGrid("editGridRow",p,m)}}else{c.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+h.p.id,jqm:true});c("#jqg_alrt").focus()}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}if(b.view){E=c("<td class='ui-pg-button ui-corner-all'></td>");a=a||{};c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.viewicon+"'></span>"+b.viewtext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.viewtitle||"",id:a.id||"view_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){var p=h.p.selrow;if(p){c(h).jqGrid("viewGridRow",p,a)}else{c.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+h.p.id,jqm:true});c("#jqg_alrt").focus()}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}if(b.del){E=c("<td class='ui-pg-button ui-corner-all'></td>");n=n||{};c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.delicon+"'></span>"+b.deltext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.deltitle||"",id:n.id||"del_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){var p;if(h.p.multiselect){p=h.p.selarrrow;if(p.length===0){p=null}}else{p=h.p.selrow}if(p){if("function"==typeof b.delfunc){b.delfunc(p)}else{c(h).jqGrid("delGridRow",p,n)
}}else{c.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+h.p.id,jqm:true});c("#jqg_alrt").focus()}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}if(b.add||b.edit||b.del||b.view){c("tr",C).append(B)}if(b.search){E=c("<td class='ui-pg-button ui-corner-all'></td>");o=o||{};c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.searchicon+"'></span>"+b.searchtext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.searchtitle||"",id:o.id||"search_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){c(h).jqGrid("searchGrid",o)}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});if(o.showOnLoad&&o.showOnLoad===true){c(E,C).click()}E=null}if(b.refresh){E=c("<td class='ui-pg-button ui-corner-all'></td>");c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.refreshicon+"'></span>"+b.refreshtext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.refreshtitle||"",id:"refresh_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){if(c.isFunction(b.beforeRefresh)){b.beforeRefresh()}h.p.search=false;try{var p=h.p.id;h.p.postData.filters="";c("#fbox_"+p).jqFilter("resetFilter");if(c.isFunction(h.clearToolbar)){h.clearToolbar(false)}}catch(q){}switch(b.refreshstate){case"firstpage":c(h).trigger("reloadGrid",[{page:1}]);break;case"current":c(h).trigger("reloadGrid",[{current:true}]);break}if(c.isFunction(b.afterRefresh)){b.afterRefresh()}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}y=c(".ui-jqgrid").css("font-size")||"11px";c("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+y+";visibility:hidden;' ></div>");f=c(C).clone().appendTo("#testpg2").width();c("#testpg2").remove();c(x+"_"+b.position,x).append(C);if(h.p._nvtd){if(f>h.p._nvtd[0]){c(x+"_"+b.position,x).width(f);h.p._nvtd[0]=f}h.p._nvtd[1]=f}y=null;f=null;C=null;this.nav=true}})},navButtonAdd:function(b,a){a=c.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},a||{});return this.each(function(){if(!this.grid){return}if(b.indexOf("#")!==0){b="#"+b}var k=c(".navtable",b)[0],h=this;if(k){if(a.id&&c("#"+a.id,k).html()!==null){return}var j=c("<td></td>");if(a.buttonicon.toString().toUpperCase()=="NONE"){c(j).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+a.caption+"</div>")}else{c(j).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+a.buttonicon+"'></span>"+a.caption+"</div>")}if(a.id){c(j).attr("id",a.id)}if(a.position=="first"){if(k.rows[0].cells.length===0){c("tr",k).append(j)}else{c("tr td:eq(0)",k).before(j)}}else{c("tr",k).append(j)}c(j,k).attr("title",a.title||"").click(function(e){if(!c(this).hasClass("ui-state-disabled")){if(c.isFunction(a.onClickButton)){a.onClickButton.call(h,e)}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")})}})},navSeparatorAdd:function(b,a){a=c.extend({sepclass:"ui-separator",sepcontent:""},a||{});return this.each(function(){if(!this.grid){return}if(b.indexOf("#")!==0){b="#"+b}var g=c(".navtable",b)[0];if(g){var h="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+a.sepclass+"'></span>"+a.sepcontent+"</td>";c("tr",g).append(h)}})},GridToForm:function(b,a){return this.each(function(){var h=this;if(!h.grid){return}var j=c(h).jqGrid("getRowData",b);if(j){for(var k in j){if(c("[name="+c.jgrid.jqID(k)+"]",a).is("input:radio")||c("[name="+c.jgrid.jqID(k)+"]",a).is("input:checkbox")){c("[name="+c.jgrid.jqID(k)+"]",a).each(function(){if(c(this).val()==j[k]){c(this).attr("checked","checked")}else{c(this).attr("checked","")}})}else{c("[name="+c.jgrid.jqID(k)+"]",a).val(j[k])}}}})},FormToGrid:function(g,b,a,h){return this.each(function(){var e=this;if(!e.grid){return}if(!a){a="set"}if(!h){h="first"}var k=c(b).serializeArray();var f={};c.each(k,function(m,j){f[j.name]=j.value});if(a=="add"){c(e).jqGrid("addRowData",g,f,h)}else{if(a=="set"){c(e).jqGrid("setRowData",g,f)}}})}})})(jQuery);(function(b){b.jgrid.extend({editRow:function(x,o,p,a,y,t,u,s,r){var v={keys:o||false,oneditfunc:p||null,successfunc:a||null,url:y||null,extraparam:t||{},aftersavefunc:u||null,errorfunc:s||null,afterrestorefunc:r||null,restoreAfterErorr:true},q=b.makeArray(arguments).slice(1),w;if(q[0]&&typeof(q[0])=="object"&&!b.isFunction(q[0])){w=b.extend(v,q[0])}else{w=v}return this.each(function(){var c=this,g,l,e,d=0,h=null,j={},f,k;if(!c.grid){return}f=b(c).jqGrid("getInd",x,true);if(f===false){return}e=b(f).attr("editable")||"0";if(e=="0"&&!b(f).hasClass("not-editable-row")){k=c.p.colModel;b("td",f).each(function(n){g=k[n].name;var C=c.p.treeGrid===true&&g==c.p.ExpandColumn;if(C){l=b("span:first",this).html()}else{try{l=b.unformat(this,{rowId:x,colModel:k[n]},n)}catch(m){l=b(this).html()}}if(g!="cb"&&g!="subgrid"&&g!="rn"){if(c.p.autoencode){l=b.jgrid.htmlDecode(l)}j[g]=l;if(k[n].editable===true){if(h===null){h=n}if(C){b("span:first",this).html("")}else{b(this).html("")}var E=b.extend({},k[n].editoptions||{},{id:x+"_"+g,name:g});if(!k[n].edittype){k[n].edittype="text"}var D=b.jgrid.createEl(k[n].edittype,E,l,true,b.extend({},b.jgrid.ajaxOptions,c.p.ajaxSelectOptions||{}));b(D).addClass("editable");if(C){b("span:first",this).append(D)}else{b(this).append(D)}if(k[n].edittype=="select"&&k[n].editoptions.multiple===true&&b.browser.msie){b(D).width(b(D).width())}d++}}});if(d>0){j.id=x;c.p.savedRow.push(j);b(f).attr("editable","1");b("td:eq("+h+") input",f).focus();if(w.keys===true){b(f).bind("keydown",function(n){if(n.keyCode===27){b(c).jqGrid("restoreRow",x,r)}if(n.keyCode===13){var m=n.target;if(m.tagName=="TEXTAREA"){return true}b(c).jqGrid("saveRow",x,w);return false}n.stopPropagation()})}if(b.isFunction(w.oneditfunc)){w.oneditfunc.call(c,x)}}}})},saveRow:function(X,I,aa,Z,S,V,ae){var M={successfunc:I||null,url:aa||null,extraparam:Z||{},aftersavefunc:S||null,errorfunc:V||null,afterrestorefunc:ae||null,restoreAfterErorr:true},ac=b.makeArray(arguments).slice(1),a;if(ac[0]&&typeof(ac[0])=="object"&&!b.isFunction(ac[0])){a=b.extend(M,ac[0])}else{a=M}var W=false;var Q=this[0],ad,K={},e={},k={},U,Y,ab,L;if(!Q.grid){return W}L=b(Q).jqGrid("getInd",X,true);if(L===false){return W}U=b(L).attr("editable");a.url=a.url?a.url:Q.p.editurl;if(U==="1"){var P;b("td",L).each(function(h){P=Q.p.colModel[h];ad=P.name;if(ad!="cb"&&ad!="subgrid"&&P.editable===true&&ad!="rn"&&!b(this).hasClass("not-editable-cell")){switch(P.edittype){case"checkbox":var d=["Yes","No"];if(P.editoptions){d=P.editoptions.value.split(":")}K[ad]=b("input",this).attr("checked")?d[0]:d[1];break;case"text":case"password":case"textarea":case"button":K[ad]=b("input, textarea",this).val();break;case"select":if(!P.editoptions.multiple){K[ad]=b("select>option:selected",this).val();e[ad]=b("select>option:selected",this).text()}else{var g=b("select",this),c=[];K[ad]=b(g).val();if(K[ad]){K[ad]=K[ad].join(",")}else{K[ad]=""}b("select > option:selected",this).each(function(l,j){c[l]=b(j).text()});e[ad]=c.join(",")}if(P.formatter&&P.formatter=="select"){e={}}break;case"custom":try{if(P.editoptions&&b.isFunction(P.editoptions.custom_value)){K[ad]=P.editoptions.custom_value.call(Q,b(".customelement",this),"get");
if(K[ad]===undefined){throw"e2"}}else{throw"e1"}}catch(f){if(f=="e1"){b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}if(f=="e2"){b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,f.message,jQuery.jgrid.edit.bClose)}}break}ab=b.jgrid.checkValues(K[ad],h,Q);if(ab[0]===false){ab[1]=K[ad]+" "+ab[1];return false}if(Q.p.autoencode){K[ad]=b.jgrid.htmlEncode(K[ad])}if(a.url!=="clientArray"&&P.editoptions&&P.editoptions.NullIfEmpty===true){if(K[ad]==""){k[ad]="null"}}}});if(ab[0]===false){try{var T=b.jgrid.findPos(b("#"+b.jgrid.jqID(X),Q.grid.bDiv)[0]);b.jgrid.info_dialog(b.jgrid.errors.errcap,ab[1],b.jgrid.edit.bClose,{left:T[0],top:T[1]})}catch(O){alert(ab[1])}return W}if(K){var H,N,J;N=Q.p.prmNames;J=N.oper;H=N.id;K[J]=N.editoper;K[H]=X;if(typeof(Q.p.inlineData)=="undefined"){Q.p.inlineData={}}K=b.extend({},K,Q.p.inlineData,a.extraparam)}if(a.url=="clientArray"){K=b.extend({},K,e);if(Q.p.autoencode){b.each(K,function(c,d){K[c]=b.jgrid.htmlDecode(d)})}var o=b(Q).jqGrid("setRowData",X,K);b(L).attr("editable","0");for(var R=0;R<Q.p.savedRow.length;R++){if(Q.p.savedRow[R].id==X){Y=R;break}}if(Y>=0){Q.p.savedRow.splice(Y,1)}if(b.isFunction(a.aftersavefunc)){a.aftersavefunc.call(Q,X,o)}W=true}else{b("#lui_"+Q.p.id).show();k=b.extend({},K,k);b.ajax(b.extend({url:a.url,data:b.isFunction(Q.p.serializeRowData)?Q.p.serializeRowData.call(Q,k):k,type:"POST",async:false,complete:function(d,c){b("#lui_"+Q.p.id).hide();if(c==="success"){var g;if(b.isFunction(a.succesfunc)){g=a.succesfunc.call(Q,d)}else{g=true}if(g===true){if(Q.p.autoencode){b.each(K,function(j,h){K[j]=b.jgrid.htmlDecode(h)})}K=b.extend({},K,e);b(Q).jqGrid("setRowData",X,K);b(L).attr("editable","0");for(var f=0;f<Q.p.savedRow.length;f++){if(Q.p.savedRow[f].id==X){Y=f;break}}if(Y>=0){Q.p.savedRow.splice(Y,1)}if(b.isFunction(a.aftersavefunc)){a.aftersavefunc.call(Q,X,d)}W=true}else{if(b.isFunction(a.errorfunc)){a.errorfunc.call(Q,X,d,c)}if(a.restoreAfterError===true){b(Q).jqGrid("restoreRow",X,a.afterrestorefunc)}}}},error:function(c,f){b("#lui_"+Q.p.id).hide();if(b.isFunction(a.errorfunc)){a.errorfunc.call(Q,X,c,f)}else{try{jQuery.jgrid.info_dialog(jQuery.jgrid.errors.errcap,'<div class="ui-state-error">'+c.responseText+"</div>",jQuery.jgrid.edit.bClose,{buttonalign:"right"})}catch(d){alert(c.responseText)}}if(a.restoreAfterError===true){b(Q).jqGrid("restoreRow",X,a.afterrestorefunc)}}},b.jgrid.ajaxOptions,Q.p.ajaxRowOptions||{}))}b(L).unbind("keydown")}return W},restoreRow:function(d,a){return this.each(function(){var c=this,o,m,e={};if(!c.grid){return}m=b(c).jqGrid("getInd",d,true);if(m===false){return}for(var n=0;n<c.p.savedRow.length;n++){if(c.p.savedRow[n].id==d){o=n;break}}if(o>=0){if(b.isFunction(b.fn.datepicker)){try{b("input.hasDatepicker","#"+b.jgrid.jqID(m.id)).datepicker("hide")}catch(k){}}b.each(c.p.colModel,function(g,f){if(this.editable===true&&this.name in c.p.savedRow[o]&&!b(this).hasClass("not-editable-cell")){e[this.name]=c.p.savedRow[o][this.name]}});b(c).jqGrid("setRowData",d,e);b(m).attr("editable","0").unbind("keydown");c.p.savedRow.splice(o,1)}if(b.isFunction(a)){a.call(c,d)}})}})})(jQuery);(function(b){b.jgrid.extend({editCell:function(e,f,a){return this.each(function(){var c=this,s,p,d;if(!c.grid||c.p.cellEdit!==true){return}f=parseInt(f,10);c.p.selrow=c.rows[e].id;if(!c.p.knv){b(c).jqGrid("GridNav")}if(c.p.savedRow.length>0){if(a===true){if(e==c.p.iRow&&f==c.p.iCol){return}}b(c).jqGrid("saveCell",c.p.savedRow[0].id,c.p.savedRow[0].ic)}else{window.setTimeout(function(){b("#"+c.p.knv).attr("tabindex","-1").focus()},0)}s=c.p.colModel[f].name;if(s=="subgrid"||s=="cb"||s=="rn"){return}d=b("td:eq("+f+")",c.rows[e]);if(c.p.colModel[f].editable===true&&a===true&&!d.hasClass("not-editable-cell")){if(parseInt(c.p.iCol,10)>=0&&parseInt(c.p.iRow,10)>=0){b("td:eq("+c.p.iCol+")",c.rows[c.p.iRow]).removeClass("edit-cell ui-state-highlight");b(c.rows[c.p.iRow]).removeClass("selected-row ui-state-hover")}b(d).addClass("edit-cell ui-state-highlight");b(c.rows[e]).addClass("selected-row ui-state-hover");try{p=b.unformat(d,{rowId:c.rows[e].id,colModel:c.p.colModel[f]},f)}catch(r){p=b(d).html()}if(c.p.autoencode){p=b.jgrid.htmlDecode(p)}if(!c.p.colModel[f].edittype){c.p.colModel[f].edittype="text"}c.p.savedRow.push({id:e,ic:f,name:s,v:p});if(b.isFunction(c.p.formatCell)){var o=c.p.formatCell.call(c,c.rows[e].id,s,p,e,f);if(o!==undefined){p=o}}var q=b.extend({},c.p.colModel[f].editoptions||{},{id:e+"_"+s,name:s});var n=b.jgrid.createEl(c.p.colModel[f].edittype,q,p,true,b.extend({},b.jgrid.ajaxOptions,c.p.ajaxSelectOptions||{}));if(b.isFunction(c.p.beforeEditCell)){c.p.beforeEditCell.call(c,c.rows[e].id,s,p,e,f)}b(d).html("").append(n).attr("tabindex","0");window.setTimeout(function(){b(n).focus()},0);b("input, select, textarea",d).bind("keydown",function(g){if(g.keyCode===27){if(b("input.hasDatepicker",d).length>0){if(b(".ui-datepicker").is(":hidden")){b(c).jqGrid("restoreCell",e,f)}else{b("input.hasDatepicker",d).datepicker("hide")}}else{b(c).jqGrid("restoreCell",e,f)}}if(g.keyCode===13){b(c).jqGrid("saveCell",e,f)}if(g.keyCode==9){if(!c.grid.hDiv.loading){if(g.shiftKey){b(c).jqGrid("prevCell",e,f)}else{b(c).jqGrid("nextCell",e,f)}}else{return false}}g.stopPropagation()});if(b.isFunction(c.p.afterEditCell)){c.p.afterEditCell.call(c,c.rows[e].id,s,p,e,f)}}else{if(parseInt(c.p.iCol,10)>=0&&parseInt(c.p.iRow,10)>=0){b("td:eq("+c.p.iCol+")",c.rows[c.p.iRow]).removeClass("edit-cell ui-state-highlight");b(c.rows[c.p.iRow]).removeClass("selected-row ui-state-hover")}d.addClass("edit-cell ui-state-highlight");b(c.rows[e]).addClass("selected-row ui-state-hover");if(b.isFunction(c.p.onSelectCell)){p=d.html().replace(/\&#160\;/ig,"");c.p.onSelectCell.call(c,c.rows[e].id,s,p,e,f)}}c.p.iCol=f;c.p.iRow=e})},saveCell:function(d,a){return this.each(function(){var v=this,L;if(!v.grid||v.p.cellEdit!==true){return}if(v.p.savedRow.length>=1){L=0}else{L=null}if(L!==null){var D=b("td:eq("+a+")",v.rows[d]),F,O,J=v.p.colModel[a],N=J.name,K=b.jgrid.jqID(N);switch(J.edittype){case"select":if(!J.editoptions.multiple){F=b("#"+d+"_"+K+">option:selected",v.rows[d]).val();O=b("#"+d+"_"+K+">option:selected",v.rows[d]).text()}else{var z=b("#"+d+"_"+K,v.rows[d]),A=[];F=b(z).val();if(F){F.join(",")}else{F=""}b("option:selected",z).each(function(g,f){A[g]=b(f).text()});O=A.join(",")}if(J.formatter){O=F}break;case"checkbox":var C=["Yes","No"];if(J.editoptions){C=J.editoptions.value.split(":")}F=b("#"+d+"_"+K,v.rows[d]).attr("checked")?C[0]:C[1];O=F;break;case"password":case"text":case"textarea":case"button":F=b("#"+d+"_"+K,v.rows[d]).val();O=F;break;case"custom":try{if(J.editoptions&&b.isFunction(J.editoptions.custom_value)){F=J.editoptions.custom_value.call(v,b(".customelement",D),"get");if(F===undefined){throw"e2"}else{O=F}}else{throw"e1"}}catch(e){if(e=="e1"){b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}if(e=="e2"){b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,e.message,jQuery.jgrid.edit.bClose)}}break}if(O!=v.p.savedRow[L].v){if(b.isFunction(v.p.beforeSaveCell)){var B=v.p.beforeSaveCell.call(v,v.rows[d].id,N,F,d,a);if(B){F=B;O=B}}var M=b.jgrid.checkValues(F,a,v);
if(M[0]===true){var H={};if(b.isFunction(v.p.beforeSubmitCell)){H=v.p.beforeSubmitCell.call(v,v.rows[d].id,N,F,d,a);if(!H){H={}}}if(b("input.hasDatepicker",D).length>0){b("input.hasDatepicker",D).datepicker("hide")}if(v.p.cellsubmit=="remote"){if(v.p.cellurl){var c={};if(v.p.autoencode){F=b.jgrid.htmlEncode(F)}c[N]=F;var E,G,I;I=v.p.prmNames;E=I.id;G=I.oper;c[E]=v.rows[d].id;c[G]=I.editoper;c=b.extend(H,c);b("#lui_"+v.p.id).show();v.grid.hDiv.loading=true;b.ajax(b.extend({url:v.p.cellurl,data:b.isFunction(v.p.serializeCellData)?v.p.serializeCellData.call(v,c):c,type:"POST",complete:function(g,h){b("#lui_"+v.p.id).hide();v.grid.hDiv.loading=false;if(h=="success"){if(b.isFunction(v.p.afterSubmitCell)){var f=v.p.afterSubmitCell.call(v,g,c.id,N,F,d,a);if(f[0]===true){b(D).empty();b(v).jqGrid("setCell",v.rows[d].id,a,O,false,false,true);b(D).addClass("dirty-cell");b(v.rows[d]).addClass("edited");if(b.isFunction(v.p.afterSaveCell)){v.p.afterSaveCell.call(v,v.rows[d].id,N,F,d,a)}v.p.savedRow.splice(0,1)}else{b.jgrid.info_dialog(b.jgrid.errors.errcap,f[1],b.jgrid.edit.bClose);b(v).jqGrid("restoreCell",d,a)}}else{b(D).empty();b(v).jqGrid("setCell",v.rows[d].id,a,O,false,false,true);b(D).addClass("dirty-cell");b(v.rows[d]).addClass("edited");if(b.isFunction(v.p.afterSaveCell)){v.p.afterSaveCell.call(v,v.rows[d].id,N,F,d,a)}v.p.savedRow.splice(0,1)}}},error:function(g,f){b("#lui_"+v.p.id).hide();v.grid.hDiv.loading=false;if(b.isFunction(v.p.errorCell)){v.p.errorCell.call(v,g,f);b(v).jqGrid("restoreCell",d,a)}else{b.jgrid.info_dialog(b.jgrid.errors.errcap,g.status+" : "+g.statusText+"<br/>"+f,b.jgrid.edit.bClose);b(v).jqGrid("restoreCell",d,a)}}},b.jgrid.ajaxOptions,v.p.ajaxCellOptions||{}))}else{try{b.jgrid.info_dialog(b.jgrid.errors.errcap,b.jgrid.errors.nourl,b.jgrid.edit.bClose);b(v).jqGrid("restoreCell",d,a)}catch(e){}}}if(v.p.cellsubmit=="clientArray"){b(D).empty();b(v).jqGrid("setCell",v.rows[d].id,a,O,false,false,true);b(D).addClass("dirty-cell");b(v.rows[d]).addClass("edited");if(b.isFunction(v.p.afterSaveCell)){v.p.afterSaveCell.call(v,v.rows[d].id,N,F,d,a)}v.p.savedRow.splice(0,1)}}else{try{window.setTimeout(function(){b.jgrid.info_dialog(b.jgrid.errors.errcap,F+" "+M[1],b.jgrid.edit.bClose)},100);b(v).jqGrid("restoreCell",d,a)}catch(e){}}}else{b(v).jqGrid("restoreCell",d,a)}}if(b.browser.opera){b("#"+v.p.knv).attr("tabindex","-1").focus()}else{window.setTimeout(function(){b("#"+v.p.knv).attr("tabindex","-1").focus()},0)}})},restoreCell:function(d,a){return this.each(function(){var c=this,k;if(!c.grid||c.p.cellEdit!==true){return}if(c.p.savedRow.length>=1){k=0}else{k=null}if(k!==null){var e=b("td:eq("+a+")",c.rows[d]);if(b.isFunction(b.fn.datepicker)){try{b("input.hasDatepicker",e).datepicker("hide")}catch(j){}}b(e).empty().attr("tabindex","-1");b(c).jqGrid("setCell",c.rows[d].id,a,c.p.savedRow[k].v,false,false,true);if(b.isFunction(c.p.afterRestoreCell)){c.p.afterRestoreCell.call(c,c.rows[d].id,c.p.savedRow[k].v,d,a)}c.p.savedRow.splice(0,1)}window.setTimeout(function(){b("#"+c.p.knv).attr("tabindex","-1").focus()},0)})},nextCell:function(d,a){return this.each(function(){var c=this,g=false;if(!c.grid||c.p.cellEdit!==true){return}for(var h=a+1;h<c.p.colModel.length;h++){if(c.p.colModel[h].editable===true){g=h;break}}if(g!==false){b(c).jqGrid("editCell",d,g,true)}else{if(c.p.savedRow.length>0){b(c).jqGrid("saveCell",d,a)}}})},prevCell:function(d,a){return this.each(function(){var c=this,g=false;if(!c.grid||c.p.cellEdit!==true){return}for(var h=a-1;h>=0;h--){if(c.p.colModel[h].editable===true){g=h;break}}if(g!==false){b(c).jqGrid("editCell",d,g,true)}else{if(c.p.savedRow.length>0){b(c).jqGrid("saveCell",d,a)}}})},GridNav:function(){return this.each(function(){var h=this;if(!h.grid||h.p.cellEdit!==true){return}h.p.knv=h.p.id+"_kn";var j=b("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+h.p.knv+"'></span></span>"),l,m;b(j).insertBefore(h.grid.cDiv);b("#"+h.p.knv).focus().keydown(function(c){m=c.keyCode;if(h.p.direction=="rtl"){if(m==37){m=39}else{if(m==39){m=37}}}switch(m){case 38:if(h.p.iRow-1>0){k(h.p.iRow-1,h.p.iCol,"vu");b(h).jqGrid("editCell",h.p.iRow-1,h.p.iCol,false)}break;case 40:if(h.p.iRow+1<=h.rows.length-1){k(h.p.iRow+1,h.p.iCol,"vd");b(h).jqGrid("editCell",h.p.iRow+1,h.p.iCol,false)}break;case 37:if(h.p.iCol-1>=0){l=a(h.p.iCol-1,"lft");k(h.p.iRow,l,"h");b(h).jqGrid("editCell",h.p.iRow,l,false)}break;case 39:if(h.p.iCol+1<=h.p.colModel.length-1){l=a(h.p.iCol+1,"rgt");k(h.p.iRow,l,"h");b(h).jqGrid("editCell",h.p.iRow,l,false)}break;case 13:if(parseInt(h.p.iCol,10)>=0&&parseInt(h.p.iRow,10)>=0){b(h).jqGrid("editCell",h.p.iRow,h.p.iCol,true)}break}return false});function k(d,f,e){if(e.substr(0,1)=="v"){var x=b(h.grid.bDiv)[0].clientHeight,c=b(h.grid.bDiv)[0].scrollTop,y=h.rows[d].offsetTop+h.rows[d].clientHeight,t=h.rows[d].offsetTop;if(e=="vd"){if(y>=x){b(h.grid.bDiv)[0].scrollTop=b(h.grid.bDiv)[0].scrollTop+h.rows[d].clientHeight}}if(e=="vu"){if(t<c){b(h.grid.bDiv)[0].scrollTop=b(h.grid.bDiv)[0].scrollTop-h.rows[d].clientHeight}}}if(e=="h"){var u=b(h.grid.bDiv)[0].clientWidth,v=b(h.grid.bDiv)[0].scrollLeft,w=h.rows[d].cells[f].offsetLeft+h.rows[d].cells[f].clientWidth,g=h.rows[d].cells[f].offsetLeft;if(w>=u+parseInt(v,10)){b(h.grid.bDiv)[0].scrollLeft=b(h.grid.bDiv)[0].scrollLeft+h.rows[d].cells[f].clientWidth}else{if(g<v){b(h.grid.bDiv)[0].scrollLeft=b(h.grid.bDiv)[0].scrollLeft-h.rows[d].cells[f].clientWidth}}}}function a(c,f){var d,e;if(f=="lft"){d=c+1;for(e=c;e>=0;e--){if(h.p.colModel[e].hidden!==true){d=e;break}}}if(f=="rgt"){d=c-1;for(e=c;e<h.p.colModel.length;e++){if(h.p.colModel[e].hidden!==true){d=e;break}}}return d}})},getChangedCells:function(d){var a=[];if(!d){d="all"}this.each(function(){var c=this,f;if(!c.grid||c.p.cellEdit!==true){return}b(c.rows).each(function(h){var e={};if(b(this).hasClass("edited")){b("td",this).each(function(k){f=c.p.colModel[k].name;if(f!=="cb"&&f!=="subgrid"){if(d=="dirty"){if(b(this).hasClass("dirty-cell")){try{e[f]=b.unformat(this,{rowId:c.rows[h].id,colModel:c.p.colModel[k]},k)}catch(g){e[f]=b.jgrid.htmlDecode(b(this).html())}}}else{try{e[f]=b.unformat(this,{rowId:c.rows[h].id,colModel:c.p.colModel[k]},k)}catch(g){e[f]=b.jgrid.htmlDecode(b(this).html())}}}});e.id=this.id;a.push(e)}})});return a}})})(jQuery);(function(b){b.jgrid.extend({setSubGrid:function(){return this.each(function(){var f=this,a,h={plusicon:"ui-icon-plus",minusicon:"ui-icon-minus",openicon:"ui-icon-carat-1-sw",expandOnLoad:false,delayOnLoad:50,selectOnExpand:false,reloadOnExpand:true};f.p.subGridOptions=b.extend(h,f.p.subGridOptions||{});f.p.colNames.unshift("");f.p.colModel.unshift({name:"subgrid",width:b.browser.safari?f.p.subGridWidth+f.p.cellLayout:f.p.subGridWidth,sortable:false,resizable:false,hidedlg:true,search:false,fixed:true});a=f.p.subGridModel;if(a[0]){a[0].align=b.extend([],a[0].align||[]);for(var g=0;g<a[0].name.length;g++){a[0].align[g]=a[0].align[g]||"left"}}})},addSubGridCell:function(g,h){var j="",a,k;this.each(function(){j=this.formatCol(g,h);k=this.p.id;a=this.p.subGridOptions.plusicon});return'<td role="grid" aria-describedby="'+k+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+j+"><a href='javascript:void(0);'><span class='ui-icon "+a+"'></span></a></td>"},addSubGrid:function(a){return this.each(function(){var r=this;if(!r.grid){return}var w=function(e,f,c){var d=b("<td align='"+r.p.subGridModel[0].align[c]+"'></td>").html(f);
b(e).append(d)};var x=function(j,c){var d,f,g,e=b("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),k=b("<tr></tr>");for(f=0;f<r.p.subGridModel[0].name.length;f++){d=b("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+r.p.direction+"'></th>");b(d).html(r.p.subGridModel[0].name[f]);b(d).width(r.p.subGridModel[0].width[f]);b(k).append(d)}b(e).append(k);if(j){g=r.p.xmlReader.subgrid;b(g.root+" "+g.row,j).each(function(){k=b("<tr class='ui-widget-content ui-subtblcell'></tr>");if(g.repeatitems===true){b(g.cell,this).each(function(m){w(k,b(this).text()||"&#160;",m)})}else{var l=r.p.subGridModel[0].mapping||r.p.subGridModel[0].name;if(l){for(f=0;f<l.length;f++){w(k,b(l[f],this).text()||"&#160;",f)}}}b(e).append(k)})}var h=b("table:first",r.grid.bDiv).attr("id")+"_";b("#"+h+c).append(e);r.grid.hDiv.loading=false;b("#load_"+r.p.id).hide();return false};var v=function(l,A){var j,g,n,k,f,c,d=b("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),e=b("<tr></tr>");for(n=0;n<r.p.subGridModel[0].name.length;n++){j=b("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+r.p.direction+"'></th>");b(j).html(r.p.subGridModel[0].name[n]);b(j).width(r.p.subGridModel[0].width[n]);b(e).append(j)}b(d).append(e);if(l){f=r.p.jsonReader.subgrid;g=l[f.root];if(typeof g!=="undefined"){for(n=0;n<g.length;n++){k=g[n];e=b("<tr class='ui-widget-content ui-subtblcell'></tr>");if(f.repeatitems===true){if(f.cell){k=k[f.cell]}for(c=0;c<k.length;c++){w(e,k[c]||"&#160;",c)}}else{var m=r.p.subGridModel[0].mapping||r.p.subGridModel[0].name;if(m.length){for(c=0;c<m.length;c++){w(e,k[m[c]]||"&#160;",c)}}}b(d).append(e)}}}var h=b("table:first",r.grid.bDiv).attr("id")+"_";b("#"+h+A).append(d);r.grid.hDiv.loading=false;b("#load_"+r.p.id).hide();return false};var q=function(d){var g,c,e,f;g=b(d).attr("id");c={nd_:(new Date().getTime())};c[r.p.prmNames.subgridid]=g;if(!r.p.subGridModel[0]){return false}if(r.p.subGridModel[0].params){for(f=0;f<r.p.subGridModel[0].params.length;f++){for(e=0;e<r.p.colModel.length;e++){if(r.p.colModel[e].name==r.p.subGridModel[0].params[f]){c[r.p.colModel[e].name]=b("td:eq("+e+")",d).text().replace(/\&#160\;/ig,"")}}}}if(!r.grid.hDiv.loading){r.grid.hDiv.loading=true;b("#load_"+r.p.id).show();if(!r.p.subgridtype){r.p.subgridtype=r.p.datatype}if(b.isFunction(r.p.subgridtype)){r.p.subgridtype.call(r,c)}else{r.p.subgridtype=r.p.subgridtype.toLowerCase()}switch(r.p.subgridtype){case"xml":case"json":b.ajax(b.extend({type:r.p.mtype,url:r.p.subGridUrl,dataType:r.p.subgridtype,data:b.isFunction(r.p.serializeSubGridData)?r.p.serializeSubGridData.call(r,c):c,complete:function(h){if(r.p.subgridtype=="xml"){x(h.responseXML,g)}else{v(b.jgrid.parse(h.responseText),g)}h=null}},b.jgrid.ajaxOptions,r.p.ajaxSubgridOptions||{}));break}}return false};var p,o,t,s=0,u,y;b.each(r.p.colModel,function(c,d){if(this.hidden===true||this.name=="rn"||this.name=="cb"){s++}});b(r.rows).each(function(d){var c=this;if(b(c).hasClass("jqgrow")){b(this.cells[a]).bind("click",function(e){y=c.nextSibling;if(b(this).hasClass("sgcollapsed")){o=r.p.id;p=c.id;if(r.p.subGridOptions.reloadOnExpand===true||(r.p.subGridOptions.reloadOnExpand===false&&!b(y).hasClass("ui-subgrid"))){t=a>=1?"<td colspan='"+a+"'>&#160;</td>":"";u=true;if(b.isFunction(r.p.subGridBeforeExpand)){u=r.p.subGridBeforeExpand.call(r,o+"_"+p,p)}if(u===false){return false}b(c).after("<tr role='row' class='ui-subgrid'>"+t+"<td class='ui-widget-content subgrid-cell'><span class='ui-icon "+r.p.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(r.p.colNames.length-1-s,10)+"' class='ui-widget-content subgrid-data'><div id="+o+"_"+p+" class='tablediv'></div></td></tr>");if(b.isFunction(r.p.subGridRowExpanded)){r.p.subGridRowExpanded.call(r,o+"_"+p,p)}else{q(c)}}else{b(y).show()}b(this).html("<a href='javascript:void(0);'><span class='ui-icon "+r.p.subGridOptions.minusicon+"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded");if(r.p.subGridOptions.selectOnExpand){b(r).jqGrid("setSelection",p)}}else{if(b(this).hasClass("sgexpanded")){u=true;if(b.isFunction(r.p.subGridRowColapsed)){p=c.id;u=r.p.subGridRowColapsed.call(r,o+"_"+p,p)}if(u===false){return false}if(r.p.subGridOptions.reloadOnExpand===true){b(y).remove(".ui-subgrid")}else{if(b(y).hasClass("ui-subgrid")){b(y).hide()}}b(this).html("<a href='javascript:void(0);'><span class='ui-icon "+r.p.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed")}}return false});if(r.p.subGridOptions.expandOnLoad===true){setTimeout(function(){b(c.cells[a]).trigger("click")},d*r.p.subGridOptions.delayOnLoad)}}});r.subGridXml=function(c,d){x(c,d)};r.subGridJson=function(c,d){v(c,d)}})},expandSubGridRow:function(a){return this.each(function(){var f=this;if(!f.grid&&!a){return}if(f.p.subGrid===true){var h=b(this).jqGrid("getInd",a,true);if(h){var g=b("td.sgcollapsed",h)[0];if(g){b(g).trigger("click")}}}})},collapseSubGridRow:function(a){return this.each(function(){var f=this;if(!f.grid&&!a){return}if(f.p.subGrid===true){var h=b(this).jqGrid("getInd",a,true);if(h){var g=b("td.sgexpanded",h)[0];if(g){b(g).trigger("click")}}}})},toggleSubGridRow:function(a){return this.each(function(){var f=this;if(!f.grid&&!a){return}if(f.p.subGrid===true){var h=b(this).jqGrid("getInd",a,true);if(h){var g=b("td.sgcollapsed",h)[0];if(g){b(g).trigger("click")}else{g=b("td.sgexpanded",h)[0];if(g){b(g).trigger("click")}}}}})}})})(jQuery);(function(b){b.jgrid.extend({setTreeNode:function(d,a){return this.each(function(){var C=this;if(!C.grid||!C.p.treeGrid){return}var I=C.p.expColInd,G=C.p.treeReader.expanded_field,z=C.p.treeReader.leaf_field,O=C.p.treeReader.level_field,A=C.p.treeReader.icon_field,E=C.p.treeReader.loaded,x,H,N,K,F,c,y,J;while(d<a){var L=C.rows[d].id,M=C.p._index[L],B;y=C.p.data[M];if(C.p.treeGridModel=="nested"){if(!y[z]){x=parseInt(y[C.p.treeReader.left_field],10);H=parseInt(y[C.p.treeReader.right_field],10);y[z]=(H===x+1)?"true":"false";C.rows[d].cells[C.p._treeleafpos].innerHTML=y[z]}}N=parseInt(y[O],10);if(C.p.tree_root_level===0){K=N+1;F=N}else{K=N;F=N-1}c="<div class='tree-wrap tree-wrap-"+C.p.direction+"' style='width:"+(K*18)+"px;'>";c+="<div style='"+(C.p.direction=="rtl"?"right:":"left:")+(F*18)+"px;' class='ui-icon ";if(y[E]!==undefined){if(y[E]=="true"||y[E]===true){y[E]=true}else{y[E]=false}}if(y[z]=="true"||y[z]===true){c+=((y[A]!==undefined&&y[A]!=="")?y[A]:C.p.treeIcons.leaf)+" tree-leaf treeclick'";y[z]=true;J="leaf"}else{y[z]=false;J=""}y[G]=((y[G]=="true"||y[G]===true)?true:false)&&y[E];if(y[G]===true){c+=C.p.treeIcons.minus+" tree-minus treeclick'"}else{c+=C.p.treeIcons.plus+" tree-plus treeclick'"}c+="</div></div>";b(C.rows[d].cells[I]).wrapInner("<span class='cell-wrapper"+J+"'></span>").prepend(c);if(N!==parseInt(C.p.tree_root_level,10)){var D=b(C).jqGrid("getNodeParent",y);B=D&&D.hasOwnProperty(G)?D[G]:true;if(!B){b(C.rows[d]).css("display","none")}}b(C.rows[d].cells[I]).find("div.treeclick").bind("click",function(h){var f=h.target||h.srcElement,e=b(f,C.rows).closest("tr.jqgrow")[0].id,g=C.p._index[e];if(!C.p.data[g][z]){if(C.p.data[g][G]){b(C).jqGrid("collapseRow",C.p.data[g]);b(C).jqGrid("collapseNode",C.p.data[g])}else{b(C).jqGrid("expandRow",C.p.data[g]);b(C).jqGrid("expandNode",C.p.data[g])}}return false});if(C.p.ExpandColClick===true){b(C.rows[d].cells[I]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(h){var f=h.target||h.srcElement,e=b(f,C.rows).closest("tr.jqgrow")[0].id,g=C.p._index[e];
if(!C.p.data[g][z]){if(C.p.data[g][G]){b(C).jqGrid("collapseRow",C.p.data[g]);b(C).jqGrid("collapseNode",C.p.data[g])}else{b(C).jqGrid("expandRow",C.p.data[g]);b(C).jqGrid("expandNode",C.p.data[g])}}b(C).jqGrid("setSelection",e);return false})}d++}})},setTreeGrid:function(){return this.each(function(){var k=this,n=0,p,l=false,q,o,a=[];if(!k.p.treeGrid){return}if(!k.p.treedatatype){b.extend(k.p,{treedatatype:k.p.datatype})}k.p.subGrid=false;k.p.altRows=false;k.p.pgbuttons=false;k.p.pginput=false;k.p.gridview=true;k.p.multiselect=false;k.p.rowList=[];k.p.expColInd=0;p="ui-icon-triangle-1-"+(k.p.direction=="rtl"?"w":"e");k.p.treeIcons=b.extend({plus:p,minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},k.p.treeIcons||{});if(k.p.treeGridModel=="nested"){k.p.treeReader=b.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},k.p.treeReader)}else{if(k.p.treeGridModel=="adjacency"){k.p.treeReader=b.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},k.p.treeReader)}}for(o in k.p.colModel){if(k.p.colModel.hasOwnProperty(o)){q=k.p.colModel[o].name;if(q==k.p.ExpandColumn&&!l){l=true;k.p.expColInd=n}n++;for(var m in k.p.treeReader){if(k.p.treeReader[m]==q){a.push(q)}}}}b.each(k.p.treeReader,function(d,c){if(c&&b.inArray(c,a)===-1){if(d==="leaf_field"){k.p._treeleafpos=n}n++;k.p.colNames.push(c);k.p.colModel.push({name:c,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false})}})})},expandRow:function(a){this.each(function(){var f=this;if(!f.grid||!f.p.treeGrid){return}var g=b(f).jqGrid("getNodeChildren",a),h=f.p.treeReader.expanded_field;b(g).each(function(d){var c=b.jgrid.getAccessor(this,f.p.localReader.id);b("#"+c,f.grid.bDiv).css("display","");if(this[h]){b(f).jqGrid("expandRow",this)}})})},collapseRow:function(a){this.each(function(){var f=this;if(!f.grid||!f.p.treeGrid){return}var g=b(f).jqGrid("getNodeChildren",a),h=f.p.treeReader.expanded_field;b(g).each(function(d){var c=b.jgrid.getAccessor(this,f.p.localReader.id);b("#"+c,f.grid.bDiv).css("display","none");if(this[h]){b(f).jqGrid("collapseRow",this)}})})},getRootNodes:function(){var a=[];this.each(function(){var f=this;if(!f.grid||!f.p.treeGrid){return}switch(f.p.treeGridModel){case"nested":var g=f.p.treeReader.level_field;b(f.p.data).each(function(c){if(parseInt(this[g],10)===parseInt(f.p.tree_root_level,10)){a.push(this)}});break;case"adjacency":var h=f.p.treeReader.parent_id_field;b(f.p.data).each(function(c){if(this[h]===null||String(this[h]).toLowerCase()=="null"){a.push(this)}});break}});return a},getNodeDepth:function(d){var a=null;this.each(function(){if(!this.grid||!this.p.treeGrid){return}var c=this;switch(c.p.treeGridModel){case"nested":var f=c.p.treeReader.level_field;a=parseInt(d[f],10)-parseInt(c.p.tree_root_level,10);break;case"adjacency":a=b(c).jqGrid("getNodeAncestors",d).length;break}});return a},getNodeParent:function(d){var a=null;this.each(function(){var r=this;if(!r.grid||!r.p.treeGrid){return}switch(r.p.treeGridModel){case"nested":var s=r.p.treeReader.left_field,c=r.p.treeReader.right_field,q=r.p.treeReader.level_field,n=parseInt(d[s],10),o=parseInt(d[c],10),u=parseInt(d[q],10);b(this.p.data).each(function(){if(parseInt(this[q],10)===u-1&&parseInt(this[s],10)<n&&parseInt(this[c],10)>o){a=this;return false}});break;case"adjacency":var p=r.p.treeReader.parent_id_field,t=r.p.localReader.id;b(this.p.data).each(function(f,e){if(this[t]==d[p]){a=this;return false}});break}});return a},getNodeChildren:function(d){var a=[];this.each(function(){var r=this;if(!r.grid||!r.p.treeGrid){return}switch(r.p.treeGridModel){case"nested":var s=r.p.treeReader.left_field,c=r.p.treeReader.right_field,q=r.p.treeReader.level_field,n=parseInt(d[s],10),o=parseInt(d[c],10),u=parseInt(d[q],10);b(this.p.data).each(function(e){if(parseInt(this[q],10)===u+1&&parseInt(this[s],10)>n&&parseInt(this[c],10)<o){a.push(this)}});break;case"adjacency":var p=r.p.treeReader.parent_id_field,t=r.p.localReader.id;b(this.p.data).each(function(f,e){if(this[p]==d[t]){a.push(this)}});break}});return a},getFullTreeNode:function(d){var a=[];this.each(function(){var t=this,s;if(!t.grid||!t.p.treeGrid){return}switch(t.p.treeGridModel){case"nested":var u=t.p.treeReader.left_field,c=t.p.treeReader.right_field,r=t.p.treeReader.level_field,o=parseInt(d[u],10),p=parseInt(d[c],10),w=parseInt(d[r],10);b(this.p.data).each(function(e){if(parseInt(this[r],10)>=w&&parseInt(this[u],10)>=o&&parseInt(this[u],10)<=p){a.push(this)}});break;case"adjacency":if(d){a.push(d);var q=t.p.treeReader.parent_id_field,v=t.p.localReader.id;b(this.p.data).each(function(e){s=a.length;for(e=0;e<s;e++){if(a[e][v]==this[q]){a.push(this);break}}})}break}});return a},getNodeAncestors:function(d){var a=[];this.each(function(){if(!this.grid||!this.p.treeGrid){return}var c=b(this).jqGrid("getNodeParent",d);while(c){a.push(c);c=b(this).jqGrid("getNodeParent",c)}});return a},isVisibleNode:function(d){var a=true;this.each(function(){var c=this;if(!c.grid||!c.p.treeGrid){return}var g=b(c).jqGrid("getNodeAncestors",d),h=c.p.treeReader.expanded_field;b(g).each(function(){a=a&&this[h];if(!a){return false}})});return a},isNodeLoaded:function(d){var a;this.each(function(){var c=this;if(!c.grid||!c.p.treeGrid){return}var f=c.p.treeReader.leaf_field;if(d!==undefined){if(d.loaded!==undefined){a=d.loaded}else{if(d[f]||b(c).jqGrid("getNodeChildren",d).length>0){a=true}else{a=false}}}else{a=false}});return a},expandNode:function(a){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var p=this.p.treeReader.expanded_field,o=this.p.treeReader.parent_id_field,r=this.p.treeReader.loaded,u=this.p.treeReader.level_field,m=this.p.treeReader.left_field,n=this.p.treeReader.right_field;if(!a[p]){var t=b.jgrid.getAccessor(a,this.p.localReader.id);var s=b("#"+t,this.grid.bDiv)[0];var q=this.p._index[t];if(b(this).jqGrid("isNodeLoaded",this.p.data[q])){a[p]=true;b("div.treeclick",s).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")}else{a[p]=true;b("div.treeclick",s).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus");this.p.treeANode=s.rowIndex;this.p.datatype=this.p.treedatatype;if(this.p.treeGridModel=="nested"){b(this).jqGrid("setGridParam",{postData:{nodeid:t,n_left:a[m],n_right:a[n],n_level:a[u]}})}else{b(this).jqGrid("setGridParam",{postData:{nodeid:t,parentid:a[o],n_level:a[u]}})}b(this).trigger("reloadGrid");a[r]=true;if(this.p.treeGridModel=="nested"){b(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}})}else{b(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}})}}}})},collapseNode:function(a){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}if(a.expanded){a.expanded=false;var e=b.jgrid.getAccessor(a,this.p.localReader.id);var f=b("#"+e,this.grid.bDiv)[0];b("div.treeclick",f).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus")}})},SortTree:function(f,h,a,g){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var e,r,c,o=[],s=this,d,p,q=b(this).jqGrid("getRootNodes");d=b.jgrid.from(q);d.orderBy(f,h,a,g);p=d.select();for(e=0,r=p.length;e<r;e++){c=p[e];o.push(c);b(this).jqGrid("collectChildrenSortTree",o,c,f,h,a,g)}b.each(o,function(l,k){var j=b.jgrid.getAccessor(this,s.p.localReader.id);
b("#"+s.p.id+" tbody tr:eq("+l+")").after(b("tr#"+j,s.grid.bDiv))});d=null;p=null;o=null})},collectChildrenSortTree:function(a,j,h,l,m,k){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var e,g,o,d,c,f;d=b(this).jqGrid("getNodeChildren",j);c=b.jgrid.from(d);c.orderBy(h,l,m,k);f=c.select();for(e=0,g=f.length;e<g;e++){o=f[e];a.push(o);b(this).jqGrid("collectChildrenSortTree",a,o,h,l,m,k)}})},setTreeRow:function(a,f){var e=false;this.each(function(){var c=this;if(!c.grid||!c.p.treeGrid){return}e=b(c).jqGrid("setRowData",a,f)});return e},delTreeNode:function(a){return this.each(function(){var s=this,o=s.p.localReader.id,u=s.p.treeReader.left_field,q=s.p.treeReader.right_field,x,w,r,p;if(!s.grid||!s.p.treeGrid){return}var y=s.p._index[a];if(y!==undefined){x=parseInt(s.p.data[y][q],10);w=x-parseInt(s.p.data[y][u],10)+1;var v=b(s).jqGrid("getFullTreeNode",s.p.data[y]);if(v.length>0){for(var t=0;t<v.length;t++){b(s).jqGrid("delRowData",v[t][o])}}if(s.p.treeGridModel==="nested"){r=b.jgrid.from(s.p.data).greater(u,x,{stype:"integer"}).select();if(r.length){for(p in r){r[p][u]=parseInt(r[p][u],10)-w}}r=b.jgrid.from(s.p.data).greater(q,x,{stype:"integer"}).select();if(r.length){for(p in r){r[p][q]=parseInt(r[p][q],10)-w}}}}})},addChildNode:function(X,S,a){var J=this[0];if(a){var R=J.p.treeReader.expanded_field,F=J.p.treeReader.leaf_field,ac=J.p.treeReader.level_field,G=J.p.treeReader.icon_field,W=J.p.treeReader.parent_id_field,aa=J.p.treeReader.left_field,E=J.p.treeReader.right_field,Q=J.p.treeReader.loaded,ab,D,V,T,N,L,P=0,U=S,H,I;if(!X){N=J.p.data.length-1;if(N>=0){while(N>=0){P=Math.max(P,parseInt(J.p.data[N][J.p.localReader.id],10));N--}}X=P+1}var K=b(J).jqGrid("getInd",S);H=false;if(S===undefined||S===null||S===""){S=null;U=null;ab="last";T=J.p.tree_root_level;N=J.p.data.length+1}else{ab="after";D=J.p._index[S];V=J.p.data[D];S=V[J.p.localReader.id];T=parseInt(V[ac],10)+1;var Z=b(J).jqGrid("getFullTreeNode",V);if(Z.length){N=Z[Z.length-1][J.p.localReader.id];U=N;N=b(J).jqGrid("getInd",U)+1}else{N=b(J).jqGrid("getInd",S)+1}if(V[F]){H=true;V[R]=true;b(J.rows[K]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(J.p.treeIcons.leaf+" tree-leaf").addClass(J.p.treeIcons.minus+" tree-minus");J.p.data[D][F]=false;V[Q]=true}}L=N+1;a[R]=false;a[Q]=true;a[ac]=T;a[F]=true;if(J.p.treeGridModel==="adjacency"){a[W]=S}if(J.p.treeGridModel==="nested"){var Y,M,O;if(S!==null){I=parseInt(V[E],10);Y=b.jgrid.from(J.p.data);Y=Y.greaterOrEquals(E,I,{stype:"integer"});M=Y.select();if(M.length){for(O in M){M[O][aa]=M[O][aa]>I?parseInt(M[O][aa],10)+2:M[O][aa];M[O][E]=M[O][E]>=I?parseInt(M[O][E],10)+2:M[O][E]}}a[aa]=I;a[E]=I+1}else{I=parseInt(b(J).jqGrid("getCol",E,false,"max"),10);M=b.jgrid.from(J.p.data).greater(aa,I,{stype:"integer"}).select();if(M.length){for(O in M){M[O][aa]=parseInt(M[O][aa],10)+2}}M=b.jgrid.from(J.p.data).greater(E,I,{stype:"integer"}).select();if(M.length){for(O in M){M[O][E]=parseInt(M[O][E],10)+2}}a[aa]=I+1;a[E]=I+2}}if(S===null||b(J).jqGrid("isNodeLoaded",V)||H){b(J).jqGrid("addRowData",X,a,ab,U);b(J).jqGrid("setTreeNode",N,L)}if(V&&!V[R]){b(J.rows[K]).find("div.treeclick").click()}}}})})(jQuery);(function(b){b.jgrid.extend({groupingSetup:function(){return this.each(function(){var h=this,m=h.p.groupingView;if(m!==null&&((typeof m==="object")||b.isFunction(m))){if(!m.groupField.length){h.p.grouping=false}else{if(typeof(m.visibiltyOnNextGrouping)=="undefined"){m.visibiltyOnNextGrouping=[]}for(var k=0;k<m.groupField.length;k++){if(!m.groupOrder[k]){m.groupOrder[k]="asc"}if(!m.groupText[k]){m.groupText[k]="{0}"}if(typeof(m.groupColumnShow[k])!="boolean"){m.groupColumnShow[k]=true}if(typeof(m.groupSummary[k])!="boolean"){m.groupSummary[k]=false}if(m.groupColumnShow[k]===true){m.visibiltyOnNextGrouping[k]=true;b(h).jqGrid("showCol",m.groupField[k])}else{m.visibiltyOnNextGrouping[k]=b("#"+h.p.id+"_"+m.groupField[k]).is(":visible");b(h).jqGrid("hideCol",m.groupField[k])}m.sortitems[k]=[];m.sortnames[k]=[];m.summaryval[k]=[];if(m.groupSummary[k]){m.summary[k]=[];var a=h.p.colModel;for(var l=0,j=a.length;l<j;l++){if(a[l].summaryType){m.summary[k].push({nm:a[l].name,st:a[l].summaryType,v:""})}}}}h.p.scroll=false;h.p.rownumbers=false;h.p.subGrid=false;h.p.treeGrid=false;h.p.gridview=true}}else{h.p.grouping=false}})},groupingPrepare:function(g,h,f,a){this.each(function(){h[0]+="";var c=h[0].toString().split(" ").join("");var e=this.p.groupingView,d=this;if(f.hasOwnProperty(c)){f[c].push(g)}else{f[c]=[];f[c].push(g);e.sortitems[0].push(c);e.sortnames[0].push(b.trim(h[0].toString()));e.summaryval[0][c]=b.extend(true,[],e.summary[0])}if(e.groupSummary[0]){b.each(e.summaryval[0][c],function(m,l){if(b.isFunction(this.st)){this.v=this.st.call(d,this.v,this.nm,a)}else{this.v=b(d).jqGrid("groupingCalculations."+this.st,this.v,this.nm,a)}})}});return f},groupingToggle:function(a){this.each(function(){var u=this,o=u.p.groupingView,x=a.lastIndexOf("_"),q=a.substring(0,x+1),t=parseInt(a.substring(x+1),10)+1,w=o.minusicon,r=o.plusicon,s=b("#"+a),y=s[0].nextSibling,p=b("#"+a+" span.tree-wrap-"+u.p.direction),v=false;if(p.hasClass(w)){if(o.showSummaryOnHide&&o.groupSummary[0]){if(y){while(y){if(b(y).hasClass("jqfoot")){break}b(y).hide();y=y.nextSibling}}}else{if(y){while(y){if(b(y).attr("id")==q+String(t)){break}b(y).hide();y=y.nextSibling}}}p.removeClass(w).addClass(r);v=true}else{if(y){while(y){if(b(y).attr("id")==q+String(t)){break}b(y).show();y=y.nextSibling}}p.removeClass(r).addClass(w);v=false}if(b.isFunction(u.p.onClickGroup)){u.p.onClickGroup.call(u,a,v)}});return false},groupingRender:function(a,d){return this.each(function(){var t=this,n=t.p.groupingView,r="",p="",o,s="",u,q,c;if(!n.groupDataSorted){n.sortitems[0].sort();n.sortnames[0].sort();if(n.groupOrder[0].toLowerCase()=="desc"){n.sortitems[0].reverse();n.sortnames[0].reverse()}}if(n.groupCollapse){s=n.plusicon}else{s=n.minusicon}s+=" tree-wrap-"+t.p.direction;c=0;while(c<d){if(t.p.colModel[c].name==n.groupField[0]){q=c;break}c++}b.each(n.sortitems[0],function(D,f){o=t.p.id+"ghead_"+D;p="<span style='cursor:pointer;' class='ui-icon "+s+"' onclick=\"jQuery('#"+t.p.id+"').jqGrid('groupingToggle','"+o+"');return false;\"></span>";try{u=t.formatter(o,n.sortnames[0][D],q,n.sortitems[0])}catch(j){u=n.sortnames[0][D]}r+='<tr id="'+o+'" role="row" class= "ui-widget-content jqgroup ui-row-'+t.p.direction+'"><td colspan="'+d+'">'+p+b.jgrid.format(n.groupText[0],u,a[f].length)+"</td></tr>";for(var g=0;g<a[f].length;g++){r+=a[f][g].join("")}if(n.groupSummary[0]){var B="";if(n.groupCollapse&&!n.showSummaryOnHide){B=' style="display:none;"'}r+="<tr"+B+' role="row" class="ui-widget-content jqfoot ui-row-'+t.p.direction+'">';var C=n.summaryval[0][f],m=t.p.colModel,A,l=a[f].length;for(var e=0;e<d;e++){var h="<td "+t.formatCol(e,1,"")+">&#160;</td>",k="{0}";b.each(C,function(){if(this.nm==m[e].name){if(m[e].summaryTpl){k=m[e].summaryTpl}if(this.st=="avg"){if(this.v&&l>0){this.v=(this.v/l)}}try{A=t.formatter("",this.v,e,this)}catch(v){A=this.v}h="<td "+t.formatCol(e,1,"")+">"+b.jgrid.format(k,A)+"</td>";return false}});r+=h}r+="</tr>"}});b("#"+t.p.id+" tbody:first").append(r);r=null})},groupingGroupBy:function(f,a,e){return this.each(function(){var c=this;if(typeof(f)=="string"){f=[f]}var h=c.p.groupingView;c.p.grouping=true;for(var d=0;d<h.groupField.length;d++){if(!h.groupColumnShow[d]&&h.visibiltyOnNextGrouping[d]){b(c).jqGrid("showCol",h.groupField[d])
}}for(var d=0;d<f.length;d++){h.visibiltyOnNextGrouping[d]=b("#"+c.p.id+"_"+f[d]).is(":visible")}c.p.groupingView=b.extend(c.p.groupingView,a||{});h.groupField=f;b(c).trigger("reloadGrid")})},groupingRemove:function(a){return this.each(function(){var f=this;if(typeof(a)=="undefined"){a=true}f.p.grouping=false;if(a===true){var h=f.p.groupingView;for(var g=0;g<h.groupField.length;g++){if(!h.groupColumnShow[g]&&h.visibiltyOnNextGrouping[g]){b(f).jqGrid("showCol",h.groupField)}}b("tr.jqgroup, tr.jqfoot","#"+f.p.id+" tbody:first").remove();b("tr.jqgrow:hidden","#"+f.p.id+" tbody:first").show()}else{b(f).trigger("reloadGrid")}})},groupingCalculations:{sum:function(a,e,f){return parseFloat(a||0)+parseFloat((f[e]||0))},min:function(a,e,f){if(a===""){return parseFloat(f[e]||0)}return Math.min(parseFloat(a),parseFloat(f[e]||0))},max:function(a,e,f){if(a===""){return parseFloat(f[e]||0)}return Math.max(parseFloat(a),parseFloat(f[e]||0))},count:function(a,e,f){if(a===""){a=0}if(f.hasOwnProperty(e)){return a+1}else{return 0}},avg:function(a,e,f){return parseFloat(a||0)+parseFloat((f[e]||0))}}})})(jQuery);(function(b){b.jgrid.extend({jqGridImport:function(a){a=b.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},a||{});return this.each(function(){var g=this;var j=function(o,s){var q=b(s.xmlGrid.config,o)[0];var c=b(s.xmlGrid.data,o)[0],r,e;if(xmlJsonClass.xml2json&&b.jgrid.parse){r=xmlJsonClass.xml2json(q," ");r=b.jgrid.parse(r);for(var f in r){if(r.hasOwnProperty(f)){e=r[f]}}if(c){var d=r.grid.datatype;r.grid.datatype="xmlstring";r.grid.datastr=o;b(g).jqGrid(e).jqGrid("setGridParam",{datatype:d})}else{b(g).jqGrid(e)}r=null;e=null}else{alert("xml2json or parse are not present")}};var h=function(n,d){if(n&&typeof n=="string"){var o=b.jgrid.parse(n);var c=o[d.jsonGrid.config];var f=o[d.jsonGrid.data];if(f){var e=c.datatype;c.datatype="jsonstring";c.datastr=f;b(g).jqGrid(c).jqGrid("setGridParam",{datatype:e})}else{b(g).jqGrid(c)}}};switch(a.imptype){case"xml":b.ajax(b.extend({url:a.impurl,type:a.mtype,data:a.impData,dataType:"xml",complete:function(d,c){if(c=="success"){j(d.responseXML,a);if(b.isFunction(a.importComplete)){a.importComplete(d)}}d=null}},a.ajaxOptions));break;case"xmlstring":if(a.impstring&&typeof a.impstring=="string"){var k=b.jgrid.stringToDoc(a.impstring);if(k){j(k,a);if(b.isFunction(a.importComplete)){a.importComplete(k)}a.impstring=null}k=null}break;case"json":b.ajax(b.extend({url:a.impurl,type:a.mtype,data:a.impData,dataType:"json",complete:function(d,c){if(c=="success"){h(d.responseText,a);if(b.isFunction(a.importComplete)){a.importComplete(d)}}d=null}},a.ajaxOptions));break;case"jsonstring":if(a.impstring&&typeof a.impstring=="string"){h(a.impstring,a);if(b.isFunction(a.importComplete)){a.importComplete(a.impstring)}a.impstring=null}break}})},jqGridExport:function(d){d=b.extend({exptype:"xmlstring",root:"grid",ident:"\t"},d||{});var a=null;this.each(function(){if(!this.grid){return}var c=b.extend({},b(this).jqGrid("getGridParam"));if(c.rownumbers){c.colNames.splice(0,1);c.colModel.splice(0,1)}if(c.multiselect){c.colNames.splice(0,1);c.colModel.splice(0,1)}if(c.subGrid){c.colNames.splice(0,1);c.colModel.splice(0,1)}c.knv=null;if(c.treeGrid){for(var f in c.treeReader){if(c.treeReader.hasOwnProperty(f)){c.colNames.splice(c.colNames.length-1);c.colModel.splice(c.colModel.length-1)}}}switch(d.exptype){case"xmlstring":a="<"+d.root+">"+xmlJsonClass.json2xml(c,d.ident)+"</"+d.root+">";break;case"jsonstring":a="{"+xmlJsonClass.toJson(c,d.root,d.ident)+"}";if(c.postData.filters!==undefined){a=a.replace(/filters":"/,'filters":');a=a.replace(/}]}"/,"}]}")}break}});return a},excelExport:function(a){a=b.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},a||{});return this.each(function(){if(!this.grid){return}var h;if(a.exptype=="remote"){var g=b.extend({},this.p.postData);g[a.oper]=a.tag;var f=jQuery.param(g);if(a.url.indexOf("?")!=-1){h=a.url+"&"+f}else{h=a.url+"?"+f}window.location=h}})}})})(jQuery);(function($){if($.browser.msie&&$.browser.version==8){$.expr[":"].hidden=function(elem){return elem.offsetWidth===0||elem.offsetHeight===0||elem.style.display=="none"}}$.jgrid._multiselect=false;if($.ui){if($.ui.multiselect){if($.ui.multiselect.prototype._setSelected){var setSelected=$.ui.multiselect.prototype._setSelected;$.ui.multiselect.prototype._setSelected=function(item,selected){var ret=setSelected.call(this,item,selected);if(selected&&this.selectedList){var elt=this.element;this.selectedList.find("li").each(function(){if($(this).data("optionLink")){$(this).data("optionLink").remove().appendTo(elt)}})}return ret}}if($.ui.multiselect.prototype.destroy){$.ui.multiselect.prototype.destroy=function(){this.element.show();this.container.remove();if($.Widget===undefined){$.widget.prototype.destroy.apply(this,arguments)}else{$.Widget.prototype.destroy.apply(this,arguments)}}}$.jgrid._multiselect=true}}$.jgrid.extend({sortableColumns:function(tblrow){return this.each(function(){var ts=this;function start(){ts.p.disableClick=true}var sortable_opts={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_cb,#jqgh_rn,#jqgh_subgrid),:hidden)",placeholder:{element:function(item){var el=$(document.createElement(item[0].nodeName)).addClass(item[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0];return el},update:function(self,p){p.height(self.currentItem.innerHeight()-parseInt(self.currentItem.css("paddingTop")||0,10)-parseInt(self.currentItem.css("paddingBottom")||0,10));p.width(self.currentItem.innerWidth()-parseInt(self.currentItem.css("paddingLeft")||0,10)-parseInt(self.currentItem.css("paddingRight")||0,10))}},update:function(event,ui){var p=$(ui.item).parent();var th=$(">th",p);var colModel=ts.p.colModel;var cmMap={};$.each(colModel,function(i){cmMap[this.name]=i});var permutation=[];th.each(function(i){var id=$(">div",this).get(0).id.replace(/^jqgh_/,"");if(id in cmMap){permutation.push(cmMap[id])}});$(ts).jqGrid("remapColumns",permutation,true,true);if($.isFunction(ts.p.sortable.update)){ts.p.sortable.update(permutation)}setTimeout(function(){ts.p.disableClick=false},50)}};if(ts.p.sortable.options){$.extend(sortable_opts,ts.p.sortable.options)}else{if($.isFunction(ts.p.sortable)){ts.p.sortable={update:ts.p.sortable}}}if(sortable_opts.start){var s=sortable_opts.start;sortable_opts.start=function(e,ui){start();s.call(this,e,ui)}}else{sortable_opts.start=start}if(ts.p.sortable.exclude){sortable_opts.items+=":not("+ts.p.sortable.exclude+")"}tblrow.sortable(sortable_opts).data("sortable").floating=true})},columnChooser:function(opts){var self=this;if($("#colchooser_"+self[0].p.id).length){return}var selector=$('<div id="colchooser_'+self[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>');var select=$("select",selector);function insert(perm,i,v){if(i>=0){var a=perm.slice();var b=a.splice(i,Math.max(perm.length-i,i));if(i>perm.length){i=perm.length}a[i]=v;return a.concat(b)}}opts=$.extend({width:420,height:240,classname:null,done:function(perm){if(perm){self.jqGrid("remapColumns",perm,true)}},msel:"multiselect",dlog:"dialog",dlog_opts:function(opts){var buttons={};buttons[opts.bSubmit]=function(){opts.apply_perm();opts.cleanup(false)};buttons[opts.bCancel]=function(){opts.cleanup(true)};return{buttons:buttons,close:function(){opts.cleanup(true)
},modal:opts.modal?opts.modal:false,resizable:opts.resizable?opts.resizable:true,width:opts.width+20}},apply_perm:function(){$("option",select).each(function(i){if(this.selected){self.jqGrid("showCol",colModel[this.value].name)}else{self.jqGrid("hideCol",colModel[this.value].name)}});var perm=[];$("option[selected]",select).each(function(){perm.push(parseInt(this.value,10))});$.each(perm,function(){delete colMap[colModel[parseInt(this,10)].name]});$.each(colMap,function(){var ti=parseInt(this,10);perm=insert(perm,ti,ti)});if(opts.done){opts.done.call(self,perm)}},cleanup:function(calldone){call(opts.dlog,selector,"destroy");call(opts.msel,select,"destroy");selector.remove();if(calldone&&opts.done){opts.done.call(self)}},msel_opts:{}},$.jgrid.col,opts||{});if($.ui){if($.ui.multiselect){if(opts.msel=="multiselect"){if(!$.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");return}opts.msel_opts=$.extend($.ui.multiselect.defaults,opts.msel_opts)}}}if(opts.caption){selector.attr("title",opts.caption)}if(opts.classname){selector.addClass(opts.classname);select.addClass(opts.classname)}if(opts.width){$(">div",selector).css({width:opts.width,margin:"0 auto"});select.css("width",opts.width)}if(opts.height){$(">div",selector).css("height",opts.height);select.css("height",opts.height-10)}var colModel=self.jqGrid("getGridParam","colModel");var colNames=self.jqGrid("getGridParam","colNames");var colMap={},fixedCols=[];select.empty();$.each(colModel,function(i){colMap[this.name]=i;if(this.hidedlg){if(!this.hidden){fixedCols.push(i)}return}select.append("<option value='"+i+"' "+(this.hidden?"":"selected='selected'")+">"+colNames[i]+"</option>")});function call(fn,obj){if(!fn){return}if(typeof fn=="string"){if($.fn[fn]){$.fn[fn].apply(obj,$.makeArray(arguments).slice(2))}}else{if($.isFunction(fn)){fn.apply(obj,$.makeArray(arguments).slice(2))}}}var dopts=$.isFunction(opts.dlog_opts)?opts.dlog_opts.call(self,opts):opts.dlog_opts;call(opts.dlog,selector,dopts);var mopts=$.isFunction(opts.msel_opts)?opts.msel_opts.call(self,opts):opts.msel_opts;call(opts.msel,select,mopts)},sortableRows:function(opts){return this.each(function(){var $t=this;if(!$t.grid){return}if($t.p.treeGrid){return}if($.fn.sortable){opts=$.extend({cursor:"move",axis:"y",items:".jqgrow"},opts||{});if(opts.start&&$.isFunction(opts.start)){opts._start_=opts.start;delete opts.start}else{opts._start_=false}if(opts.update&&$.isFunction(opts.update)){opts._update_=opts.update;delete opts.update}else{opts._update_=false}opts.start=function(ev,ui){$(ui.item).css("border-width","0px");$("td",ui.item).each(function(i){this.style.width=$t.grid.cols[i].style.width});if($t.p.subGrid){var subgid=$(ui.item).attr("id");try{$($t).jqGrid("collapseSubGridRow",subgid)}catch(e){}}if(opts._start_){opts._start_.apply(this,[ev,ui])}};opts.update=function(ev,ui){$(ui.item).css("border-width","");if($t.p.rownumbers===true){$("td.jqgrid-rownum",$t.rows).each(function(i){$(this).html(i+1)})}if(opts._update_){opts._update_.apply(this,[ev,ui])}};$("tbody:first",$t).sortable(opts);$("tbody:first",$t).disableSelection()}})},gridDnD:function(opts){return this.each(function(){var $t=this;if(!$t.grid){return}if($t.p.treeGrid){return}if(!$.fn.draggable||!$.fn.droppable){return}function updateDnD(){var datadnd=$.data($t,"dnd");$("tr.jqgrow:not(.ui-draggable)",$t).draggable($.isFunction(datadnd.drag)?datadnd.drag.call($($t),datadnd):datadnd.drag)}var appender="<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>";if($("#jqgrid_dnd").html()===null){$("body").append(appender)}if(typeof opts=="string"&&opts=="updateDnD"&&$t.p.jqgdnd===true){updateDnD();return}opts=$.extend({drag:function(opts){return $.extend({start:function(ev,ui){if($t.p.subGrid){var subgid=$(ui.helper).attr("id");try{$($t).jqGrid("collapseSubGridRow",subgid)}catch(e){}}for(var i=0;i<$.data($t,"dnd").connectWith.length;i++){if($($.data($t,"dnd").connectWith[i]).jqGrid("getGridParam","reccount")=="0"){$($.data($t,"dnd").connectWith[i]).jqGrid("addRowData","jqg_empty_row",{})}}ui.helper.addClass("ui-state-highlight");$("td",ui.helper).each(function(i){this.style.width=$t.grid.headers[i].width+"px"});if(opts.onstart&&$.isFunction(opts.onstart)){opts.onstart.call($($t),ev,ui)}},stop:function(ev,ui){if(ui.helper.dropped){var ids=$(ui.helper).attr("id");$($t).jqGrid("delRowData",ids)}for(var i=0;i<$.data($t,"dnd").connectWith.length;i++){$($.data($t,"dnd").connectWith[i]).jqGrid("delRowData","jqg_empty_row")}if(opts.onstop&&$.isFunction(opts.onstop)){opts.onstop.call($($t),ev,ui)}}},opts.drag_opts||{})},drop:function(opts){return $.extend({accept:function(d){if(!$(d).hasClass("jqgrow")){return d}var tid=$(d).closest("table.ui-jqgrid-btable");if(tid.length>0&&$.data(tid[0],"dnd")!==undefined){var cn=$.data(tid[0],"dnd").connectWith;return $.inArray("#"+this.id,cn)!=-1?true:false}return d},drop:function(ev,ui){if(!$(ui.draggable).hasClass("jqgrow")){return}var accept=$(ui.draggable).attr("id");var getdata=ui.draggable.parent().parent().jqGrid("getRowData",accept);if(!opts.dropbyname){var j=0,tmpdata={},dropname;var dropmodel=$("#"+this.id).jqGrid("getGridParam","colModel");try{for(var key in getdata){if(getdata.hasOwnProperty(key)&&dropmodel[j]){dropname=dropmodel[j].name;tmpdata[dropname]=getdata[key]}j++}getdata=tmpdata}catch(e){}}ui.helper.dropped=true;if(opts.beforedrop&&$.isFunction(opts.beforedrop)){var datatoinsert=opts.beforedrop.call(this,ev,ui,getdata,$("#"+$t.id),$(this));if(typeof datatoinsert!="undefined"&&datatoinsert!==null&&typeof datatoinsert=="object"){getdata=datatoinsert}}if(ui.helper.dropped){var grid;if(opts.autoid){if($.isFunction(opts.autoid)){grid=opts.autoid.call(this,getdata)}else{grid=Math.ceil(Math.random()*1000);grid=opts.autoidprefix+grid}}$("#"+this.id).jqGrid("addRowData",grid,getdata,opts.droppos)}if(opts.ondrop&&$.isFunction(opts.ondrop)){opts.ondrop.call(this,ev,ui,getdata)}}},opts.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5000},dropbyname:false,droppos:"first",autoid:true,autoidprefix:"dnd_"},opts||{});if(!opts.connectWith){return}opts.connectWith=opts.connectWith.split(",");opts.connectWith=$.map(opts.connectWith,function(n){return $.trim(n)});$.data($t,"dnd",opts);if($t.p.reccount!="0"&&!$t.p.jqgdnd){updateDnD()}$t.p.jqgdnd=true;for(var i=0;i<opts.connectWith.length;i++){var cn=opts.connectWith[i];$(cn).droppable($.isFunction(opts.drop)?opts.drop.call($($t),opts):opts.drop)}})},gridResize:function(opts){return this.each(function(){var $t=this;if(!$t.grid||!$.fn.resizable){return}opts=$.extend({},opts||{});if(opts.alsoResize){opts._alsoResize_=opts.alsoResize;delete opts.alsoResize}else{opts._alsoResize_=false}if(opts.stop&&$.isFunction(opts.stop)){opts._stop_=opts.stop;delete opts.stop}else{opts._stop_=false}opts.stop=function(ev,ui){$($t).jqGrid("setGridParam",{height:$("#gview_"+$t.p.id+" .ui-jqgrid-bdiv").height()});$($t).jqGrid("setGridWidth",ui.size.width,opts.shrinkToFit);if(opts._stop_){opts._stop_.call($t,ev,ui)}};if(opts._alsoResize_){var optstest="{'#gview_"+$t.p.id+" .ui-jqgrid-bdiv':true,'"+opts._alsoResize_+"':true}";opts.alsoResize=eval("("+optstest+")")}else{opts.alsoResize=$(".ui-jqgrid-bdiv","#gview_"+$t.p.id)}delete opts._alsoResize_;$("#gbox_"+$t.p.id).resizable(opts)})}})})(jQuery);function tableToGrid(d,c){jQuery(d).each(function(){if(this.grid){return
}jQuery(this).width("99%");var q=jQuery(this).width();var a=jQuery("input[type=checkbox]:first",jQuery(this));var v=jQuery("input[type=radio]:first",jQuery(this));var z=a.length>0;var w=!z&&v.length>0;var u=z||w;var s=[];var b=[];jQuery("th",jQuery(this)).each(function(){if(s.length===0&&u){s.push({name:"__selection__",index:"__selection__",width:0,hidden:true});b.push("__selection__")}else{s.push({name:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),index:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),width:jQuery(this).width()||150});b.push(jQuery(this).html())}});var x=[];var y=[];var r=[];jQuery("tbody > tr",jQuery(this)).each(function(){var e={};var f=0;jQuery("td",jQuery(this)).each(function(){if(f===0&&u){var h=jQuery("input",jQuery(this));var g=h.attr("value");y.push(g||x.length);if(h.attr("checked")){r.push(g)}e[s[f].name]=h.attr("value")}else{e[s[f].name]=jQuery(this).html()}f++});if(f>0){x.push(e)}});jQuery(this).empty();jQuery(this).addClass("scroll");jQuery(this).jqGrid(jQuery.extend({datatype:"local",width:q,colNames:b,colModel:s,multiselect:z},c||{}));var t;for(t=0;t<x.length;t++){var A=null;if(y.length>0){A=y[t];if(A&&A.replace){A=encodeURIComponent(A).replace(/[.\-%]/g,"_")}}if(A===null){A=t+1}jQuery(this).jqGrid("addRowData",A,x[t])}for(t=0;t<r.length;t++){jQuery(this).jqGrid("setSelection",r[t])}})}CJW.jfp.widget.DataGrid=JFPWClass.extend(CJW.jfp.widget.Object,{className:"CJW.jfp.widget.DataGrid",wrapperSet:null,instance:null,topics:null,_triggerOnSelectRow:function(c,d){$jq(this).trigger("onSelectRow",[{type:"onSelectRow",wrapper:this,rowid:c}])},_triggerOnSortCol:function(f,d,e){$jq(this).trigger("onSortCol",{type:"onSortCol",wrapper:this,index:f,iCol:d,sortorder:e})},_triggerOnCellSelect:function(d,e,f){$jq(this).trigger("onCellSelect",{type:"onCellSelect",wrapper:this,rowid:d,iCol:e,cellcontent:f})},_triggerOnSelectAll:function(c,d){$jq(this).trigger("onSelectAll",{type:"onSelectAll",wrapper:this,aRowids:c,status:d})},initialize:function(f,e,d){f=f||{};e=e||{};d=d||{};this.oCfg={};this.topicConfig={};JFP.cp(this.oCfg,f,{wrapperSet:"_TABLE_UKN_",label:"Default Label",mtype:"POST",rowTotal:-1,datatype:"local",onSelectRow:this._wrapCallBack(this._triggerOnSelectRow,e.onSelectRow),onSortCol:this._wrapCallBack(this._triggerOnSortCol,e.onSortCol),onCellSelect:this._wrapCallBack(this._triggerOnCellSelect,e.onCellSelect),onSelectAll:this._wrapCallBack(this._triggerOnSelectAll,e.onSelectAll),text:true});JFP.cnp(this.oCfg,e);JFP.cnp(this.oCfg,CJW.jfp.widget.DataGrid.defaults);this.styleClass=this.oCfg.styleClass;this._applyCfg();this.topics=d;this._create()},_applyCfg:function(){this.wrapperSet=this.oCfg.wrapperSet;if(this.oCfg.cellFormater){this.cellFormater=this.oCfg.cellFormater}},getProperty:function(b){return this.instance.getGridParam(b)},setProperty:function(d,f){var e={};e[d]=f;this.instance.setGridParam(e)},setProperties:function(b){b=b||{};this.instance.setGridParam(b)},_create:function(){var g;if(this.instance!=null){return}var h="ar|bg|cat|cn|cs|da|de|dk|el|es|fa|fi|fr|gl|he|hr|hu|id|is|it|ja|kr|lt|mne|nl|no|pl|pt|ro|ru|sk|sr|sv|th|tr|tw|ua|vi";if(this.oCfg.locale.indexOf("_")=="-1"){var f=this.oCfg.locale}else{var f=this.oCfg.locale.substr(0,this.oCfg.locale.indexOf("_"))}if(f!="en"&&h.indexOf(f)!="-1"){$jq("head").prepend('<script type="text/javascript" src="/JFP/js/widgets/jqgrid-i18n/grid.locale-'+f+'.js"><\/script>')}this.instance=$jq(this.wrapperSet).first().jqGrid(this.oCfg);g=this.instance.getGridParam("colModel");for(var e in g){this.instance.setColProp(g[e]["name"],{formatter:this.cellFormater})}this.selector=this.wrapperSet;this.setTopics(this.topics);this.instance.parents("#gbox_"+this.instance.attr("id")).addClass(this.styleClass);$jq("tr.jqgrow td",$jq(this.wrapperSet)[0]).removeAttr("title");this.refresh();this.triggerPostConstruction()},destroy:function(){if(this.instance==null){return}this._destroy$();this.instance.GridDestroy();this.instance=null},clear:function(){if(this.instance==null){return}this.instance.clearGridData()},refresh:function(){if(this.instance==null){return}this.instance.trigger("reloadGrid")},render:function(b){if(this.instance==null){return}this.instance.clearGridData();this.instance.setGridParam({data:b});this.instance.trigger("reloadGrid")},addRow:function(g,h,d){if(this.instance==null){return}var f=this.instance.getGridParam("data");$jq.merge(f,g);this.instance.clearGridData();this.instance.setGridParam({data:f});this.instance.trigger("reloadGrid")},updateRow:function(f,d,e){if(this.instance==null){return}this.instance.setRowData(f,d,e)},removeRow:function(b){if(this.instance==null){return}this.instance.delRowData(b)},selectedRow:function(){return this.instance.getGridParam("selrow")},cellFormater:function(b){return b},filterByField:function(h,g,k){if(this.instance==null||h==null){return}if(g==""||g==null||k==""||k==null){this.render(h);return}var j=new Array();for(var f=0;f<h.length;f++){if(h[f][g]==k){j.push(h[f])}}this.render(j)},widget:function(){return this.instance}});CJW.jfp.widget.DataGrid.defaults={styleClass:"jfpw-datagrid",locale:"en_US"};window.$RDY&&$RDY.complete("CJW.jfp.widget.DataGrid");